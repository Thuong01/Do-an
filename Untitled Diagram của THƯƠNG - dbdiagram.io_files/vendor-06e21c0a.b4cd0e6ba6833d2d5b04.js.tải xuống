!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="848a6f5d-b1e4-410a-b4eb-fa68a5e2b045",e._sentryDebugIdIdentifier="sentry-dbid-848a6f5d-b1e4-410a-b4eb-fa68a5e2b045")}catch(e){}}();var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"13ad4a0c312011ebb49f3e8dc8f97be809f60d04"},(self.webpackChunkschema_diagram_vue=self.webpackChunkschema_diagram_vue||[]).push([[208],{20491:function(e,t,n){n.d(t,{Ho:function(){return re},kI:function(){return ae},Bz:function(){return Y}});var i=n(13338),s=n(94901),o=n(94327),r=n(2106),a=n(10998),h=n(16844),l=n(37264),d=n(3902),c=n(57999),u=n(15365),g=n(28061),_=n(93702),f=n(12590),p=n(77922),m=n(52394),C=n(66055),L=n(68901),b=n(5966),k=n(54296),D=n(52818),v=n(63713),T=n(85487),S=n(29844),N=n(88660),I=n(104),w=n(18782),x=n(32177),M=n(57445),z=n(47317),E=n(97036),R=n(23013),A=n(83881),O=n(65958),y=n(63339);class P{constructor(e){this._default=e,this._store=[]}get(e){return e<this._store.length?this._store[e]:this._default}set(e,t){for(;e>=this._store.length;)this._store[this._store.length]=this._default;this._store[e]=t}delete(e,t){0===t||e>=this._store.length||this._store.splice(e,t)}insert(e,t){if(0===t||e>=this._store.length)return;const n=[];for(let e=0;e<t;e++)n[e]=this._default;this._store=i.nK(this._store,e,n)}}class F{constructor(e,t){this.tokenizationSupport=e,this.initialState=t,this._lineBeginState=new P(null),this._lineNeedsTokenization=new P(!0),this._firstLineNeedsTokenization=0,this._lineBeginState.set(0,this.initialState)}get invalidLineStartIndex(){return this._firstLineNeedsTokenization}markMustBeTokenized(e){this._lineNeedsTokenization.set(e,!0),this._firstLineNeedsTokenization=Math.min(this._firstLineNeedsTokenization,e)}getBeginState(e){return this._lineBeginState.get(e)}setEndState(e,t,n){if(this._lineNeedsTokenization.set(t,!1),this._firstLineNeedsTokenization=t+1,t===e-1)return;const i=this._lineBeginState.get(t+1);if(null===i||!n.equals(i))return this._lineBeginState.set(t+1,n),void this.markMustBeTokenized(t+1);let s=t+1;for(;s<e&&!this._lineNeedsTokenization.get(s);)s++;this._firstLineNeedsTokenization=s}applyEdits(e,t){this.markMustBeTokenized(e.startLineNumber-1),this._lineBeginState.delete(e.startLineNumber,e.endLineNumber-e.startLineNumber),this._lineNeedsTokenization.delete(e.startLineNumber,e.endLineNumber-e.startLineNumber),this._lineBeginState.insert(e.startLineNumber,t),this._lineNeedsTokenization.insert(e.startLineNumber,t)}}class B extends a.jG{constructor(e,t,n){super(),this._textModel=e,this._tokenizationPart=t,this._languageIdCodec=n,this._isScheduled=!1,this._isDisposed=!1,this._tokenizationStateStore=null,this._register(z.dG.onDidChange((e=>{const t=this._textModel.getLanguageId();-1!==e.changedLanguages.indexOf(t)&&(this._resetTokenizationState(),this._tokenizationPart.clearTokens())}))),this._resetTokenizationState()}dispose(){this._isDisposed=!0,super.dispose()}handleDidChangeContent(e){if(e.isFlush)this._resetTokenizationState();else{if(this._tokenizationStateStore)for(let t=0,n=e.changes.length;t<n;t++){const n=e.changes[t],[i]=(0,d.W)(n.text);this._tokenizationStateStore.applyEdits(n.range,i)}this._beginBackgroundTokenization()}}handleDidChangeAttached(){this._beginBackgroundTokenization()}handleDidChangeLanguage(e){this._resetTokenizationState(),this._tokenizationPart.clearTokens()}_resetTokenizationState(){const[e,t]=function(e,t){if(e.isTooLargeForTokenization())return[null,null];const n=z.dG.get(t.getLanguageId());if(!n)return[null,null];let i;try{i=n.getInitialState()}catch(e){return(0,o.dz)(e),[null,null]}return[n,i]}(this._textModel,this._tokenizationPart);this._tokenizationStateStore=e&&t?new F(e,t):null,this._beginBackgroundTokenization()}_beginBackgroundTokenization(){!this._isScheduled&&this._textModel.isAttachedToEditor()&&this._hasLinesToTokenize()&&(this._isScheduled=!0,(0,O.cx)((e=>{this._isScheduled=!1,this._backgroundTokenizeWithDeadline(e)})))}_backgroundTokenizeWithDeadline(e){const t=Date.now()+e.timeRemaining(),n=()=>{!this._isDisposed&&this._textModel.isAttachedToEditor()&&this._hasLinesToTokenize()&&(this._backgroundTokenizeForAtLeast1ms(),Date.now()<t?(0,y._p)(n):this._beginBackgroundTokenization())};n()}_backgroundTokenizeForAtLeast1ms(){const e=this._textModel.getLineCount(),t=new A.Z,n=R.W.create(!1);do{if(n.elapsed()>1)break;if(this._tokenizeOneInvalidLine(t)>=e)break}while(this._hasLinesToTokenize());this._tokenizationPart.setTokens(t.finalize(),this._isTokenizationComplete())}tokenizeViewport(e,t){const n=new A.Z;this._tokenizeViewport(n,e,t),this._tokenizationPart.setTokens(n.finalize(),this._isTokenizationComplete())}reset(){this._resetTokenizationState(),this._tokenizationPart.clearTokens()}forceTokenization(e){const t=new A.Z;this._updateTokensUntilLine(t,e),this._tokenizationPart.setTokens(t.finalize(),this._isTokenizationComplete())}getTokenTypeIfInsertingCharacter(e,t){if(!this._tokenizationStateStore)return 0;this.forceTokenization(e.lineNumber);const n=this._tokenizationStateStore.getBeginState(e.lineNumber-1);if(!n)return 0;const i=this._textModel.getLanguageId(),s=this._textModel.getLineContent(e.lineNumber),o=s.substring(0,e.column-1)+t+s.substring(e.column-1),r=W(this._languageIdCodec,i,this._tokenizationStateStore.tokenizationSupport,o,!0,n),a=new M.f(r.tokens,o,this._languageIdCodec);if(0===a.getCount())return 0;const h=a.findTokenIndexAtOffset(e.column-1);return a.getStandardTokenType(h)}tokenizeLineWithEdit(e,t,n){const i=e.lineNumber,s=e.column;if(!this._tokenizationStateStore)return null;this.forceTokenization(i);const o=this._tokenizationStateStore.getBeginState(i-1);if(!o)return null;const r=this._textModel.getLineContent(i),a=r.substring(0,s-1)+n+r.substring(s-1+t),h=this._textModel.getLanguageIdAtPosition(i,0),l=W(this._languageIdCodec,h,this._tokenizationStateStore.tokenizationSupport,a,!0,o);return new M.f(l.tokens,a,this._languageIdCodec)}isCheapToTokenize(e){if(!this._tokenizationStateStore)return!0;const t=this._tokenizationStateStore.invalidLineStartIndex+1;return!(e>t)&&(e<t||this._textModel.getLineLength(e)<2048)}_hasLinesToTokenize(){return!!this._tokenizationStateStore&&this._tokenizationStateStore.invalidLineStartIndex<this._textModel.getLineCount()}_isTokenizationComplete(){return!!this._tokenizationStateStore&&this._tokenizationStateStore.invalidLineStartIndex>=this._textModel.getLineCount()}_tokenizeOneInvalidLine(e){if(!this._tokenizationStateStore||!this._hasLinesToTokenize())return this._textModel.getLineCount()+1;const t=this._tokenizationStateStore.invalidLineStartIndex+1;return this._updateTokensUntilLine(e,t),t}_updateTokensUntilLine(e,t){if(!this._tokenizationStateStore)return;const n=this._textModel.getLanguageId(),i=this._textModel.getLineCount(),s=t-1;for(let t=this._tokenizationStateStore.invalidLineStartIndex;t<=s;t++){const s=this._textModel.getLineContent(t+1),o=this._tokenizationStateStore.getBeginState(t),r=W(this._languageIdCodec,n,this._tokenizationStateStore.tokenizationSupport,s,!0,o);e.add(t+1,r.tokens),this._tokenizationStateStore.setEndState(i,t,r.endState),t=this._tokenizationStateStore.invalidLineStartIndex-1}}_tokenizeViewport(e,t,n){if(!this._tokenizationStateStore)return;if(n<=this._tokenizationStateStore.invalidLineStartIndex)return;if(t<=this._tokenizationStateStore.invalidLineStartIndex)return void this._updateTokensUntilLine(e,n);let i=this._textModel.getLineFirstNonWhitespaceColumn(t);const s=[];let o=null;for(let e=t-1;i>1&&e>=1;e--){const t=this._textModel.getLineFirstNonWhitespaceColumn(e);if(0!==t&&(t<i&&(s.push(this._textModel.getLineContent(e)),i=t,o=this._tokenizationStateStore.getBeginState(e-1),o)))break}o||(o=this._tokenizationStateStore.initialState);const r=this._textModel.getLanguageId();let a=o;for(let e=s.length-1;e>=0;e--){a=W(this._languageIdCodec,r,this._tokenizationStateStore.tokenizationSupport,s[e],!1,a).endState}for(let i=t;i<=n;i++){const t=this._textModel.getLineContent(i),n=W(this._languageIdCodec,r,this._tokenizationStateStore.tokenizationSupport,t,!0,a);e.add(i,n.tokens),this._tokenizationStateStore.markMustBeTokenized(i-1),a=n.endState}}}function W(e,t,n,i,s,r){let a=null;if(n)try{a=n.tokenizeEncoded(i,s,r.clone())}catch(e){(0,o.dz)(e)}return a||(a=(0,E.Lh)(e.encodeLanguageId(t),r)),M.f.convertToEndOffset(a.tokens,i.length),a}var j=n(68262),V=n(51194);class U extends x._{constructor(e,t,n,i,s){super(),this._languageService=e,this._languageConfigurationService=t,this._textModel=n,this.bracketPairsTextModelPart=i,this._languageId=s,this._onDidChangeLanguage=this._register(new r.vl),this.onDidChangeLanguage=this._onDidChangeLanguage.event,this._onDidChangeLanguageConfiguration=this._register(new r.vl),this.onDidChangeLanguageConfiguration=this._onDidChangeLanguageConfiguration.event,this._onDidChangeTokens=this._register(new r.vl),this.onDidChangeTokens=this._onDidChangeTokens.event,this._backgroundTokenizationState=0,this._onBackgroundTokenizationStateChanged=this._register(new r.vl),this._tokens=new j.y(this._languageService.languageIdCodec),this._semanticTokens=new V.s(this._languageService.languageIdCodec),this._tokenization=new B(n,this,this._languageService.languageIdCodec),this._languageRegistryListener=this._languageConfigurationService.onDidChange((e=>{e.affects(this._languageId)&&this._onDidChangeLanguageConfiguration.fire({})}))}acceptEdit(e,t,n,i,s){this._tokens.acceptEdit(e,n,i),this._semanticTokens.acceptEdit(e,n,i,s,t.length>0?t.charCodeAt(0):0)}handleDidChangeAttached(){this._tokenization.handleDidChangeAttached()}flush(){this._tokens.flush(),this._semanticTokens.flush()}handleDidChangeContent(e){this._tokenization.handleDidChangeContent(e)}dispose(){this._languageRegistryListener.dispose(),this._tokenization.dispose(),super.dispose()}get backgroundTokenizationState(){return this._backgroundTokenizationState}handleTokenizationProgress(e){if(2===this._backgroundTokenizationState)return;const t=e?2:1;this._backgroundTokenizationState!==t&&(this._backgroundTokenizationState=t,this.bracketPairsTextModelPart.handleDidChangeBackgroundTokenizationState(),this._onBackgroundTokenizationStateChanged.fire())}setTokens(e,t=!1){if(0!==e.length){const t=[];for(let n=0,i=e.length;n<i;n++){const i=e[n];let s=0,o=0,r=!1;for(let e=i.startLineNumber;e<=i.endLineNumber;e++)if(r)this._tokens.setTokens(this._languageId,e-1,this._textModel.getLineLength(e),i.getLineTokens(e),!1),o=e;else{this._tokens.setTokens(this._languageId,e-1,this._textModel.getLineLength(e),i.getLineTokens(e),!0)&&(r=!0,s=e,o=e)}r&&t.push({fromLineNumber:s,toLineNumber:o})}t.length>0&&this._emitModelTokensChangedEvent({tokenizationSupportChanged:!1,semanticTokensApplied:!1,ranges:t})}this.handleTokenizationProgress(t)}setSemanticTokens(e,t){this._semanticTokens.set(e,t),this._emitModelTokensChangedEvent({tokenizationSupportChanged:!1,semanticTokensApplied:null!==e,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]})}hasCompleteSemanticTokens(){return this._semanticTokens.isComplete()}hasSomeSemanticTokens(){return!this._semanticTokens.isEmpty()}setPartialSemanticTokens(e,t){if(this.hasCompleteSemanticTokens())return;const n=this._textModel.validateRange(this._semanticTokens.setPartial(e,t));this._emitModelTokensChangedEvent({tokenizationSupportChanged:!1,semanticTokensApplied:!0,ranges:[{fromLineNumber:n.startLineNumber,toLineNumber:n.endLineNumber}]})}tokenizeViewport(e,t){e=Math.max(1,e),t=Math.min(this._textModel.getLineCount(),t),this._tokenization.tokenizeViewport(e,t)}clearTokens(){this._tokens.flush(),this._emitModelTokensChangedEvent({tokenizationSupportChanged:!0,semanticTokensApplied:!1,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]})}_emitModelTokensChangedEvent(e){this._textModel._isDisposing()||(this.bracketPairsTextModelPart.handleDidChangeTokens(e),this._onDidChangeTokens.fire(e))}resetTokenization(){this._tokenization.reset()}forceTokenization(e){if(e<1||e>this._textModel.getLineCount())throw new Error("Illegal value for lineNumber");this._tokenization.forceTokenization(e)}isCheapToTokenize(e){return this._tokenization.isCheapToTokenize(e)}tokenizeIfCheap(e){this.isCheapToTokenize(e)&&this.forceTokenization(e)}getLineTokens(e){if(e<1||e>this._textModel.getLineCount())throw new Error("Illegal value for lineNumber");return this._getLineTokens(e)}_getLineTokens(e){const t=this._textModel.getLineContent(e),n=this._tokens.getTokens(this._languageId,e-1,t);return this._semanticTokens.addSparseTokens(e,n)}getTokenTypeIfInsertingCharacter(e,t,n){const i=this._textModel.validatePosition(new u.y(e,t));return this._tokenization.getTokenTypeIfInsertingCharacter(i,n)}tokenizeLineWithEdit(e,t,n){const i=this._textModel.validatePosition(e);return this._tokenization.tokenizeLineWithEdit(i,t,n)}getLanguageConfiguration(e){return this._languageConfigurationService.getLanguageConfiguration(e)}getWordAtPosition(e){this.assertNotDisposed();const t=this._textModel.validatePosition(e),n=this._textModel.getLineContent(t.lineNumber),i=this._getLineTokens(t.lineNumber),s=i.findTokenIndexAtOffset(t.column-1),[o,r]=U._findLanguageBoundaries(i,s),a=(0,w.Th)(t.column,this.getLanguageConfiguration(i.getLanguageId(s)).getWordDefinition(),n.substring(o,r),o);if(a&&a.startColumn<=e.column&&e.column<=a.endColumn)return a;if(s>0&&o===t.column-1){const[o,r]=U._findLanguageBoundaries(i,s-1),a=(0,w.Th)(t.column,this.getLanguageConfiguration(i.getLanguageId(s-1)).getWordDefinition(),n.substring(o,r),o);if(a&&a.startColumn<=e.column&&e.column<=a.endColumn)return a}return null}static _findLanguageBoundaries(e,t){const n=e.getLanguageId(t);let i=0;for(let s=t;s>=0&&e.getLanguageId(s)===n;s--)i=e.getStartOffset(s);let s=e.getLineContent().length;for(let i=t,o=e.getCount();i<o&&e.getLanguageId(i)===n;i++)s=e.getEndOffset(i);return[i,s]}getWordUntilPosition(e){const t=this.getWordAtPosition(e);return t?{word:t.word.substr(0,e.column-t.startColumn),startColumn:t.startColumn,endColumn:e.column}:{word:"",startColumn:e.column,endColumn:e.column}}getLanguageId(){return this._languageId}getLanguageIdAtPosition(e,t){const n=this._textModel.validatePosition(new u.y(e,t)),i=this.getLineTokens(n.lineNumber);return i.getLanguageId(i.findTokenIndexAtOffset(n.column-1))}setLanguageId(e){if(this._languageId===e)return;const t={oldLanguage:this._languageId,newLanguage:e};this._languageId=e,this.bracketPairsTextModelPart.handleDidChangeLanguage(t),this._tokenization.handleDidChangeLanguage(t),this._onDidChangeLanguage.fire(t),this._onDidChangeLanguageConfiguration.fire({})}}var Q=n(83455),H=n(38803),G=function(e,t,n,i){var s,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(r=(o<3?s(r):o>3?s(t,n,r):s(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},q=function(e,t){return function(n,i){t(n,i,e)}};function Z(e,t){let n;return n="string"==typeof e?function(e){const t=new N.x;return t.acceptChunk(e),t.finish()}(e):C.nk(e)?function(e){const t=new N.x;let n;for(;"string"==typeof(n=e.read());)t.acceptChunk(n);return t.finish()}(e):e,n.create(t)}let $=0;class J{constructor(e){this._source=e,this._eos=!1}read(){if(this._eos)return null;const e=[];let t=0,n=0;for(;;){const i=this._source.read();if(null===i)return this._eos=!0,0===t?null:e.join("");if(i.length>0&&(e[t++]=i,n+=i.length),n>=65536)return e.join("")}}}const K=()=>{throw new Error("Invalid change accessor")};let Y=class e extends a.jG{constructor(t,n,i,s=null,o,a,d){super(),this._undoRedoService=o,this._languageService=a,this._languageConfigurationService=d,this._onWillDispose=this._register(new r.vl),this.onWillDispose=this._onWillDispose.event,this._onDidChangeDecorations=this._register(new de((e=>this.handleBeforeFireDecorationsChangedEvent(e)))),this.onDidChangeDecorations=this._onDidChangeDecorations.event,this._onDidChangeOptions=this._register(new r.vl),this.onDidChangeOptions=this._onDidChangeOptions.event,this._onDidChangeAttached=this._register(new r.vl),this.onDidChangeAttached=this._onDidChangeAttached.event,this._onDidChangeInjectedText=this._register(new r.vl),this._eventEmitter=this._register(new ce),this._deltaDecorationCallCnt=0,$++,this.id="$model"+$,this.isForSimpleWidget=i.isForSimpleWidget,this._associatedResource=null==s?l.r.parse("inmemory://model/"+$):s,this._attachedEditorCount=0;const{textBuffer:c,disposable:u}=Z(t,i.defaultEOL);this._buffer=c,this._bufferDisposable=u,this._options=e.resolveOptions(this._buffer,i),this._bracketPairs=this._register(new L.J(this,this._languageConfigurationService)),this._guidesTextModelPart=this._register(new D.P(this,this._languageConfigurationService)),this._decorationProvider=this._register(new b.I(this)),this._tokenizationTextModelPart=new U(this._languageService,this._languageConfigurationService,this,this._bracketPairs,n);const _=this._buffer.getLineCount(),f=this._buffer.getValueLengthInRange(new g.Q(1,1,_,this._buffer.getLineLength(_)+1),0);i.largeFileOptimizations?this._isTooLargeForTokenization=f>e.LARGE_FILE_SIZE_THRESHOLD||_>e.LARGE_FILE_LINE_COUNT_THRESHOLD:this._isTooLargeForTokenization=!1,this._isTooLargeForSyncing=f>e.MODEL_SYNC_LIMIT,this._versionId=1,this._alternativeVersionId=1,this._initialUndoRedoSnapshot=null,this._isDisposed=!1,this.__isDisposing=!1,this._instanceId=h.tk($),this._lastDecorationId=0,this._decorations=Object.create(null),this._decorationsTree=new te,this._commandManager=new k.z8(this,this._undoRedoService),this._isUndoing=!1,this._isRedoing=!1,this._trimAutoWhitespaceLines=null,this._register(this._decorationProvider.onDidChange((()=>{this._onDidChangeDecorations.beginDeferredEmit(),this._onDidChangeDecorations.fire(),this._onDidChangeDecorations.endDeferredEmit()})))}static resolveOptions(e,t){if(t.detectIndentation){const n=(0,v.v)(e,t.tabSize,t.insertSpaces);return new C.X2({tabSize:n.tabSize,indentSize:n.tabSize,insertSpaces:n.insertSpaces,trimAutoWhitespace:t.trimAutoWhitespace,defaultEOL:t.defaultEOL,bracketPairColorizationOptions:t.bracketPairColorizationOptions})}return new C.X2({tabSize:t.tabSize,indentSize:t.indentSize,insertSpaces:t.insertSpaces,trimAutoWhitespace:t.trimAutoWhitespace,defaultEOL:t.defaultEOL,bracketPairColorizationOptions:t.bracketPairColorizationOptions})}get onDidChangeLanguage(){return this._tokenizationTextModelPart.onDidChangeLanguage}get onDidChangeLanguageConfiguration(){return this._tokenizationTextModelPart.onDidChangeLanguageConfiguration}get onDidChangeTokens(){return this._tokenizationTextModelPart.onDidChangeTokens}onDidChangeContent(e){return this._eventEmitter.slowEvent((t=>e(t.contentChangedEvent)))}onDidChangeContentOrInjectedText(e){return(0,a.qE)(this._eventEmitter.fastEvent((t=>e(t))),this._onDidChangeInjectedText.event((t=>e(t))))}_isDisposing(){return this.__isDisposing}get tokenization(){return this._tokenizationTextModelPart}get bracketPairs(){return this._bracketPairs}get guides(){return this._guidesTextModelPart}dispose(){this.__isDisposing=!0,this._onWillDispose.fire(),this._tokenizationTextModelPart.dispose(),this._isDisposed=!0,super.dispose(),this._bufferDisposable.dispose(),this.__isDisposing=!1;const e=new S.a([],"","\n",!1,!1,!0,!0);e.dispose(),this._buffer=e,this._bufferDisposable=a.jG.None}_assertNotDisposed(){if(this._isDisposed)throw new Error("Model is disposed!")}_emitContentChangedEvent(e,t){this.__isDisposing||(this._tokenizationTextModelPart.handleDidChangeContent(t),this._bracketPairs.handleDidChangeContent(t),this._eventEmitter.fire(new Q.Ic(e,t)))}setValue(e){if(this._assertNotDisposed(),null===e)return;const{textBuffer:t,disposable:n}=Z(e,this._options.defaultEOL);this._setValueFromTextBuffer(t,n)}_createContentChanged2(e,t,n,i,s,o,r){return{changes:[{range:e,rangeOffset:t,rangeLength:n,text:i}],eol:this._buffer.getEOL(),versionId:this.getVersionId(),isUndoing:s,isRedoing:o,isFlush:r}}_setValueFromTextBuffer(e,t){this._assertNotDisposed();const n=this.getFullModelRange(),i=this.getValueLengthInRange(n),s=this.getLineCount(),o=this.getLineMaxColumn(s);this._buffer=e,this._bufferDisposable.dispose(),this._bufferDisposable=t,this._increaseVersionId(),this._tokenizationTextModelPart.flush(),this._decorations=Object.create(null),this._decorationsTree=new te,this._commandManager.clear(),this._trimAutoWhitespaceLines=null,this._emitContentChangedEvent(new Q.HP([new Q.Wn],this._versionId,!1,!1),this._createContentChanged2(new g.Q(1,1,s,o),0,i,this.getValue(),!1,!1,!0))}setEOL(e){this._assertNotDisposed();const t=1===e?"\r\n":"\n";if(this._buffer.getEOL()===t)return;const n=this.getFullModelRange(),i=this.getValueLengthInRange(n),s=this.getLineCount(),o=this.getLineMaxColumn(s);this._onBeforeEOLChange(),this._buffer.setEOL(t),this._increaseVersionId(),this._onAfterEOLChange(),this._emitContentChangedEvent(new Q.HP([new Q.mS],this._versionId,!1,!1),this._createContentChanged2(new g.Q(1,1,s,o),0,i,this.getValue(),!1,!1,!1))}_onBeforeEOLChange(){this._decorationsTree.ensureAllNodesHaveRanges(this)}_onAfterEOLChange(){const e=this.getVersionId(),t=this._decorationsTree.collectNodesPostOrder();for(let n=0,i=t.length;n<i;n++){const i=t[n],s=i.range,o=i.cachedAbsoluteStart-i.start,r=this._buffer.getOffsetAt(s.startLineNumber,s.startColumn),a=this._buffer.getOffsetAt(s.endLineNumber,s.endColumn);i.cachedAbsoluteStart=r,i.cachedAbsoluteEnd=a,i.cachedVersionId=e,i.start=r-o,i.end=a-o,(0,T.KJ)(i)}}onBeforeAttached(){this._attachedEditorCount++,1===this._attachedEditorCount&&(this._tokenizationTextModelPart.handleDidChangeAttached(),this._onDidChangeAttached.fire(void 0))}onBeforeDetached(){this._attachedEditorCount--,0===this._attachedEditorCount&&(this._tokenizationTextModelPart.handleDidChangeAttached(),this._onDidChangeAttached.fire(void 0))}isAttachedToEditor(){return this._attachedEditorCount>0}getAttachedEditorCount(){return this._attachedEditorCount}isTooLargeForSyncing(){return this._isTooLargeForSyncing}isTooLargeForTokenization(){return this._isTooLargeForTokenization}isDisposed(){return this._isDisposed}isDominatedByLongLines(){if(this._assertNotDisposed(),this.isTooLargeForTokenization())return!1;let e=0,t=0;const n=this._buffer.getLineCount();for(let i=1;i<=n;i++){const n=this._buffer.getLineLength(i);n>=1e4?t+=n:e+=n}return t>e}get uri(){return this._associatedResource}getOptions(){return this._assertNotDisposed(),this._options}getFormattingOptions(){return{tabSize:this._options.indentSize,insertSpaces:this._options.insertSpaces}}updateOptions(e){this._assertNotDisposed();const t=void 0!==e.tabSize?e.tabSize:this._options.tabSize,n=void 0!==e.indentSize?e.indentSize:this._options.indentSize,i=void 0!==e.insertSpaces?e.insertSpaces:this._options.insertSpaces,s=void 0!==e.trimAutoWhitespace?e.trimAutoWhitespace:this._options.trimAutoWhitespace,o=void 0!==e.bracketColorizationOptions?e.bracketColorizationOptions:this._options.bracketPairColorizationOptions,r=new C.X2({tabSize:t,indentSize:n,insertSpaces:i,defaultEOL:this._options.defaultEOL,trimAutoWhitespace:s,bracketPairColorizationOptions:o});if(this._options.equals(r))return;const a=this._options.createChangeEvent(r);this._options=r,this._bracketPairs.handleDidChangeOptions(a),this._decorationProvider.handleDidChangeOptions(a),this._onDidChangeOptions.fire(a)}detectIndentation(e,t){this._assertNotDisposed();const n=(0,v.v)(this._buffer,t,e);this.updateOptions({insertSpaces:n.insertSpaces,tabSize:n.tabSize,indentSize:n.tabSize})}normalizeIndentation(e){return this._assertNotDisposed(),(0,c.P)(e,this._options.indentSize,this._options.insertSpaces)}getVersionId(){return this._assertNotDisposed(),this._versionId}mightContainRTL(){return this._buffer.mightContainRTL()}mightContainUnusualLineTerminators(){return this._buffer.mightContainUnusualLineTerminators()}removeUnusualLineTerminators(e=null){const t=this.findMatches(h._J.source,!1,!0,!1,null,!1,1073741824);this._buffer.resetMightContainUnusualLineTerminators(),this.pushEditOperations(e,t.map((e=>({range:e.range,text:null}))),(()=>null))}mightContainNonBasicASCII(){return this._buffer.mightContainNonBasicASCII()}getAlternativeVersionId(){return this._assertNotDisposed(),this._alternativeVersionId}getInitialUndoRedoSnapshot(){return this._assertNotDisposed(),this._initialUndoRedoSnapshot}getOffsetAt(e){this._assertNotDisposed();const t=this._validatePosition(e.lineNumber,e.column,0);return this._buffer.getOffsetAt(t.lineNumber,t.column)}getPositionAt(e){this._assertNotDisposed();const t=Math.min(this._buffer.getLength(),Math.max(0,e));return this._buffer.getPositionAt(t)}_increaseVersionId(){this._versionId=this._versionId+1,this._alternativeVersionId=this._versionId}_overwriteVersionId(e){this._versionId=e}_overwriteAlternativeVersionId(e){this._alternativeVersionId=e}_overwriteInitialUndoRedoSnapshot(e){this._initialUndoRedoSnapshot=e}getValue(e,t=!1){this._assertNotDisposed();const n=this.getFullModelRange(),i=this.getValueInRange(n,e);return t?this._buffer.getBOM()+i:i}createSnapshot(e=!1){return new J(this._buffer.createSnapshot(e))}getValueLength(e,t=!1){this._assertNotDisposed();const n=this.getFullModelRange(),i=this.getValueLengthInRange(n,e);return t?this._buffer.getBOM().length+i:i}getValueInRange(e,t=0){return this._assertNotDisposed(),this._buffer.getValueInRange(this.validateRange(e),t)}getValueLengthInRange(e,t=0){return this._assertNotDisposed(),this._buffer.getValueLengthInRange(this.validateRange(e),t)}getCharacterCountInRange(e,t=0){return this._assertNotDisposed(),this._buffer.getCharacterCountInRange(this.validateRange(e),t)}getLineCount(){return this._assertNotDisposed(),this._buffer.getLineCount()}getLineContent(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new Error("Illegal value for lineNumber");return this._buffer.getLineContent(e)}getLineLength(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new Error("Illegal value for lineNumber");return this._buffer.getLineLength(e)}getLinesContent(){return this._assertNotDisposed(),this._buffer.getLinesContent()}getEOL(){return this._assertNotDisposed(),this._buffer.getEOL()}getEndOfLineSequence(){return this._assertNotDisposed(),"\n"===this._buffer.getEOL()?0:1}getLineMinColumn(e){return this._assertNotDisposed(),1}getLineMaxColumn(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new Error("Illegal value for lineNumber");return this._buffer.getLineLength(e)+1}getLineFirstNonWhitespaceColumn(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new Error("Illegal value for lineNumber");return this._buffer.getLineFirstNonWhitespaceColumn(e)}getLineLastNonWhitespaceColumn(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new Error("Illegal value for lineNumber");return this._buffer.getLineLastNonWhitespaceColumn(e)}_validateRangeRelaxedNoAllocations(e){const t=this._buffer.getLineCount(),n=e.startLineNumber,i=e.startColumn;let s=Math.floor("number"!=typeof n||isNaN(n)?1:n),o=Math.floor("number"!=typeof i||isNaN(i)?1:i);if(s<1)s=1,o=1;else if(s>t)s=t,o=this.getLineMaxColumn(s);else if(o<=1)o=1;else{const e=this.getLineMaxColumn(s);o>=e&&(o=e)}const r=e.endLineNumber,a=e.endColumn;let h=Math.floor("number"!=typeof r||isNaN(r)?1:r),l=Math.floor("number"!=typeof a||isNaN(a)?1:a);if(h<1)h=1,l=1;else if(h>t)h=t,l=this.getLineMaxColumn(h);else if(l<=1)l=1;else{const e=this.getLineMaxColumn(h);l>=e&&(l=e)}return n===s&&i===o&&r===h&&a===l&&e instanceof g.Q&&!(e instanceof _.L)?e:new g.Q(s,o,h,l)}_isValidPosition(e,t,n){if("number"!=typeof e||"number"!=typeof t)return!1;if(isNaN(e)||isNaN(t))return!1;if(e<1||t<1)return!1;if((0|e)!==e||(0|t)!==t)return!1;if(e>this._buffer.getLineCount())return!1;if(1===t)return!0;if(t>this.getLineMaxColumn(e))return!1;if(1===n){const n=this._buffer.getLineCharCode(e,t-2);if(h.pc(n))return!1}return!0}_validatePosition(e,t,n){const i=Math.floor("number"!=typeof e||isNaN(e)?1:e),s=Math.floor("number"!=typeof t||isNaN(t)?1:t),o=this._buffer.getLineCount();if(i<1)return new u.y(1,1);if(i>o)return new u.y(o,this.getLineMaxColumn(o));if(s<=1)return new u.y(i,1);const r=this.getLineMaxColumn(i);if(s>=r)return new u.y(i,r);if(1===n){const e=this._buffer.getLineCharCode(i,s-2);if(h.pc(e))return new u.y(i,s-1)}return new u.y(i,s)}validatePosition(e){return this._assertNotDisposed(),e instanceof u.y&&this._isValidPosition(e.lineNumber,e.column,1)?e:this._validatePosition(e.lineNumber,e.column,1)}_isValidRange(e,t){const n=e.startLineNumber,i=e.startColumn,s=e.endLineNumber,o=e.endColumn;if(!this._isValidPosition(n,i,0))return!1;if(!this._isValidPosition(s,o,0))return!1;if(1===t){const e=i>1?this._buffer.getLineCharCode(n,i-2):0,t=o>1&&o<=this._buffer.getLineLength(s)?this._buffer.getLineCharCode(s,o-2):0,r=h.pc(e),a=h.pc(t);return!r&&!a}return!0}validateRange(e){if(this._assertNotDisposed(),e instanceof g.Q&&!(e instanceof _.L)&&this._isValidRange(e,1))return e;const t=this._validatePosition(e.startLineNumber,e.startColumn,0),n=this._validatePosition(e.endLineNumber,e.endColumn,0),i=t.lineNumber,s=t.column,o=n.lineNumber,r=n.column;{const e=s>1?this._buffer.getLineCharCode(i,s-2):0,t=r>1&&r<=this._buffer.getLineLength(o)?this._buffer.getLineCharCode(o,r-2):0,n=h.pc(e),a=h.pc(t);return n||a?i===o&&s===r?new g.Q(i,s-1,o,r-1):n&&a?new g.Q(i,s-1,o,r+1):n?new g.Q(i,s-1,o,r):new g.Q(i,s,o,r+1):new g.Q(i,s,o,r)}}modifyPosition(e,t){this._assertNotDisposed();const n=this.getOffsetAt(e)+t;return this.getPositionAt(Math.min(this._buffer.getLength(),Math.max(0,n)))}getFullModelRange(){this._assertNotDisposed();const e=this.getLineCount();return new g.Q(1,1,e,this.getLineMaxColumn(e))}findMatchesLineByLine(e,t,n,i){return this._buffer.findMatchesLineByLine(e,t,n,i)}findMatches(e,t,n,i,s,o,r=999){this._assertNotDisposed();let a=null;null!==t&&(Array.isArray(t)||(t=[t]),t.every((e=>g.Q.isIRange(e)))&&(a=t.map((e=>this.validateRange(e))))),null===a&&(a=[this.getFullModelRange()]),a=a.sort(((e,t)=>e.startLineNumber-t.startLineNumber||e.startColumn-t.startColumn));const h=[];let l;if(h.push(a.reduce(((e,t)=>g.Q.areIntersecting(e,t)?e.plusRange(t):(h.push(e),t)))),!n&&e.indexOf("\n")<0){const t=new I.lt(e,n,i,s).parseSearchRequest();if(!t)return[];l=e=>this.findMatchesLineByLine(e,t,o,r)}else l=t=>I.hB.findMatches(this,new I.lt(e,n,i,s),t,o,r);return h.map(l).reduce(((e,t)=>e.concat(t)),[])}findNextMatch(e,t,n,i,s,o){this._assertNotDisposed();const r=this.validatePosition(t);if(!n&&e.indexOf("\n")<0){const t=new I.lt(e,n,i,s).parseSearchRequest();if(!t)return null;const a=this.getLineCount();let h=new g.Q(r.lineNumber,r.column,a,this.getLineMaxColumn(a)),l=this.findMatchesLineByLine(h,t,o,1);return I.hB.findNextMatch(this,new I.lt(e,n,i,s),r,o),l.length>0?l[0]:(h=new g.Q(1,1,r.lineNumber,this.getLineMaxColumn(r.lineNumber)),l=this.findMatchesLineByLine(h,t,o,1),l.length>0?l[0]:null)}return I.hB.findNextMatch(this,new I.lt(e,n,i,s),r,o)}findPreviousMatch(e,t,n,i,s,o){this._assertNotDisposed();const r=this.validatePosition(t);return I.hB.findPreviousMatch(this,new I.lt(e,n,i,s),r,o)}pushStackElement(){this._commandManager.pushStackElement()}popStackElement(){this._commandManager.popStackElement()}pushEOL(e){if(("\n"===this.getEOL()?0:1)!==e)try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),null===this._initialUndoRedoSnapshot&&(this._initialUndoRedoSnapshot=this._undoRedoService.createSnapshot(this.uri)),this._commandManager.pushEOL(e)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_validateEditOperation(e){return e instanceof C.Wo?e:new C.Wo(e.identifier||null,this.validateRange(e.range),e.text,e.forceMoveMarkers||!1,e.isAutoWhitespaceEdit||!1,e._isTracked||!1)}_validateEditOperations(e){const t=[];for(let n=0,i=e.length;n<i;n++)t[n]=this._validateEditOperation(e[n]);return t}pushEditOperations(e,t,n){try{return this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._pushEditOperations(e,this._validateEditOperations(t),n)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_pushEditOperations(e,t,n){if(this._options.trimAutoWhitespace&&this._trimAutoWhitespaceLines){const n=t.map((e=>({range:this.validateRange(e.range),text:e.text})));let i=!0;if(e)for(let t=0,s=e.length;t<s;t++){const s=e[t];let o=!1;for(let e=0,t=n.length;e<t;e++){const t=n[e].range,i=t.startLineNumber>s.endLineNumber,r=s.startLineNumber>t.endLineNumber;if(!i&&!r){o=!0;break}}if(!o){i=!1;break}}if(i)for(let e=0,i=this._trimAutoWhitespaceLines.length;e<i;e++){const i=this._trimAutoWhitespaceLines[e],s=this.getLineMaxColumn(i);let o=!0;for(let e=0,t=n.length;e<t;e++){const t=n[e].range,r=n[e].text;if(!(i<t.startLineNumber||i>t.endLineNumber)&&!(i===t.startLineNumber&&t.startColumn===s&&t.isEmpty()&&r&&r.length>0&&"\n"===r.charAt(0)||i===t.startLineNumber&&1===t.startColumn&&t.isEmpty()&&r&&r.length>0&&"\n"===r.charAt(r.length-1))){o=!1;break}}if(o){const e=new g.Q(i,1,i,s);t.push(new C.Wo(null,e,null,!1,!1,!1))}}this._trimAutoWhitespaceLines=null}return null===this._initialUndoRedoSnapshot&&(this._initialUndoRedoSnapshot=this._undoRedoService.createSnapshot(this.uri)),this._commandManager.pushEditOperation(e,t,n)}_applyUndo(e,t,n,i){const s=e.map((e=>{const t=this.getPositionAt(e.newPosition),n=this.getPositionAt(e.newEnd);return{range:new g.Q(t.lineNumber,t.column,n.lineNumber,n.column),text:e.oldText}}));this._applyUndoRedoEdits(s,t,!0,!1,n,i)}_applyRedo(e,t,n,i){const s=e.map((e=>{const t=this.getPositionAt(e.oldPosition),n=this.getPositionAt(e.oldEnd);return{range:new g.Q(t.lineNumber,t.column,n.lineNumber,n.column),text:e.newText}}));this._applyUndoRedoEdits(s,t,!1,!0,n,i)}_applyUndoRedoEdits(e,t,n,i,s,o){try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._isUndoing=n,this._isRedoing=i,this.applyEdits(e,!1),this.setEOL(t),this._overwriteAlternativeVersionId(s)}finally{this._isUndoing=!1,this._isRedoing=!1,this._eventEmitter.endDeferredEmit(o),this._onDidChangeDecorations.endDeferredEmit()}}applyEdits(e,t=!1){try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit();const n=this._validateEditOperations(e);return this._doApplyEdits(n,t)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_doApplyEdits(e,t){const n=this._buffer.getLineCount(),s=this._buffer.applyEdits(e,this._options.trimAutoWhitespace,t),o=this._buffer.getLineCount(),r=s.changes;if(this._trimAutoWhitespaceLines=s.trimAutoWhitespaceLineNumbers,0!==r.length){for(let e=0,t=r.length;e<t;e++){const t=r[e],[n,i,s]=(0,d.W)(t.text);this._tokenizationTextModelPart.acceptEdit(t.range,t.text,n,i,s),this._decorationsTree.acceptReplace(t.rangeOffset,t.rangeLength,t.text.length,t.forceMoveMarkers)}const e=[];this._increaseVersionId();let t=n;for(let n=0,s=r.length;n<s;n++){const s=r[n],[a]=(0,d.W)(s.text);this._onDidChangeDecorations.fire();const h=s.range.startLineNumber,l=s.range.endLineNumber,c=l-h,g=a,_=Math.min(c,g),f=g-c,p=o-t-f+h,m=p,C=p+g,L=this._decorationsTree.getInjectedTextInInterval(this,this.getOffsetAt(new u.y(m,1)),this.getOffsetAt(new u.y(C,this.getLineMaxColumn(C))),0),b=Q.uK.fromDecorations(L),k=new i.j3(b);for(let t=_;t>=0;t--){const n=h+t,i=p+t;k.takeFromEndWhile((e=>e.lineNumber>i));const s=k.takeFromEndWhile((e=>e.lineNumber===i));e.push(new Q.U0(n,this.getLineContent(i),s))}if(_<c){const t=h+_;e.push(new Q.E$(t+1,l))}if(_<g){const n=new i.j3(b),s=h+_,r=g-_,a=o-t-r+s+1,l=[],d=[];for(let e=0;e<r;e++){const t=a+e;d[e]=this.getLineContent(t),n.takeWhile((e=>e.lineNumber<t)),l[e]=n.takeWhile((e=>e.lineNumber===t))}e.push(new Q.bg(s+1,h+g,d,l))}t+=f}this._emitContentChangedEvent(new Q.HP(e,this.getVersionId(),this._isUndoing,this._isRedoing),{changes:r,eol:this._buffer.getEOL(),versionId:this.getVersionId(),isUndoing:this._isUndoing,isRedoing:this._isRedoing,isFlush:!1})}return null===s.reverseEdits?void 0:s.reverseEdits}undo(){return this._undoRedoService.undo(this.uri)}canUndo(){return this._undoRedoService.canUndo(this.uri)}redo(){return this._undoRedoService.redo(this.uri)}canRedo(){return this._undoRedoService.canRedo(this.uri)}handleBeforeFireDecorationsChangedEvent(e){if(null===e||0===e.size)return;const t=Array.from(e).map((e=>new Q.U0(e,this.getLineContent(e),this._getInjectedTextInLine(e))));this._onDidChangeInjectedText.fire(new Q.vn(t))}changeDecorations(e,t=0){this._assertNotDisposed();try{return this._onDidChangeDecorations.beginDeferredEmit(),this._changeDecorations(t,e)}finally{this._onDidChangeDecorations.endDeferredEmit()}}_changeDecorations(e,t){const n={addDecoration:(t,n)=>this._deltaDecorationsImpl(e,[],[{range:t,options:n}])[0],changeDecoration:(e,t)=>{this._changeDecorationImpl(e,t)},changeDecorationOptions:(e,t)=>{this._changeDecorationOptionsImpl(e,le(t))},removeDecoration:t=>{this._deltaDecorationsImpl(e,[t],[])},deltaDecorations:(t,n)=>0===t.length&&0===n.length?[]:this._deltaDecorationsImpl(e,t,n)};let i=null;try{i=t(n)}catch(e){(0,o.dz)(e)}return n.addDecoration=K,n.changeDecoration=K,n.changeDecorationOptions=K,n.removeDecoration=K,n.deltaDecorations=K,i}deltaDecorations(e,t,n=0){if(this._assertNotDisposed(),e||(e=[]),0===e.length&&0===t.length)return[];try{return this._deltaDecorationCallCnt++,this._deltaDecorationCallCnt>1&&(console.warn("Invoking deltaDecorations recursively could lead to leaking decorations."),(0,o.dz)(new Error("Invoking deltaDecorations recursively could lead to leaking decorations."))),this._onDidChangeDecorations.beginDeferredEmit(),this._deltaDecorationsImpl(n,e,t)}finally{this._onDidChangeDecorations.endDeferredEmit(),this._deltaDecorationCallCnt--}}_getTrackedRange(e){return this.getDecorationRange(e)}_setTrackedRange(e,t,n){const i=e?this._decorations[e]:null;if(!i)return t?this._deltaDecorationsImpl(0,[],[{range:t,options:he[n]}])[0]:null;if(!t)return this._decorationsTree.delete(i),delete this._decorations[i.id],null;const s=this._validateRangeRelaxedNoAllocations(t),o=this._buffer.getOffsetAt(s.startLineNumber,s.startColumn),r=this._buffer.getOffsetAt(s.endLineNumber,s.endColumn);return this._decorationsTree.delete(i),i.reset(this.getVersionId(),o,r,s),i.setOptions(he[n]),this._decorationsTree.insert(i),i.id}removeAllDecorationsWithOwnerId(e){if(this._isDisposed)return;const t=this._decorationsTree.collectNodesFromOwner(e);for(let e=0,n=t.length;e<n;e++){const n=t[e];this._decorationsTree.delete(n),delete this._decorations[n.id]}}getDecorationOptions(e){const t=this._decorations[e];return t?t.options:null}getDecorationRange(e){const t=this._decorations[e];return t?this._decorationsTree.getNodeRange(this,t):null}getLineDecorations(e,t=0,n=!1){return e<1||e>this.getLineCount()?[]:this.getLinesDecorations(e,e,t,n)}getLinesDecorations(e,t,n=0,s=!1){const o=this.getLineCount(),r=Math.min(o,Math.max(1,e)),a=Math.min(o,Math.max(1,t)),h=this.getLineMaxColumn(a),l=new g.Q(r,1,a,h),d=this._getDecorationsInRange(l,n,s);return(0,i.E4)(d,this._decorationProvider.getDecorationsInRange(l,n,s)),d}getDecorationsInRange(e,t=0,n=!1){const s=this.validateRange(e),o=this._getDecorationsInRange(s,t,n);return(0,i.E4)(o,this._decorationProvider.getDecorationsInRange(s,t,n)),o}getOverviewRulerDecorations(e=0,t=!1){return this._decorationsTree.getAll(this,e,t,!0)}getInjectedTextDecorations(e=0){return this._decorationsTree.getAllInjectedText(this,e)}_getInjectedTextInLine(e){const t=this._buffer.getOffsetAt(e,1),n=t+this._buffer.getLineLength(e),i=this._decorationsTree.getInjectedTextInInterval(this,t,n,0);return Q.uK.fromDecorations(i).filter((t=>t.lineNumber===e))}getAllDecorations(e=0,t=!1){let n=this._decorationsTree.getAll(this,e,t,!1);return n=n.concat(this._decorationProvider.getAllDecorations(e,t)),n}_getDecorationsInRange(e,t,n){const i=this._buffer.getOffsetAt(e.startLineNumber,e.startColumn),s=this._buffer.getOffsetAt(e.endLineNumber,e.endColumn);return this._decorationsTree.getAllInInterval(this,i,s,t,n)}getRangeAt(e,t){return this._buffer.getRangeAt(e,t-e)}_changeDecorationImpl(e,t){const n=this._decorations[e];if(!n)return;if(n.options.after){const t=this.getDecorationRange(e);this._onDidChangeDecorations.recordLineAffectedByInjectedText(t.endLineNumber)}if(n.options.before){const t=this.getDecorationRange(e);this._onDidChangeDecorations.recordLineAffectedByInjectedText(t.startLineNumber)}const i=this._validateRangeRelaxedNoAllocations(t),s=this._buffer.getOffsetAt(i.startLineNumber,i.startColumn),o=this._buffer.getOffsetAt(i.endLineNumber,i.endColumn);this._decorationsTree.delete(n),n.reset(this.getVersionId(),s,o,i),this._decorationsTree.insert(n),this._onDidChangeDecorations.checkAffectedAndFire(n.options),n.options.after&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(i.endLineNumber),n.options.before&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(i.startLineNumber)}_changeDecorationOptionsImpl(e,t){const n=this._decorations[e];if(!n)return;const i=!(!n.options.overviewRuler||!n.options.overviewRuler.color),s=!(!t.overviewRuler||!t.overviewRuler.color);if(this._onDidChangeDecorations.checkAffectedAndFire(n.options),this._onDidChangeDecorations.checkAffectedAndFire(t),n.options.after||t.after){const e=this._decorationsTree.getNodeRange(this,n);this._onDidChangeDecorations.recordLineAffectedByInjectedText(e.endLineNumber)}if(n.options.before||t.before){const e=this._decorationsTree.getNodeRange(this,n);this._onDidChangeDecorations.recordLineAffectedByInjectedText(e.startLineNumber)}i!==s?(this._decorationsTree.delete(n),n.setOptions(t),this._decorationsTree.insert(n)):n.setOptions(t)}_deltaDecorationsImpl(e,t,n){const i=this.getVersionId(),s=t.length;let o=0;const r=n.length;let a=0;const h=new Array(r);for(;o<s||a<r;){let l=null;if(o<s){do{l=this._decorations[t[o++]]}while(!l&&o<s);if(l){if(l.options.after){const e=this._decorationsTree.getNodeRange(this,l);this._onDidChangeDecorations.recordLineAffectedByInjectedText(e.endLineNumber)}if(l.options.before){const e=this._decorationsTree.getNodeRange(this,l);this._onDidChangeDecorations.recordLineAffectedByInjectedText(e.startLineNumber)}this._decorationsTree.delete(l),this._onDidChangeDecorations.checkAffectedAndFire(l.options)}}if(a<r){if(!l){const e=++this._lastDecorationId,t=`${this._instanceId};${e}`;l=new T.CW(t,0,0),this._decorations[t]=l}const t=n[a],s=this._validateRangeRelaxedNoAllocations(t.range),o=le(t.options),r=this._buffer.getOffsetAt(s.startLineNumber,s.startColumn),d=this._buffer.getOffsetAt(s.endLineNumber,s.endColumn);l.ownerId=e,l.reset(i,r,d,s),l.setOptions(o),l.options.after&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(s.endLineNumber),l.options.before&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(s.startLineNumber),this._onDidChangeDecorations.checkAffectedAndFire(o),this._decorationsTree.insert(l),h[a]=l.id,a++}else l&&delete this._decorations[l.id]}return h}getLanguageId(){return this.tokenization.getLanguageId()}setMode(e){this.tokenization.setLanguageId(e)}getLanguageIdAtPosition(e,t){return this.tokenization.getLanguageIdAtPosition(e,t)}getWordAtPosition(e){return this._tokenizationTextModelPart.getWordAtPosition(e)}getWordUntilPosition(e){return this._tokenizationTextModelPart.getWordUntilPosition(e)}normalizePosition(e,t){return e}getLineIndentColumn(e){return function(e){let t=0;for(const n of e){if(" "!==n&&"\t"!==n)break;t++}return t}(this.getLineContent(e))+1}};function X(e){return!(!e.options.overviewRuler||!e.options.overviewRuler.color)}function ee(e){return!!e.options.after||!!e.options.before}Y.MODEL_SYNC_LIMIT=52428800,Y.LARGE_FILE_SIZE_THRESHOLD=20971520,Y.LARGE_FILE_LINE_COUNT_THRESHOLD=3e5,Y.DEFAULT_CREATION_OPTIONS={isForSimpleWidget:!1,tabSize:f.R.tabSize,indentSize:f.R.indentSize,insertSpaces:f.R.insertSpaces,detectIndentation:!1,defaultEOL:1,trimAutoWhitespace:f.R.trimAutoWhitespace,largeFileOptimizations:f.R.largeFileOptimizations,bracketPairColorizationOptions:f.R.bracketPairColorizationOptions},Y=G([q(4,H.$D),q(5,p.L),q(6,m.JZ)],Y);class te{constructor(){this._decorationsTree0=new T.MF,this._decorationsTree1=new T.MF,this._injectedTextDecorationsTree=new T.MF}ensureAllNodesHaveRanges(e){this.getAll(e,0,!1,!1)}_ensureNodesHaveRanges(e,t){for(const n of t)null===n.range&&(n.range=e.getRangeAt(n.cachedAbsoluteStart,n.cachedAbsoluteEnd));return t}getAllInInterval(e,t,n,i,s){const o=e.getVersionId(),r=this._intervalSearch(t,n,i,s,o);return this._ensureNodesHaveRanges(e,r)}_intervalSearch(e,t,n,i,s){const o=this._decorationsTree0.intervalSearch(e,t,n,i,s),r=this._decorationsTree1.intervalSearch(e,t,n,i,s),a=this._injectedTextDecorationsTree.intervalSearch(e,t,n,i,s);return o.concat(r).concat(a)}getInjectedTextInInterval(e,t,n,i){const s=e.getVersionId(),o=this._injectedTextDecorationsTree.intervalSearch(t,n,i,!1,s);return this._ensureNodesHaveRanges(e,o).filter((e=>e.options.showIfCollapsed||!e.range.isEmpty()))}getAllInjectedText(e,t){const n=e.getVersionId(),i=this._injectedTextDecorationsTree.search(t,!1,n);return this._ensureNodesHaveRanges(e,i).filter((e=>e.options.showIfCollapsed||!e.range.isEmpty()))}getAll(e,t,n,i){const s=e.getVersionId(),o=this._search(t,n,i,s);return this._ensureNodesHaveRanges(e,o)}_search(e,t,n,i){if(n)return this._decorationsTree1.search(e,t,i);{const n=this._decorationsTree0.search(e,t,i),s=this._decorationsTree1.search(e,t,i),o=this._injectedTextDecorationsTree.search(e,t,i);return n.concat(s).concat(o)}}collectNodesFromOwner(e){const t=this._decorationsTree0.collectNodesFromOwner(e),n=this._decorationsTree1.collectNodesFromOwner(e),i=this._injectedTextDecorationsTree.collectNodesFromOwner(e);return t.concat(n).concat(i)}collectNodesPostOrder(){const e=this._decorationsTree0.collectNodesPostOrder(),t=this._decorationsTree1.collectNodesPostOrder(),n=this._injectedTextDecorationsTree.collectNodesPostOrder();return e.concat(t).concat(n)}insert(e){ee(e)?this._injectedTextDecorationsTree.insert(e):X(e)?this._decorationsTree1.insert(e):this._decorationsTree0.insert(e)}delete(e){ee(e)?this._injectedTextDecorationsTree.delete(e):X(e)?this._decorationsTree1.delete(e):this._decorationsTree0.delete(e)}getNodeRange(e,t){const n=e.getVersionId();return t.cachedVersionId!==n&&this._resolveNode(t,n),null===t.range&&(t.range=e.getRangeAt(t.cachedAbsoluteStart,t.cachedAbsoluteEnd)),t.range}_resolveNode(e,t){ee(e)?this._injectedTextDecorationsTree.resolveNode(e,t):X(e)?this._decorationsTree1.resolveNode(e,t):this._decorationsTree0.resolveNode(e,t)}acceptReplace(e,t,n,i){this._decorationsTree0.acceptReplace(e,t,n,i),this._decorationsTree1.acceptReplace(e,t,n,i),this._injectedTextDecorationsTree.acceptReplace(e,t,n,i)}}function ne(e){return e.replace(/[^a-z0-9\-_]/gi," ")}class ie{constructor(e){this.color=e.color||"",this.darkColor=e.darkColor||""}}class se extends ie{constructor(e){super(e),this._resolvedColor=null,this.position="number"==typeof e.position?e.position:C.A5.Center}getColor(e){return this._resolvedColor||("light"!==e.type&&this.darkColor?this._resolvedColor=this._resolveColor(this.darkColor,e):this._resolvedColor=this._resolveColor(this.color,e)),this._resolvedColor}invalidateCachedColor(){this._resolvedColor=null}_resolveColor(e,t){if("string"==typeof e)return e;const n=e?t.getColor(e.id):null;return n?n.toString():""}}class oe extends ie{constructor(e){super(e),this.position=e.position}getColor(e){return this._resolvedColor||("light"!==e.type&&this.darkColor?this._resolvedColor=this._resolveColor(this.darkColor,e):this._resolvedColor=this._resolveColor(this.color,e)),this._resolvedColor}invalidateCachedColor(){this._resolvedColor=void 0}_resolveColor(e,t){return"string"==typeof e?s.Q1.fromHex(e):t.getColor(e.id)}}class re{constructor(e){this.content=e.content||"",this.inlineClassName=e.inlineClassName||null,this.inlineClassNameAffectsLetterSpacing=e.inlineClassNameAffectsLetterSpacing||!1,this.attachedData=e.attachedData||null,this.cursorStops=e.cursorStops||null}static from(e){return e instanceof re?e:new re(e)}}class ae{constructor(e){var t,n;this.description=e.description,this.blockClassName=e.blockClassName?ne(e.blockClassName):null,this.stickiness=e.stickiness||0,this.zIndex=e.zIndex||0,this.className=e.className?ne(e.className):null,this.hoverMessage=e.hoverMessage||null,this.glyphMarginHoverMessage=e.glyphMarginHoverMessage||null,this.isWholeLine=e.isWholeLine||!1,this.showIfCollapsed=e.showIfCollapsed||!1,this.collapseOnReplaceEdit=e.collapseOnReplaceEdit||!1,this.overviewRuler=e.overviewRuler?new se(e.overviewRuler):null,this.minimap=e.minimap?new oe(e.minimap):null,this.glyphMarginClassName=e.glyphMarginClassName?ne(e.glyphMarginClassName):null,this.linesDecorationsClassName=e.linesDecorationsClassName?ne(e.linesDecorationsClassName):null,this.firstLineDecorationClassName=e.firstLineDecorationClassName?ne(e.firstLineDecorationClassName):null,this.marginClassName=e.marginClassName?ne(e.marginClassName):null,this.inlineClassName=e.inlineClassName?ne(e.inlineClassName):null,this.inlineClassNameAffectsLetterSpacing=e.inlineClassNameAffectsLetterSpacing||!1,this.beforeContentClassName=e.beforeContentClassName?ne(e.beforeContentClassName):null,this.afterContentClassName=e.afterContentClassName?ne(e.afterContentClassName):null,this.after=e.after?re.from(e.after):null,this.before=e.before?re.from(e.before):null,this.hideInCommentTokens=null!==(t=e.hideInCommentTokens)&&void 0!==t&&t,this.hideInStringTokens=null!==(n=e.hideInStringTokens)&&void 0!==n&&n}static register(e){return new ae(e)}static createDynamic(e){return new ae(e)}}ae.EMPTY=ae.register({description:"empty"});const he=[ae.register({description:"tracked-range-always-grows-when-typing-at-edges",stickiness:0}),ae.register({description:"tracked-range-never-grows-when-typing-at-edges",stickiness:1}),ae.register({description:"tracked-range-grows-only-when-typing-before",stickiness:2}),ae.register({description:"tracked-range-grows-only-when-typing-after",stickiness:3})];function le(e){return e instanceof ae?e:ae.createDynamic(e)}class de extends a.jG{constructor(e){super(),this.handleBeforeFire=e,this._actual=this._register(new r.vl),this.event=this._actual.event,this._affectedInjectedTextLines=null,this._deferredCnt=0,this._shouldFire=!1,this._affectsMinimap=!1,this._affectsOverviewRuler=!1}beginDeferredEmit(){this._deferredCnt++}endDeferredEmit(){var e;if(this._deferredCnt--,0===this._deferredCnt){if(this._shouldFire){this.handleBeforeFire(this._affectedInjectedTextLines);const e={affectsMinimap:this._affectsMinimap,affectsOverviewRuler:this._affectsOverviewRuler};this._shouldFire=!1,this._affectsMinimap=!1,this._affectsOverviewRuler=!1,this._actual.fire(e)}null===(e=this._affectedInjectedTextLines)||void 0===e||e.clear(),this._affectedInjectedTextLines=null}}recordLineAffectedByInjectedText(e){this._affectedInjectedTextLines||(this._affectedInjectedTextLines=new Set),this._affectedInjectedTextLines.add(e)}checkAffectedAndFire(e){this._affectsMinimap||(this._affectsMinimap=!(!e.minimap||!e.minimap.position)),this._affectsOverviewRuler||(this._affectsOverviewRuler=!(!e.overviewRuler||!e.overviewRuler.color)),this._shouldFire=!0}fire(){this._affectsMinimap=!0,this._affectsOverviewRuler=!0,this._shouldFire=!0}}class ce extends a.jG{constructor(){super(),this._fastEmitter=this._register(new r.vl),this.fastEvent=this._fastEmitter.event,this._slowEmitter=this._register(new r.vl),this.slowEvent=this._slowEmitter.event,this._deferredCnt=0,this._deferredEvent=null}beginDeferredEmit(){this._deferredCnt++}endDeferredEmit(e=null){if(this._deferredCnt--,0===this._deferredCnt&&null!==this._deferredEvent){this._deferredEvent.rawContentChangedEvent.resultingSelection=e;const t=this._deferredEvent;this._deferredEvent=null,this._fastEmitter.fire(t),this._slowEmitter.fire(t)}}fire(e){this._deferredCnt>0?this._deferredEvent?this._deferredEvent=this._deferredEvent.merge(e):this._deferredEvent=e:(this._fastEmitter.fire(e),this._slowEmitter.fire(e))}}},32177:function(e,t,n){n.d(t,{_:function(){return s}});var i=n(10998);class s extends i.jG{constructor(){super(...arguments),this._isDisposed=!1}dispose(){super.dispose(),this._isDisposed=!0}assertNotDisposed(){if(this._isDisposed)throw new Error("TextModelPart is disposed!")}}},104:function(e,t,n){n.d(t,{W5:function(){return g},dr:function(){return l},hB:function(){return c},lt:function(){return h},wC:function(){return u}});var i=n(16844),s=n(82862),o=n(15365),r=n(28061),a=n(66055);class h{constructor(e,t,n,i){this.searchString=e,this.isRegex=t,this.matchCase=n,this.wordSeparators=i}parseSearchRequest(){if(""===this.searchString)return null;let e;e=this.isRegex?function(e){if(!e||0===e.length)return!1;for(let t=0,n=e.length;t<n;t++){const i=e.charCodeAt(t);if(10===i)return!0;if(92===i){if(t++,t>=n)break;const i=e.charCodeAt(t);if(110===i||114===i||87===i)return!0}}return!1}(this.searchString):this.searchString.indexOf("\n")>=0;let t=null;try{t=i.OS(this.searchString,this.isRegex,{matchCase:this.matchCase,wholeWord:!1,multiline:e,global:!0,unicode:!0})}catch(e){return null}if(!t)return null;let n=!this.isRegex&&!e;return n&&this.searchString.toLowerCase()!==this.searchString.toUpperCase()&&(n=this.matchCase),new a.L5(t,this.wordSeparators?(0,s.i)(this.wordSeparators):null,n?this.searchString:null)}}function l(e,t,n){if(!n)return new a.Dg(e,null);const i=[];for(let e=0,n=t.length;e<n;e++)i[e]=t[e];return new a.Dg(e,i)}class d{constructor(e){const t=[];let n=0;for(let i=0,s=e.length;i<s;i++)10===e.charCodeAt(i)&&(t[n++]=i);this._lineFeedsOffsets=t}findLineFeedCountBeforeOffset(e){const t=this._lineFeedsOffsets;let n=0,i=t.length-1;if(-1===i)return 0;if(e<=t[0])return 0;for(;n<i;){const s=n+((i-n)/2|0);t[s]>=e?i=s-1:t[s+1]>=e?(n=s,i=s):n=s+1}return n+1}}class c{static findMatches(e,t,n,i,s){const o=t.parseSearchRequest();return o?o.regex.multiline?this._doFindMatchesMultiline(e,n,new g(o.wordSeparators,o.regex),i,s):this._doFindMatchesLineByLine(e,n,o,i,s):[]}static _getMultilineMatchRange(e,t,n,i,s,o){let a,h,l=0;if(i?(l=i.findLineFeedCountBeforeOffset(s),a=t+s+l):a=t+s,i){const e=i.findLineFeedCountBeforeOffset(s+o.length)-l;h=a+o.length+e}else h=a+o.length;const d=e.getPositionAt(a),c=e.getPositionAt(h);return new r.Q(d.lineNumber,d.column,c.lineNumber,c.column)}static _doFindMatchesMultiline(e,t,n,i,s){const o=e.getOffsetAt(t.getStartPosition()),r=e.getValueInRange(t,1),a="\r\n"===e.getEOL()?new d(r):null,h=[];let c,u=0;for(n.reset(0);c=n.next(r);)if(h[u++]=l(this._getMultilineMatchRange(e,o,r,a,c.index,c[0]),c,i),u>=s)return h;return h}static _doFindMatchesLineByLine(e,t,n,i,s){const o=[];let r=0;if(t.startLineNumber===t.endLineNumber){const a=e.getLineContent(t.startLineNumber).substring(t.startColumn-1,t.endColumn-1);return r=this._findMatchesInLine(n,a,t.startLineNumber,t.startColumn-1,r,o,i,s),o}const a=e.getLineContent(t.startLineNumber).substring(t.startColumn-1);r=this._findMatchesInLine(n,a,t.startLineNumber,t.startColumn-1,r,o,i,s);for(let a=t.startLineNumber+1;a<t.endLineNumber&&r<s;a++)r=this._findMatchesInLine(n,e.getLineContent(a),a,0,r,o,i,s);if(r<s){const a=e.getLineContent(t.endLineNumber).substring(0,t.endColumn-1);r=this._findMatchesInLine(n,a,t.endLineNumber,0,r,o,i,s)}return o}static _findMatchesInLine(e,t,n,i,s,o,h,d){const c=e.wordSeparators;if(!h&&e.simpleSearch){const h=e.simpleSearch,l=h.length,g=t.length;let _=-l;for(;-1!==(_=t.indexOf(h,_+l));)if((!c||u(c,t,g,_,l))&&(o[s++]=new a.Dg(new r.Q(n,_+1+i,n,_+1+l+i),null),s>=d))return s;return s}const _=new g(e.wordSeparators,e.regex);let f;_.reset(0);do{if(f=_.next(t),f&&(o[s++]=l(new r.Q(n,f.index+1+i,n,f.index+1+f[0].length+i),f,h),s>=d))return s}while(f);return s}static findNextMatch(e,t,n,i){const s=t.parseSearchRequest();if(!s)return null;const o=new g(s.wordSeparators,s.regex);return s.regex.multiline?this._doFindNextMatchMultiline(e,n,o,i):this._doFindNextMatchLineByLine(e,n,o,i)}static _doFindNextMatchMultiline(e,t,n,i){const s=new o.y(t.lineNumber,1),a=e.getOffsetAt(s),h=e.getLineCount(),c=e.getValueInRange(new r.Q(s.lineNumber,s.column,h,e.getLineMaxColumn(h)),1),u="\r\n"===e.getEOL()?new d(c):null;n.reset(t.column-1);const g=n.next(c);return g?l(this._getMultilineMatchRange(e,a,c,u,g.index,g[0]),g,i):1!==t.lineNumber||1!==t.column?this._doFindNextMatchMultiline(e,new o.y(1,1),n,i):null}static _doFindNextMatchLineByLine(e,t,n,i){const s=e.getLineCount(),o=t.lineNumber,r=e.getLineContent(o),a=this._findFirstMatchInLine(n,r,o,t.column,i);if(a)return a;for(let t=1;t<=s;t++){const r=(o+t-1)%s,a=e.getLineContent(r+1),h=this._findFirstMatchInLine(n,a,r+1,1,i);if(h)return h}return null}static _findFirstMatchInLine(e,t,n,i,s){e.reset(i-1);const o=e.next(t);return o?l(new r.Q(n,o.index+1,n,o.index+1+o[0].length),o,s):null}static findPreviousMatch(e,t,n,i){const s=t.parseSearchRequest();if(!s)return null;const o=new g(s.wordSeparators,s.regex);return s.regex.multiline?this._doFindPreviousMatchMultiline(e,n,o,i):this._doFindPreviousMatchLineByLine(e,n,o,i)}static _doFindPreviousMatchMultiline(e,t,n,i){const s=this._doFindMatchesMultiline(e,new r.Q(1,1,t.lineNumber,t.column),n,i,9990);if(s.length>0)return s[s.length-1];const a=e.getLineCount();return t.lineNumber!==a||t.column!==e.getLineMaxColumn(a)?this._doFindPreviousMatchMultiline(e,new o.y(a,e.getLineMaxColumn(a)),n,i):null}static _doFindPreviousMatchLineByLine(e,t,n,i){const s=e.getLineCount(),o=t.lineNumber,r=e.getLineContent(o).substring(0,t.column-1),a=this._findLastMatchInLine(n,r,o,i);if(a)return a;for(let t=1;t<=s;t++){const r=(s+o-t-1)%s,a=e.getLineContent(r+1),h=this._findLastMatchInLine(n,a,r+1,i);if(h)return h}return null}static _findLastMatchInLine(e,t,n,i){let s,o=null;for(e.reset(0);s=e.next(t);)o=l(new r.Q(n,s.index+1,n,s.index+1+s[0].length),s,i);return o}}function u(e,t,n,i,s){return function(e,t,n,i,s){if(0===i)return!0;const o=t.charCodeAt(i-1);if(0!==e.get(o))return!0;if(13===o||10===o)return!0;if(s>0){const n=t.charCodeAt(i);if(0!==e.get(n))return!0}return!1}(e,t,0,i,s)&&function(e,t,n,i,s){if(i+s===n)return!0;const o=t.charCodeAt(i+s);if(0!==e.get(o))return!0;if(13===o||10===o)return!0;if(s>0){const n=t.charCodeAt(i+s-1);if(0!==e.get(n))return!0}return!1}(e,t,n,i,s)}class g{constructor(e,t){this._wordSeparators=e,this._searchRegex=t,this._prevMatchStartIndex=-1,this._prevMatchLength=0}reset(e){this._searchRegex.lastIndex=e,this._prevMatchStartIndex=-1,this._prevMatchLength=0}next(e){const t=e.length;let n;do{if(this._prevMatchStartIndex+this._prevMatchLength===t)return null;if(n=this._searchRegex.exec(e),!n)return null;const s=n.index,o=n[0].length;if(s===this._prevMatchStartIndex&&o===this._prevMatchLength){if(0===o){i.Z5(e,t,this._searchRegex.lastIndex)>65535?this._searchRegex.lastIndex+=2:this._searchRegex.lastIndex+=1;continue}return null}if(this._prevMatchStartIndex=s,this._prevMatchLength=o,!this._wordSeparators||u(this._wordSeparators,e,t,s,o))return n}while(n);return null}}},50969:function(e,t,n){function i(e,t){let n=0,i=0;const s=e.length;for(;i<s;){const s=e.charCodeAt(i);if(32===s)n++;else{if(9!==s)break;n=n-n%t+t}i++}return i===s?-1:n}n.d(t,{G:function(){return i}})}}]);
