!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="e0070a66-8ea0-40be-8b9e-12e1a5746d40",e._sentryDebugIdIdentifier="sentry-dbid-e0070a66-8ea0-40be-8b9e-12e1a5746d40")}catch(e){}}();var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"13ad4a0c312011ebb49f3e8dc8f97be809f60d04"},(self.webpackChunkschema_diagram_vue=self.webpackChunkschema_diagram_vue||[]).push([[225],{53264:function(e,t,i){i.r(t),i.d(t,{commitInlineSuggestionAction:function(){return tt}});var n=i(50946),o=i(38122),s=i(46311);const r="editor.action.inlineSuggest.commit";var a=i(2106),l=i(10998),d=i(16844),c=i(62549),h=i(15365),u=i(47317),g=i(65958),p=i(78903),m=i(94327),v=i(90612),f=i(23877),C=i(28061);class x{constructor(e){this.lineStartOffsetByLineIdx=[],this.lineStartOffsetByLineIdx.push(0);for(let t=0;t<e.length;t++)"\n"===e.charAt(t)&&this.lineStartOffsetByLineIdx.push(t+1)}getOffset(e){return this.lineStartOffsetByLineIdx[e.lineNumber-1]+e.column-1}}const w=[];class S{constructor(e,t,i=0){this.lineNumber=e,this.parts=t,this.additionalReservedLineCount=i}renderForScreenReader(e){if(0===this.parts.length)return"";const t=this.parts[this.parts.length-1];return function(e,t){const i=new x(e),n=t.map((e=>{const t=C.Q.lift(e.range);return{startOffset:i.getOffset(t.getStartPosition()),endOffset:i.getOffset(t.getEndPosition()),text:e.text}}));n.sort(((e,t)=>t.startOffset-e.startOffset));for(const t of n)e=e.substring(0,t.startOffset)+t.text+e.substring(t.endOffset);return e}(e.substr(0,t.column-1),this.parts.map((e=>({range:{startLineNumber:1,endLineNumber:1,startColumn:e.column,endColumn:e.column},text:e.lines.join("\n")})))).substring(this.parts[0].column-1)}isEmpty(){return this.parts.every((e=>0===e.lines.length))}}class y{constructor(e,t,i){this.column=e,this.lines=t,this.preview=i}}class I{constructor(e,t,i,n,o=0){this.lineNumber=e,this.columnStart=t,this.length=i,this.newLines=n,this.additionalReservedLineCount=o,this.parts=[new y(this.columnStart+this.length,this.newLines,!1)]}renderForScreenReader(e){return this.newLines.join("\n")}}class b extends l.jG{constructor(e){super(),this.editor=e,this._expanded=void 0,this.onDidChangeEmitter=new a.vl,this.onDidChange=this.onDidChangeEmitter.event,this._register(e.onDidChangeConfiguration((e=>{e.hasChanged(108)&&void 0===this._expanded&&this.onDidChangeEmitter.fire()})))}setExpanded(e){this._expanded=!0,this.onDidChangeEmitter.fire()}}var _=i(59715),M=i(2111);function D(e,t){if(!t)return t;const i=e.getValueInRange(t.range),n=d.Qp(i,t.insertText),o=e.getOffsetAt(t.range.getStartPosition())+n,s=e.getPositionAt(o),r=i.substr(n),a=d.Vi(r,t.insertText),l=e.getPositionAt(Math.max(o,e.getOffsetAt(t.range.getEndPosition())-a));return{range:C.Q.fromPositions(s,l),insertText:t.insertText.substr(n,t.insertText.length-n-a),snippetInfo:t.snippetInfo,filterText:t.filterText,additionalTextEdits:t.additionalTextEdits}}function T(e,t,i,n,o=0){if(e.range.startLineNumber!==e.range.endLineNumber)return;const s=t.getLineContent(e.range.startLineNumber),r=d.UU(s).length;if(e.range.startColumn-1<=r){const t=d.UU(e.insertText).length,i=s.substring(e.range.startColumn-1,r),n=C.Q.fromPositions(e.range.getStartPosition().delta(0,i.length),e.range.getEndPosition()),o=e.insertText.startsWith(i)?e.insertText.substring(i.length):e.insertText.substring(t);e={range:n,insertText:o,command:e.command,snippetInfo:void 0,filterText:e.filterText,additionalTextEdits:e.additionalTextEdits}}const a=t.getValueInRange(e.range),l=function(e,t){if((null==R?void 0:R.originalValue)===e&&(null==R?void 0:R.newValue)===t)return null==R?void 0:R.changes;{let i=P(e,t,!0);if(i){const n=E(i);if(n>0){const o=P(e,t,!1);o&&E(o)<n&&(i=o)}}return R={originalValue:e,newValue:t,changes:i},i}}(a,e.insertText);if(!l)return;const c=e.range.startLineNumber,h=new Array;if("prefix"===i){const e=l.filter((e=>0===e.originalLength));if(e.length>1||1===e.length&&e[0].originalStart!==a.length)return}const u=e.insertText.length-o;for(const t of l){const o=e.range.startColumn+t.originalStart+t.originalLength;if("subwordSmart"===i&&n&&n.lineNumber===e.range.startLineNumber&&o<n.column)return;if(t.originalLength>0)return;if(0===t.modifiedLength)continue;const s=t.modifiedStart+t.modifiedLength,r=Math.max(t.modifiedStart,Math.min(s,u)),a=e.insertText.substring(t.modifiedStart,r),l=e.insertText.substring(r,Math.max(t.modifiedStart,s));if(a.length>0){const e=d.uz(a);h.push(new y(o,e,!1))}if(l.length>0){const e=d.uz(l);h.push(new y(o,e,!0))}}return new S(c,h,0)}let R;function E(e){let t=0;for(const i of e)t+=Math.max(i.originalLength-i.modifiedLength,0);return t}function P(e,t,i){if(e.length>5e3||t.length>5e3)return;function n(e){let t=0;for(let i=0,n=e.length;i<n;i++){const n=e.charCodeAt(i);n>t&&(t=n)}return t}const o=Math.max(n(e),n(t));function s(e){if(e<0)throw new Error("unexpected");return o+e+1}function r(e){let t=0,n=0;const o=new Int32Array(e.length);for(let r=0,a=e.length;r<a;r++)if(i&&"("===e[r]){const e=100*n+t;o[r]=s(2*e),t++}else if(i&&")"===e[r]){t=Math.max(t-1,0);const e=100*n+t;o[r]=s(2*e+1),0===t&&n++}else o[r]=e.charCodeAt(r);return o}const a=r(e),l=r(t);return new M.uP({getElements:()=>a},{getElements:()=>l}).ComputeDiff(!1).changes}var L=i(52394),A=i(81607),O=i(52230),N=i(12060),k=i(47039),H=i(50960),F=i(79359),W=i(97669),K=i(85753),V=function(e,t,i,n){var o,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,i,r):o(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},j=function(e,t){return function(i,n){t(i,n,e)}},z=function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function r(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,a)}l((n=n.apply(e,t||[])).next())}))};let G=class extends l.jG{constructor(e,t,i,n,o,s,d){super(),this.editor=e,this.cache=t,this.commandService=i,this.languageConfigurationService=n,this.languageFeaturesService=o,this.debounceService=s,this.onDidChangeEmitter=new a.vl,this.onDidChange=this.onDidChangeEmitter.event,this.completionSession=this._register(new l.HE),this.active=!1,this.disposed=!1,this.debounceValue=this.debounceService.for(this.languageFeaturesService.inlineCompletionsProvider,"InlineCompletionsDebounce",{min:50,max:50}),this._register(i.onDidExecuteCommand((t=>{new Set([v.CoreEditingCommands.Tab.id,v.CoreEditingCommands.DeleteLeft.id,v.CoreEditingCommands.DeleteRight.id,r,"acceptSelectedSuggestion"]).has(t.commandId)&&e.hasTextFocus()&&this.handleUserInput()}))),this._register(this.editor.onDidType((e=>{this.handleUserInput()}))),this._register(this.editor.onDidChangeCursorPosition((e=>{(3===e.reason||this.session&&!this.session.isValid)&&this.hide()}))),this._register((0,l.s)((()=>{this.disposed=!0}))),this._register(this.editor.onDidBlurEditorWidget((()=>{d.getValue("editor.inlineSuggest.hideOnBlur")||this.hide()})))}handleUserInput(){this.session&&!this.session.isValid&&this.hide(),setTimeout((()=>{this.disposed||this.startSessionIfTriggered()}),0)}get session(){return this.completionSession.value}get ghostText(){var e;return null===(e=this.session)||void 0===e?void 0:e.ghostText}get minReservedLineCount(){return this.session?this.session.minReservedLineCount:0}setExpanded(e){var t;null===(t=this.session)||void 0===t||t.setExpanded(e)}setActive(e){var t;this.active=e,e&&(null===(t=this.session)||void 0===t||t.scheduleAutomaticUpdate())}startSessionIfTriggered(){this.editor.getOption(57).enabled&&(this.session&&this.session.isValid||this.trigger(u.qw.Automatic))}trigger(e){this.completionSession.value?e===u.qw.Explicit&&this.completionSession.value.ensureUpdateWithExplicitContext():(this.completionSession.value=new B(this.editor,this.editor.getPosition(),(()=>this.active),this.commandService,this.cache,e,this.languageConfigurationService,this.languageFeaturesService.inlineCompletionsProvider,this.debounceValue),this.completionSession.value.takeOwnership(this.completionSession.value.onDidChange((()=>{this.onDidChangeEmitter.fire()}))))}hide(){this.completionSession.clear(),this.onDidChangeEmitter.fire()}commitCurrentSuggestion(){var e;null===(e=this.session)||void 0===e||e.commitCurrentCompletion()}showNext(){var e;null===(e=this.session)||void 0===e||e.showNextInlineCompletion()}showPrevious(){var e;null===(e=this.session)||void 0===e||e.showPreviousInlineCompletion()}hasMultipleInlineCompletions(){var e;return z(this,void 0,void 0,(function*(){const t=yield null===(e=this.session)||void 0===e?void 0:e.hasMultipleInlineCompletions();return void 0!==t&&t}))}};G=V([j(2,_.wT),j(3,L.JZ),j(4,O.u),j(5,N.U),j(6,K.pG)],G);class B extends b{constructor(e,t,i,n,o,s,r,a,d){let c;super(e),this.triggerPosition=t,this.shouldUpdate=i,this.commandService=n,this.cache=o,this.initialTriggerKind=s,this.languageConfigurationService=r,this.registry=a,this.debounce=d,this.minReservedLineCount=0,this.updateOperation=this._register(new l.HE),this.updateSoon=this._register(new g.uC((()=>{const e=this.initialTriggerKind;return this.initialTriggerKind=u.qw.Automatic,this.update(e)}),50)),this.filteredCompletions=[],this.currentlySelectedCompletionId=void 0,this._register(this.onDidChange((()=>{var e;const t=this.currentCompletion;if(t&&t.sourceInlineCompletion!==c){c=t.sourceInlineCompletion;const i=t.sourceProvider;null===(e=i.handleItemDidShow)||void 0===e||e.call(i,t.sourceInlineCompletions,c)}}))),this._register((0,l.s)((()=>{this.cache.clear()}))),this._register(this.editor.onDidChangeCursorPosition((e=>{var t;3!==e.reason&&(null===(t=this.cache.value)||void 0===t||t.updateRanges(),this.cache.value&&(this.updateFilteredInlineCompletions(),this.onDidChangeEmitter.fire()))}))),this._register(this.editor.onDidChangeModelContent((e=>{var t;null===(t=this.cache.value)||void 0===t||t.updateRanges(),this.updateFilteredInlineCompletions(),this.scheduleAutomaticUpdate()}))),this._register(this.registry.onDidChange((()=>{this.updateSoon.schedule(this.debounce.get(this.editor.getModel()))}))),this.scheduleAutomaticUpdate()}updateFilteredInlineCompletions(){if(!this.cache.value)return void(this.filteredCompletions=[]);const e=this.editor.getModel(),t=e.validatePosition(this.editor.getPosition());this.filteredCompletions=this.cache.value.completions.filter((i=>{const n=e.getValueInRange(i.synchronizedRange).toLowerCase(),o=i.inlineCompletion.filterText.toLowerCase(),s=e.getLineIndentColumn(i.synchronizedRange.startLineNumber),r=Math.max(0,t.column-i.synchronizedRange.startColumn);let a=o.substring(0,r),l=o.substring(r),d=n.substring(0,r),c=n.substring(r);return i.synchronizedRange.startColumn<=s&&(d=d.trimStart(),0===d.length&&(c=c.trimStart()),a=a.trimStart(),0===a.length&&(l=l.trimStart())),a.startsWith(d)&&(0,W.dE)(c,l)}))}fixAndGetIndexOfCurrentSelection(){if(!this.currentlySelectedCompletionId||!this.cache.value)return 0;if(0===this.cache.value.completions.length)return 0;const e=this.filteredCompletions.findIndex((e=>e.semanticId===this.currentlySelectedCompletionId));return-1===e?(this.currentlySelectedCompletionId=void 0,0):e}get currentCachedCompletion(){if(this.cache.value)return this.filteredCompletions[this.fixAndGetIndexOfCurrentSelection()]}showNextInlineCompletion(){return z(this,void 0,void 0,(function*(){yield this.ensureUpdateWithExplicitContext();const e=this.filteredCompletions||[];if(e.length>0){const t=(this.fixAndGetIndexOfCurrentSelection()+1)%e.length;this.currentlySelectedCompletionId=e[t].semanticId}else this.currentlySelectedCompletionId=void 0;this.onDidChangeEmitter.fire()}))}showPreviousInlineCompletion(){return z(this,void 0,void 0,(function*(){yield this.ensureUpdateWithExplicitContext();const e=this.filteredCompletions||[];if(e.length>0){const t=(this.fixAndGetIndexOfCurrentSelection()+e.length-1)%e.length;this.currentlySelectedCompletionId=e[t].semanticId}else this.currentlySelectedCompletionId=void 0;this.onDidChangeEmitter.fire()}))}ensureUpdateWithExplicitContext(){var e;return z(this,void 0,void 0,(function*(){this.updateOperation.value?this.updateOperation.value.triggerKind===u.qw.Explicit?yield this.updateOperation.value.promise:yield this.update(u.qw.Explicit):(null===(e=this.cache.value)||void 0===e?void 0:e.triggerKind)!==u.qw.Explicit&&(yield this.update(u.qw.Explicit))}))}hasMultipleInlineCompletions(){var e;return z(this,void 0,void 0,(function*(){return yield this.ensureUpdateWithExplicitContext(),((null===(e=this.cache.value)||void 0===e?void 0:e.completions.length)||0)>1}))}get ghostText(){const e=this.currentCompletion;if(!e)return;const t=this.editor.getPosition();if(e.range.getEndPosition().isBefore(t))return;const i=this.editor.getOptions().get(57).mode,n=T(e,this.editor.getModel(),i,t);if(n){if(n.isEmpty())return;return n}return new I(e.range.startLineNumber,e.range.startColumn,e.range.endColumn-e.range.startColumn,e.insertText.split("\n"),0)}get currentCompletion(){const e=this.currentCachedCompletion;if(e)return e.toLiveInlineCompletion()}get isValid(){return this.editor.getPosition().lineNumber===this.triggerPosition.lineNumber}scheduleAutomaticUpdate(){this.updateOperation.clear(),this.updateSoon.schedule(this.debounce.get(this.editor.getModel()))}update(e){return z(this,void 0,void 0,(function*(){if(!this.shouldUpdate())return;const t=this.editor.getPosition(),i=new Date,n=(0,g.SS)((n=>z(this,void 0,void 0,(function*(){let o;try{o=yield Z(this.registry,t,this.editor.getModel(),{triggerKind:e,selectedSuggestionInfo:void 0},n,this.languageConfigurationService);const s=new Date;this.debounce.update(this.editor.getModel(),s.getTime()-i.getTime())}catch(e){return void(0,m.dz)(e)}n.isCancellationRequested||(this.cache.setValue(this.editor,o,e),this.updateFilteredInlineCompletions(),this.onDidChangeEmitter.fire())})))),o=new U(n,e);this.updateOperation.value=o,yield n,this.updateOperation.value===o&&this.updateOperation.clear()}))}takeOwnership(e){this._register(e)}commitCurrentCompletion(){if(!this.ghostText)return;const e=this.currentCompletion;e&&this.commit(e)}commit(e){var t;const i=this.cache.clearAndLeak();e.snippetInfo?(this.editor.executeEdits("inlineSuggestion.accept",[f.k.replaceMove(e.range,""),...e.additionalTextEdits]),this.editor.setPosition(e.snippetInfo.range.getStartPosition()),null===(t=H.SnippetController2.get(this.editor))||void 0===t||t.insert(e.snippetInfo.snippet)):this.editor.executeEdits("inlineSuggestion.accept",[f.k.replaceMove(e.range,e.insertText),...e.additionalTextEdits]),e.command?this.commandService.executeCommand(e.command.id,...e.command.arguments||[]).finally((()=>{null==i||i.dispose()})).then(void 0,m.M_):null==i||i.dispose(),this.onDidChangeEmitter.fire()}get commands(){var e;return[...new Set((null===(e=this.cache.value)||void 0===e?void 0:e.completions.map((e=>e.inlineCompletion.sourceInlineCompletions)))||[])].flatMap((e=>e.commands||[]))}}class U{constructor(e,t){this.promise=e,this.triggerKind=t}dispose(){this.promise.cancel()}}class Q extends l.jG{constructor(e,t,i,n){super(),this.editor=t,this.onChange=i,this.triggerKind=n,this.isDisposing=!1;const o=t.changeDecorations((t=>t.deltaDecorations([],e.items.map((e=>({range:e.range,options:{description:"inline-completion-tracking-range"}}))))));this._register((0,l.s)((()=>{this.isDisposing=!0,t.removeDecorations(o)}))),this.completions=e.items.map(((e,t)=>new $(e,o[t]))),this._register(t.onDidChangeModelContent((()=>{this.updateRanges()}))),this._register(e)}updateRanges(){if(this.isDisposing)return;let e=!1;const t=this.editor.getModel();for(const i of this.completions){const n=t.getDecorationRange(i.decorationId);n?i.synchronizedRange.equalsRange(n)||(e=!0,i.synchronizedRange=n):(0,m.dz)(new Error("Decoration has no range"))}e&&this.onChange()}}class ${constructor(e,t){this.inlineCompletion=e,this.decorationId=t,this.semanticId=JSON.stringify({text:this.inlineCompletion.insertText,abbreviation:this.inlineCompletion.filterText,startLine:this.inlineCompletion.range.startLineNumber,startColumn:this.inlineCompletion.range.startColumn,command:this.inlineCompletion.command}),this.synchronizedRange=e.range}toLiveInlineCompletion(){return{insertText:this.inlineCompletion.insertText,range:this.synchronizedRange,command:this.inlineCompletion.command,sourceProvider:this.inlineCompletion.sourceProvider,sourceInlineCompletions:this.inlineCompletion.sourceInlineCompletions,sourceInlineCompletion:this.inlineCompletion.sourceInlineCompletion,snippetInfo:this.inlineCompletion.snippetInfo,filterText:this.inlineCompletion.filterText,additionalTextEdits:this.inlineCompletion.additionalTextEdits}}}function Z(e,t,i,n,o=p.X.None,s){return z(this,void 0,void 0,(function*(){const r=function(e,t){const i=t.getWordAtPosition(e),n=t.getLineMaxColumn(e.lineNumber);return i?new C.Q(e.lineNumber,i.startColumn,e.lineNumber,n):C.Q.fromPositions(e,e.with(void 0,n))}(t,i),a=e.all(i),l=yield Promise.all(a.map((e=>z(this,void 0,void 0,(function*(){const s=yield Promise.resolve(e.provideInlineCompletions(i,t,n,o)).catch(m.M_);return{completions:s,provider:e,dispose:()=>{s&&e.freeInlineCompletions(s)}}}))))),d=new Map;for(const e of l){const t=e.completions;if(t)for(const n of t.items){let o,a,l=n.range?C.Q.lift(n.range):r;if(l.startLineNumber!==l.endLineNumber)continue;if("string"==typeof n.insertText){if(o=n.insertText,s&&n.completeBracketPairs){o=q(o,l.getStartPosition(),i,s);const e=o.length-n.insertText.length;0!==e&&(l=new C.Q(l.startLineNumber,l.startColumn,l.endLineNumber,l.endColumn+e))}a=void 0}else if("snippet"in n.insertText){o=(new k.fr).parse(n.insertText.snippet).toString(),a={snippet:n.insertText.snippet,range:l}}else(0,F.xb)(n.insertText);const c={insertText:o,snippetInfo:a,range:l,command:n.command,sourceProvider:e.provider,sourceInlineCompletions:t,sourceInlineCompletion:n,filterText:n.filterText||o,additionalTextEdits:n.additionalTextEdits||w};d.set(JSON.stringify({insertText:o,range:n.range}),c)}}return{items:[...d.values()],dispose:()=>{for(const e of l)e.dispose()}}}))}function q(e,t,i,n){const o=i.getLineContent(t.lineNumber).substring(0,t.column-1)+e,s=i.tokenization.tokenizeLineWithEdit(t,o.length-(t.column-1),e),r=null==s?void 0:s.sliceAndInflate(t.column-1,o.length,0);if(!r)return e;return(0,A.I)(r,n)}var Y=i(13338),X=i(83030),J=i(36354);class ee extends l.jG{constructor(e,t){super(),this.editor=e,this.suggestControllerPreselector=t,this.isSuggestWidgetVisible=!1,this.isShiftKeyPressed=!1,this._isActive=!1,this._currentSuggestItemInfo=void 0,this.onDidChangeEmitter=new a.vl,this.onDidChange=this.onDidChangeEmitter.event,this.setInactiveDelayed=this._register(new g.uC((()=>{this.isSuggestWidgetVisible||this._isActive&&(this._isActive=!1,this.onDidChangeEmitter.fire())}),100)),this._register(e.onKeyDown((e=>{e.shiftKey&&!this.isShiftKeyPressed&&(this.isShiftKeyPressed=!0,this.update(this._isActive))}))),this._register(e.onKeyUp((e=>{e.shiftKey&&this.isShiftKeyPressed&&(this.isShiftKeyPressed=!1,this.update(this._isActive))})));const i=J.SuggestController.get(this.editor);if(i){this._register(i.registerSelector({priority:100,select:(e,t,n)=>{const o=this.editor.getModel(),s=D(o,this.suggestControllerPreselector());if(!s)return-1;const r=h.y.lift(t),a=n.map(((e,t)=>{const n=te(i,r,e,this.isShiftKeyPressed),a=D(o,null==n?void 0:n.normalizedInlineCompletion);if(!a)return;var l,d;return{index:t,valid:(l=s.range,(d=a.range).startLineNumber===l.startLineNumber&&d.startColumn===l.startColumn&&(d.endLineNumber<l.endLineNumber||d.endLineNumber===l.endLineNumber&&d.endColumn<=l.endColumn)&&s.insertText.startsWith(a.insertText)),prefixLength:a.insertText.length,suggestItem:e}})).filter((e=>e&&e.valid)),l=(0,Y.vj)(a,(0,Y.VE)((e=>e.prefixLength),Y.U9));return l?l.index:-1}}));let e=!1;const t=()=>{e||(e=!0,this._register(i.widget.value.onDidShow((()=>{this.isSuggestWidgetVisible=!0,this.update(!0)}))),this._register(i.widget.value.onDidHide((()=>{this.isSuggestWidgetVisible=!1,this.setInactiveDelayed.schedule(),this.update(this._isActive)}))),this._register(i.widget.value.onDidFocus((()=>{this.isSuggestWidgetVisible=!0,this.update(!0)}))))};this._register(a.Jh.once(i.model.onDidTrigger)((e=>{t()})))}this.update(this._isActive)}get state(){if(this._isActive)return{selectedItem:this._currentSuggestItemInfo}}update(e){const t=this.getSuggestItemInfo();let i=!1;(function(e,t){if(e===t)return!0;if(!e||!t)return!1;return e.completionItemKind===t.completionItemKind&&e.isSnippetText===t.isSnippetText&&function(e,t){return e===t||!(!e||!t)&&e.range.equalsRange(t.range)&&e.insertText===t.insertText&&e.command===t.command}(e.normalizedInlineCompletion,t.normalizedInlineCompletion)})(this._currentSuggestItemInfo,t)||(this._currentSuggestItemInfo=t,i=!0),this._isActive!==e&&(this._isActive=e,i=!0),i&&this.onDidChangeEmitter.fire()}getSuggestItemInfo(){const e=J.SuggestController.get(this.editor);if(!e)return;if(!this.isSuggestWidgetVisible)return;const t=e.widget.value.getFocusedItem();return t?te(e,this.editor.getPosition(),t.item,this.isShiftKeyPressed):void 0}stopForceRenderingAbove(){const e=J.SuggestController.get(this.editor);e&&e.stopForceRenderingAbove()}forceRenderingAbove(){const e=J.SuggestController.get(this.editor);e&&e.forceRenderingAbove()}}function te(e,t,i,n){if(Array.isArray(i.completion.additionalTextEdits)&&i.completion.additionalTextEdits.length>0)return{completionItemKind:i.completion.kind,isSnippetText:!1,normalizedInlineCompletion:{range:C.Q.fromPositions(t,t),insertText:"",filterText:"",snippetInfo:void 0,additionalTextEdits:[]}};let{insertText:o}=i.completion,s=!1;if(4&i.completion.insertTextRules){const i=(new k.fr).parse(o),n=e.editor.getModel();if(i.children.length>100)return;X.O.adjustWhitespace(n,t,i,!0,!0),o=i.toString(),s=!0}const r=e.getOverwriteInfo(i,n);return{isSnippetText:s,completionItemKind:i.completion.kind,normalizedInlineCompletion:{insertText:o,filterText:o,range:C.Q.fromPositions(t.delta(0,-r.overwriteBefore),t.delta(0,Math.max(r.overwriteAfter,0))),snippetInfo:void 0,additionalTextEdits:[]}}}var ie=function(e,t,i,n){var o,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,i,r):o(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},ne=function(e,t){return function(i,n){t(i,n,e)}},oe=function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function r(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,a)}l((n=n.apply(e,t||[])).next())}))};let se=class extends b{constructor(e,t,i){super(e),this.cache=t,this.languageFeaturesService=i,this.suggestionInlineCompletionSource=this._register(new ee(this.editor,(()=>{var e,t;return null===(t=null===(e=this.cache.value)||void 0===e?void 0:e.completions[0])||void 0===t?void 0:t.toLiveInlineCompletion()}))),this.updateOperation=this._register(new l.HE),this.updateCacheSoon=this._register(new g.uC((()=>this.updateCache()),50)),this.minReservedLineCount=0,this._register(this.suggestionInlineCompletionSource.onDidChange((()=>{if(!this.editor.hasModel())return;this.updateCacheSoon.schedule();this.suggestionInlineCompletionSource.state||(this.minReservedLineCount=0);const e=this.ghostText;e&&(this.minReservedLineCount=Math.max(this.minReservedLineCount,e.parts.map((e=>e.lines.length-1)).reduce(((e,t)=>e+t),0))),this.minReservedLineCount>=1?this.suggestionInlineCompletionSource.forceRenderingAbove():this.suggestionInlineCompletionSource.stopForceRenderingAbove(),this.onDidChangeEmitter.fire()}))),this._register(this.cache.onDidChange((()=>{this.onDidChangeEmitter.fire()}))),this._register(this.editor.onDidChangeCursorPosition((e=>{this.minReservedLineCount=0,this.updateCacheSoon.schedule(),this.onDidChangeEmitter.fire()}))),this._register((0,l.s)((()=>this.suggestionInlineCompletionSource.stopForceRenderingAbove())))}get isActive(){return void 0!==this.suggestionInlineCompletionSource.state}isSuggestionPreviewEnabled(){return this.editor.getOption(108).preview}updateCache(){return oe(this,void 0,void 0,(function*(){const e=this.suggestionInlineCompletionSource.state;if(!e||!e.selectedItem)return;const t={text:e.selectedItem.normalizedInlineCompletion.insertText,range:e.selectedItem.normalizedInlineCompletion.range,isSnippetText:e.selectedItem.isSnippetText,completionKind:e.selectedItem.completionItemKind},i=this.editor.getPosition();if(e.selectedItem.isSnippetText||27===e.selectedItem.completionItemKind||20===e.selectedItem.completionItemKind||23===e.selectedItem.completionItemKind)return void this.cache.clear();const n=(0,g.SS)((e=>oe(this,void 0,void 0,(function*(){let n;try{n=yield Z(this.languageFeaturesService.inlineCompletionsProvider,i,this.editor.getModel(),{triggerKind:u.qw.Automatic,selectedSuggestionInfo:t},e)}catch(e){return void(0,m.dz)(e)}e.isCancellationRequested?n.dispose():(this.cache.setValue(this.editor,n,u.qw.Automatic),this.onDidChangeEmitter.fire())})))),o=new U(n,u.qw.Automatic);this.updateOperation.value=o,yield n,this.updateOperation.value===o&&this.updateOperation.clear()}))}get ghostText(){var e,t,i;const n=this.isSuggestionPreviewEnabled(),o=this.editor.getModel(),s=D(o,null===(t=null===(e=this.cache.value)||void 0===e?void 0:e.completions[0])||void 0===t?void 0:t.toLiveInlineCompletion()),r=this.suggestionInlineCompletionSource.state,a=D(o,null===(i=null==r?void 0:r.selectedItem)||void 0===i?void 0:i.normalizedInlineCompletion),l=s&&a&&s.insertText.startsWith(a.insertText)&&s.range.equalsRange(a.range);if(!n&&!l)return;const d=l?s:a||s,c=l?d.insertText.length-a.insertText.length:0;return this.toGhostText(d,c)}toGhostText(e,t){const i=this.editor.getOptions().get(108).previewMode;return e?T(e,this.editor.getModel(),i,this.editor.getPosition(),t)||new S(e.range.endLineNumber,[],this.minReservedLineCount):void 0}};se=ie([ne(2,O.u)],se);var re=i(82399),ae=function(e,t,i,n){var o,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,i,r):o(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},le=function(e,t){return function(i,n){t(i,n,e)}},de=function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function r(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,a)}l((n=n.apply(e,t||[])).next())}))};class ce extends l.jG{constructor(){super(...arguments),this.onDidChangeEmitter=new a.vl,this.onDidChange=this.onDidChangeEmitter.event,this.hasCachedGhostText=!1,this.currentModelRef=this._register(new l.HE)}get targetModel(){var e;return null===(e=this.currentModelRef.value)||void 0===e?void 0:e.object}setTargetModel(e){var t,i,n;(null===(t=this.currentModelRef.value)||void 0===t?void 0:t.object)!==e&&(this.currentModelRef.clear(),this.currentModelRef.value=e?(i=e,n=e.onDidChange((()=>{this.hasCachedGhostText=!1,this.onDidChangeEmitter.fire()})),{object:i,dispose:()=>null==n?void 0:n.dispose()}):void 0,this.hasCachedGhostText=!1,this.onDidChangeEmitter.fire())}get ghostText(){var e,t;return this.hasCachedGhostText||(this.cachedGhostText=null===(t=null===(e=this.currentModelRef.value)||void 0===e?void 0:e.object)||void 0===t?void 0:t.ghostText,this.hasCachedGhostText=!0),this.cachedGhostText}setExpanded(e){var t;null===(t=this.targetModel)||void 0===t||t.setExpanded(e)}get minReservedLineCount(){return this.targetModel?this.targetModel.minReservedLineCount:0}}let he=class extends ce{constructor(e,t){super(),this.editor=e,this.instantiationService=t,this.sharedCache=this._register(new ue),this.suggestWidgetAdapterModel=this._register(this.instantiationService.createInstance(se,this.editor,this.sharedCache)),this.inlineCompletionsModel=this._register(this.instantiationService.createInstance(G,this.editor,this.sharedCache)),this._register(this.suggestWidgetAdapterModel.onDidChange((()=>{this.updateModel()}))),this.updateModel()}get activeInlineCompletionsModel(){if(this.targetModel===this.inlineCompletionsModel)return this.inlineCompletionsModel}updateModel(){this.setTargetModel(this.suggestWidgetAdapterModel.isActive?this.suggestWidgetAdapterModel:this.inlineCompletionsModel),this.inlineCompletionsModel.setActive(this.targetModel===this.inlineCompletionsModel)}shouldShowHoverAt(e){var t;const i=null===(t=this.activeInlineCompletionsModel)||void 0===t?void 0:t.ghostText;return!!i&&i.parts.some((t=>e.containsPosition(new h.y(i.lineNumber,t.column))))}triggerInlineCompletion(){var e;null===(e=this.activeInlineCompletionsModel)||void 0===e||e.trigger(u.qw.Explicit)}commitInlineCompletion(){var e;null===(e=this.activeInlineCompletionsModel)||void 0===e||e.commitCurrentSuggestion()}hideInlineCompletion(){var e;null===(e=this.activeInlineCompletionsModel)||void 0===e||e.hide()}showNextInlineCompletion(){var e;null===(e=this.activeInlineCompletionsModel)||void 0===e||e.showNext()}showPreviousInlineCompletion(){var e;null===(e=this.activeInlineCompletionsModel)||void 0===e||e.showPrevious()}hasMultipleInlineCompletions(){var e;return de(this,void 0,void 0,(function*(){const t=yield null===(e=this.activeInlineCompletionsModel)||void 0===e?void 0:e.hasMultipleInlineCompletions();return void 0!==t&&t}))}};he=ae([le(1,re._Y)],he);class ue extends l.jG{constructor(){super(...arguments),this.onDidChangeEmitter=new a.vl,this.onDidChange=this.onDidChangeEmitter.event,this.cache=this._register(new l.HE)}get value(){return this.cache.value}setValue(e,t,i){this.cache.value=new Q(t,e,(()=>this.onDidChangeEmitter.fire()),i)}clearAndLeak(){return this.cache.clearAndLeak()}clear(){this.cache.clear()}}var ge,pe=i(14333),me=i(48218),ve=i(66476),fe=i(57445),Ce=i(54324),xe=i(66055),we=i(77922),Se=i(48295),ye=i(45561),Ie=i(39723),be=i(89044),_e=function(e,t,i,n){var o,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,i,r):o(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},Me=function(e,t){return function(i,n){t(i,n,e)}};const De=null===(ge=window.trustedTypes)||void 0===ge?void 0:ge.createPolicy("editorGhostText",{createHTML:e=>e});let Te=class extends l.jG{constructor(e,t,i,n){super(),this.editor=e,this.model=t,this.instantiationService=i,this.languageService=n,this.disposed=!1,this.partsWidget=this._register(this.instantiationService.createInstance(Ee,this.editor)),this.additionalLinesWidget=this._register(new Pe(this.editor,this.languageService.languageIdCodec)),this.viewMoreContentWidget=void 0,this.replacementDecoration=this._register(new Re(this.editor)),this._register(this.editor.onDidChangeConfiguration((e=>{(e.hasChanged(29)||e.hasChanged(107)||e.hasChanged(90)||e.hasChanged(85)||e.hasChanged(47)||e.hasChanged(46)||e.hasChanged(61))&&this.update()}))),this._register((0,l.s)((()=>{var e;this.disposed=!0,this.update(),null===(e=this.viewMoreContentWidget)||void 0===e||e.dispose(),this.viewMoreContentWidget=void 0}))),this._register(t.onDidChange((()=>{this.update()}))),this.update()}shouldShowHoverAtViewZone(e){return this.additionalLinesWidget.viewZoneId===e}update(){var e;const t=this.model.ghostText;if(!this.editor.hasModel()||!t||this.disposed)return this.partsWidget.clear(),this.additionalLinesWidget.clear(),void this.replacementDecoration.clear();const i=new Array,n=new Array;function o(e,t){if(n.length>0){const i=n[n.length-1];t&&i.decorations.push(new ye.d(i.content.length+1,i.content.length+1+e[0].length,t,0)),i.content+=e[0],e=e.slice(1)}for(const i of e)n.push({content:i,decorations:t?[new ye.d(1,i.length+1,t,0)]:[]})}t instanceof I?this.replacementDecoration.setDecorations([{range:new C.Q(t.lineNumber,t.columnStart,t.lineNumber,t.columnStart+t.length),options:{inlineClassName:"inline-completion-text-to-replace",description:"GhostTextReplacement"}}]):this.replacementDecoration.setDecorations([]);const s=this.editor.getModel().getLineContent(t.lineNumber);let r,a=0;for(const e of t.parts){let t=e.lines;void 0===r?(i.push({column:e.column,text:t[0],preview:e.preview}),t=t.slice(1)):o([s.substring(a,e.column-1)],void 0),t.length>0&&(o(t,"ghost-text"),void 0===r&&e.column<=s.length&&(r=e.column)),a=e.column-1}void 0!==r&&o([s.substring(a)],void 0),this.partsWidget.setParts(t.lineNumber,i,void 0!==r?{column:r,length:s.length+1-r}:void 0),this.additionalLinesWidget.updateLines(t.lineNumber,n,t.additionalReservedLineCount),null===(e=this.viewMoreContentWidget)||void 0===e||e.dispose(),this.viewMoreContentWidget=void 0}renderViewMoreLines(e,t,i){const n=this.editor.getOption(46),o=document.createElement("div");o.className="suggest-preview-additional-widget",(0,me.M)(o,n);const s=document.createElement("span");s.className="content-spacer",s.append(t),o.append(s);const r=document.createElement("span");r.className="content-newline suggest-preview-text",r.append("⏎  "),o.append(r);const a=new l.Cm,d=document.createElement("div");return d.className="button suggest-preview-text",d.append(`+${i} lines…`),a.add(pe.b2(d,"mousedown",(e=>{var t;null===(t=this.model)||void 0===t||t.setExpanded(!0),e.preventDefault(),this.editor.focus()}))),o.append(d),new Le(this.editor,e,o,a)}};Te=_e([Me(2,re._Y),Me(3,we.L)],Te);class Re{constructor(e){this.editor=e,this.decorationIds=[]}setDecorations(e){this.editor.changeDecorations((t=>{this.decorationIds=t.deltaDecorations(this.decorationIds,e)}))}clear(){this.setDecorations([])}dispose(){this.clear()}}class Ee{constructor(e){this.editor=e,this.decorationIds=[]}dispose(){this.clear()}clear(){this.editor.changeDecorations((e=>{this.decorationIds=e.deltaDecorations(this.decorationIds,[])}))}setParts(e,t,i){if(!this.editor.getModel())return;const n=new Array;i&&n.push({range:C.Q.fromPositions(new h.y(e,i.column),new h.y(e,i.column+i.length)),options:{inlineClassName:"ghost-text-hidden",description:"ghost-text-hidden"}}),this.editor.changeDecorations((i=>{this.decorationIds=i.deltaDecorations(this.decorationIds,t.map((t=>({range:C.Q.fromPositions(new h.y(e,t.column)),options:{description:"ghost-text",after:{content:t.text,inlineClassName:t.preview?"ghost-text-decoration-preview":"ghost-text-decoration",cursorStops:xe.VW.Left},showIfCollapsed:!0}}))).concat(n))}))}}class Pe{constructor(e,t){this.editor=e,this.languageIdCodec=t,this._viewZoneId=void 0}get viewZoneId(){return this._viewZoneId}dispose(){this.clear()}clear(){this.editor.changeViewZones((e=>{this._viewZoneId&&(e.removeZone(this._viewZoneId),this._viewZoneId=void 0)}))}updateLines(e,t,i){const n=this.editor.getModel();if(!n)return;const{tabSize:o}=n.getOptions();this.editor.changeViewZones((n=>{this._viewZoneId&&(n.removeZone(this._viewZoneId),this._viewZoneId=void 0);const s=Math.max(t.length,i);if(s>0){const i=document.createElement("div");!function(e,t,i,n,o){const s=n.get(29),r=n.get(107),a="none",l=n.get(85),c=n.get(47),h=n.get(46),u=n.get(61),g=(0,Ce.Du)(1e4);g.appendASCIIString('<div class="suggest-preview-text">');for(let e=0,n=i.length;e<n;e++){const n=i[e],p=n.content;g.appendASCIIString('<div class="view-line'),g.appendASCIIString('" style="top:'),g.appendASCIIString(String(e*u)),g.appendASCIIString('px;width:1000000px;">');const m=d.aC(p),v=d.E_(p),f=fe.f.createEmpty(p,o);(0,Ie.UW)(new Ie.zL(h.isMonospace&&!s,h.canUseHalfwidthRightwardsArrow,p,!1,m,v,0,f,n.decorations,t,0,h.spaceWidth,h.middotWidth,h.wsmiddotWidth,r,a,l,c!==ve.Bc.OFF,null),g),g.appendASCIIString("</div>")}g.appendASCIIString("</div>"),(0,me.M)(e,h);const p=g.build(),m=De?De.createHTML(p):p;e.innerHTML=m}(i,o,t,this.editor.getOptions(),this.languageIdCodec),this._viewZoneId=n.addZone({afterLineNumber:e,heightInLines:s,domNode:i,afterColumnAffinity:1})}}))}}class Le extends l.jG{constructor(e,t,i,n){super(),this.editor=e,this.position=t,this.domNode=i,this.allowEditorOverflow=!1,this.suppressMouseDown=!1,this._register(n),this._register((0,l.s)((()=>{this.editor.removeContentWidget(this)}))),this.editor.addContentWidget(this)}getId(){return"editor.widget.viewMoreLinesWidget"}getDomNode(){return this.domNode}getPosition(){return{position:this.position,preference:[0]}}}(0,be.zy)(((e,t)=>{const i=e.getColor(Se.Ek);i&&(t.addRule(`.monaco-editor .ghost-text-decoration { color: ${i.toString()} !important; }`),t.addRule(`.monaco-editor .ghost-text-decoration-preview { color: ${i.toString()} !important; }`),t.addRule(`.monaco-editor .suggest-preview-text .ghost-text { color: ${i.toString()} !important; }`));const n=e.getColor(Se.RH);n&&(t.addRule(`.monaco-editor .ghost-text-decoration { background-color: ${n.toString()}; }`),t.addRule(`.monaco-editor .ghost-text-decoration-preview { background-color: ${n.toString()}; }`),t.addRule(`.monaco-editor .suggest-preview-text .ghost-text { background-color: ${n.toString()}; }`));const o=e.getColor(Se.DH);o&&(t.addRule(`.monaco-editor .suggest-preview-text .ghost-text { border: 1px solid ${o}; }`),t.addRule(`.monaco-editor .ghost-text-decoration { border: 1px solid ${o}; }`),t.addRule(`.monaco-editor .ghost-text-decoration-preview { border: 1px solid ${o}; }`))}));var Ae=i(3765),Oe=i(96655),Ne=function(e,t,i,n){var o,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,i,r):o(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},ke=function(e,t){return function(i,n){t(i,n,e)}},He=function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function r(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,a)}l((n=n.apply(e,t||[])).next())}))};let Fe=class e extends l.jG{constructor(e,t){super(),this.editor=e,this.instantiationService=t,this.triggeredExplicitly=!1,this.activeController=this._register(new l.HE),this.activeModelDidChangeEmitter=this._register(new a.vl),this._register(this.editor.onDidChangeModel((()=>{this.updateModelController()}))),this._register(this.editor.onDidChangeConfiguration((e=>{e.hasChanged(108)&&this.updateModelController(),e.hasChanged(57)&&this.updateModelController()}))),this.updateModelController()}static get(t){return t.getContribution(e.ID)}get activeModel(){var e;return null===(e=this.activeController.value)||void 0===e?void 0:e.model}updateModelController(){const e=this.editor.getOption(108),t=this.editor.getOption(57);this.activeController.value=void 0,this.activeController.value=this.editor.hasModel()&&(e.preview||t.enabled||this.triggeredExplicitly)?this.instantiationService.createInstance(Ke,this.editor):void 0,this.activeModelDidChangeEmitter.fire()}shouldShowHoverAt(e){var t;return(null===(t=this.activeModel)||void 0===t?void 0:t.shouldShowHoverAt(e))||!1}shouldShowHoverAtViewZone(e){var t,i;return(null===(i=null===(t=this.activeController.value)||void 0===t?void 0:t.widget)||void 0===i?void 0:i.shouldShowHoverAtViewZone(e))||!1}trigger(){var e;this.triggeredExplicitly=!0,this.activeController.value||this.updateModelController(),null===(e=this.activeModel)||void 0===e||e.triggerInlineCompletion()}commit(){var e;null===(e=this.activeModel)||void 0===e||e.commitInlineCompletion()}hide(){var e;null===(e=this.activeModel)||void 0===e||e.hideInlineCompletion()}showNextInlineCompletion(){var e;null===(e=this.activeModel)||void 0===e||e.showNextInlineCompletion()}showPreviousInlineCompletion(){var e;null===(e=this.activeModel)||void 0===e||e.showPreviousInlineCompletion()}hasMultipleInlineCompletions(){var e;return He(this,void 0,void 0,(function*(){const t=yield null===(e=this.activeModel)||void 0===e?void 0:e.hasMultipleInlineCompletions();return void 0!==t&&t}))}};Fe.inlineSuggestionVisible=new Oe.N1("inlineSuggestionVisible",!1,Ae.kg("inlineSuggestionVisible","Whether an inline suggestion is visible")),Fe.inlineSuggestionHasIndentation=new Oe.N1("inlineSuggestionHasIndentation",!1,Ae.kg("inlineSuggestionHasIndentation","Whether the inline suggestion starts with whitespace")),Fe.inlineSuggestionHasIndentationLessThanTabSize=new Oe.N1("inlineSuggestionHasIndentationLessThanTabSize",!0,Ae.kg("inlineSuggestionHasIndentationLessThanTabSize","Whether the inline suggestion starts with whitespace that is less than what would be inserted by tab")),Fe.ID="editor.contrib.ghostTextController",Fe=Ne([ke(1,re._Y)],Fe);class We{constructor(e){this.contextKeyService=e,this.inlineCompletionVisible=Fe.inlineSuggestionVisible.bindTo(this.contextKeyService),this.inlineCompletionSuggestsIndentation=Fe.inlineSuggestionHasIndentation.bindTo(this.contextKeyService),this.inlineCompletionSuggestsIndentationLessThanTabSize=Fe.inlineSuggestionHasIndentationLessThanTabSize.bindTo(this.contextKeyService)}}let Ke=class extends l.jG{constructor(e,t,i){super(),this.editor=e,this.instantiationService=t,this.contextKeyService=i,this.contextKeys=new We(this.contextKeyService),this.model=this._register(this.instantiationService.createInstance(he,this.editor)),this.widget=this._register(this.instantiationService.createInstance(Te,this.editor,this.model)),this._register((0,l.s)((()=>{this.contextKeys.inlineCompletionVisible.set(!1),this.contextKeys.inlineCompletionSuggestsIndentation.set(!1),this.contextKeys.inlineCompletionSuggestsIndentationLessThanTabSize.set(!0)}))),this._register(this.model.onDidChange((()=>{this.updateContextKeys()}))),this.updateContextKeys()}updateContextKeys(){var e;this.contextKeys.inlineCompletionVisible.set(void 0!==(null===(e=this.model.activeInlineCompletionsModel)||void 0===e?void 0:e.ghostText));let t=!1,i=!0;const n=this.model.inlineCompletionsModel.ghostText;if(this.model.activeInlineCompletionsModel&&n&&n.parts.length>0){const{column:e,lines:o}=n.parts[0],s=o[0];if(e<=this.editor.getModel().getLineIndentColumn(n.lineNumber)){let e=(0,d.HG)(s);-1===e&&(e=s.length-1),t=e>0;const n=this.editor.getModel().getOptions().tabSize;i=c.A.visibleColumnFromColumn(s,e+1,n)<n}}this.contextKeys.inlineCompletionSuggestsIndentation.set(t),this.contextKeys.inlineCompletionSuggestsIndentationLessThanTabSize.set(i)}};Ke=Ne([ke(1,re._Y),ke(2,Oe.fN)],Ke);class Ve extends n.ks{constructor(){super({id:Ve.ID,label:Ae.kg("action.inlineSuggest.showNext","Show Next Inline Suggestion"),alias:"Show Next Inline Suggestion",precondition:Oe.M$.and(o.R.writable,Fe.inlineSuggestionVisible),kbOpts:{weight:100,primary:601}})}run(e,t){return He(this,void 0,void 0,(function*(){const e=Fe.get(t);e&&(e.showNextInlineCompletion(),t.focus())}))}}Ve.ID="editor.action.inlineSuggest.showNext";class je extends n.ks{constructor(){super({id:je.ID,label:Ae.kg("action.inlineSuggest.showPrevious","Show Previous Inline Suggestion"),alias:"Show Previous Inline Suggestion",precondition:Oe.M$.and(o.R.writable,Fe.inlineSuggestionVisible),kbOpts:{weight:100,primary:599}})}run(e,t){return He(this,void 0,void 0,(function*(){const e=Fe.get(t);e&&(e.showPreviousInlineCompletion(),t.focus())}))}}je.ID="editor.action.inlineSuggest.showPrevious";class ze extends n.ks{constructor(){super({id:"editor.action.inlineSuggest.trigger",label:Ae.kg("action.inlineSuggest.trigger","Trigger Inline Suggestion"),alias:"Trigger Inline Suggestion",precondition:o.R.writable})}run(e,t){return He(this,void 0,void 0,(function*(){const e=Fe.get(t);e&&e.trigger()}))}}var Ge=i(90028),Be=i(54968),Ue=i(53909),Qe=i(58067),$e=i(54435),Ze=function(e,t,i,n){var o,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,i,r):o(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},qe=function(e,t){return function(i,n){t(i,n,e)}};class Ye{constructor(e,t,i){this.owner=e,this.range=t,this.controller=i}isValidForHoverAnchor(e){return 1===e.type&&this.range.startColumn<=e.range.startColumn&&this.range.endColumn>=e.range.endColumn}hasMultipleSuggestions(){return this.controller.hasMultipleInlineCompletions()}get commands(){var e,t,i;return(null===(i=null===(t=null===(e=this.controller.activeModel)||void 0===e?void 0:e.activeInlineCompletionsModel)||void 0===t?void 0:t.completionSession.value)||void 0===i?void 0:i.commands)||[]}}let Xe=class{constructor(e,t,i,n,o,s,r){this._editor=e,this._commandService=t,this._menuService=i,this._contextKeyService=n,this._languageService=o,this._openerService=s,this.accessibilityService=r,this.hoverOrdinal=3}suggestHoverAnchor(e){const t=Fe.get(this._editor);if(!t)return null;const i=e.target;if(8===i.type){const e=i.detail;if(t.shouldShowHoverAtViewZone(e.viewZoneId))return new s.mm(1e3,this,C.Q.fromPositions(e.positionBefore||e.position,e.positionBefore||e.position))}if(7===i.type&&t.shouldShowHoverAt(i.range))return new s.mm(1e3,this,i.range);if(6===i.type){if(i.detail.mightBeForeignElement&&t.shouldShowHoverAt(i.range))return new s.mm(1e3,this,i.range)}return null}computeSync(e,t){const i=Fe.get(this._editor);return i&&i.shouldShowHoverAt(e.range)?[new Ye(this,e.range,i)]:[]}renderHoverParts(e,t){const i=new l.Cm,n=t[0];this.accessibilityService.isScreenReaderOptimized()&&this.renderScreenReaderText(e,n,i);const o=i.add(this._menuService.createMenu(Qe.D8.InlineCompletionsActions,this._contextKeyService)),s=e.statusBar.addAction({label:Ae.kg("showNextInlineSuggestion","Next"),commandId:Ve.ID,run:()=>this._commandService.executeCommand(Ve.ID)}),a=e.statusBar.addAction({label:Ae.kg("showPreviousInlineSuggestion","Previous"),commandId:je.ID,run:()=>this._commandService.executeCommand(je.ID)});e.statusBar.addAction({label:Ae.kg("acceptInlineSuggestion","Accept"),commandId:r,run:()=>this._commandService.executeCommand(r)});const d=[s,a];for(const e of d)e.setEnabled(!1);n.hasMultipleSuggestions().then((e=>{for(const t of d)t.setEnabled(e)}));for(const t of n.commands)e.statusBar.addAction({label:t.title,commandId:t.id,run:()=>this._commandService.executeCommand(t.id,...t.arguments||[])});for(const[t,i]of o.getActions())for(const t of i)t instanceof Qe.Xe&&e.statusBar.addAction({label:t.label,commandId:t.item.id,run:()=>this._commandService.executeCommand(t.item.id)});return i}renderScreenReaderText(e,t,i){var n,o;const s=pe.$,r=s("div.hover-row.markdown-hover"),a=pe.BC(r,s("div.hover-contents")),l=i.add(new Be.T({editor:this._editor},this._languageService,this._openerService)),d=null===(o=null===(n=t.controller.activeModel)||void 0===n?void 0:n.inlineCompletionsModel)||void 0===o?void 0:o.ghostText;if(d){const t=this._editor.getModel().getLineContent(d.lineNumber);(t=>{i.add(l.onDidRenderAsync((()=>{a.className="hover-contents code-hover-contents",e.onContentsChanged()})));const n=Ae.kg("inlineSuggestionFollows","Suggestion:"),o=i.add(l.render((new Ge.Bc).appendText(n).appendCodeblock("text",t)));a.replaceChildren(o.element)})(d.renderForScreenReader(t))}e.fragment.appendChild(r)}};Xe=Ze([qe(1,_.wT),qe(2,Qe.ez),qe(3,Oe.fN),qe(4,we.L),qe(5,$e.Cr),qe(6,Ue.j)],Xe);var Je=i(48421);(0,n.HW)(Fe.ID,Fe),(0,n.Fl)(ze),(0,n.Fl)(Ve),(0,n.Fl)(je),s.B2.register(Xe);var et=n.DX.bindToContribution(Fe.get),tt=new et({id:r,precondition:Fe.inlineSuggestionVisible,handler:function(e){e.commit(),e.editor.focus()}});(0,n.E_)(tt),Je.f.registerKeybindingRule({primary:2,weight:200,id:tt.id,when:Oe.M$.and(tt.precondition,o.R.tabMovesFocus.toNegated(),Fe.inlineSuggestionHasIndentationLessThanTabSize)}),(0,n.E_)(new et({id:"editor.action.inlineSuggest.hide",precondition:Fe.inlineSuggestionVisible,kbOpts:{weight:100,primary:9},handler:function(e){e.hide()}}))},21556:function(e,t,i){var n=i(50946),o=i(46311),s=i(14333),r=i(13338),a=i(65958),l=i(78903),d=i(94327),c=i(10998),h=i(27992),u=i(79359),g=i(37264),p=i(58574),m=i(66476),v=i(23877),f=i(28061),C=i(47317),x=i(66055),w=i(20491),S=i(12060),y=i(52230),I=i(37042),b=i(87951),_=i(15365),M=i(13072),D=function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function r(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,a)}l((n=n.apply(e,t||[])).next())}))};class T{constructor(e,t){this.range=e,this.direction=t}}class R{constructor(e,t,i){this.hint=e,this.anchor=t,this.provider=i,this._isResolved=!1}with(e){const t=new R(this.hint,e.anchor,this.provider);return t._isResolved=this._isResolved,t._currentResolve=this._currentResolve,t}resolve(e){return D(this,void 0,void 0,(function*(){if("function"==typeof this.provider.resolveInlayHint){if(this._currentResolve){if(yield this._currentResolve,e.isCancellationRequested)return;return this.resolve(e)}this._isResolved||(this._currentResolve=this._doResolve(e).finally((()=>this._currentResolve=void 0))),yield this._currentResolve}}))}_doResolve(e){var t,i;return D(this,void 0,void 0,(function*(){try{const n=yield Promise.resolve(this.provider.resolveInlayHint(this.hint,e));this.hint.tooltip=null!==(t=null==n?void 0:n.tooltip)&&void 0!==t?t:this.hint.tooltip,this.hint.label=null!==(i=null==n?void 0:n.label)&&void 0!==i?i:this.hint.label,this._isResolved=!0}catch(e){(0,d.M_)(e),this._isResolved=!1}}))}}class E{constructor(e,t,i){this._disposables=new c.Cm,this.ranges=e,this.provider=new Set;const n=[];for(const[e,o]of t){this._disposables.add(e),this.provider.add(o);for(const t of e.hints){const e=i.validatePosition(t.position);let s="before";const r=E._getRangeAtPosition(i,e);let a;r.getStartPosition().isBefore(e)?(a=f.Q.fromPositions(r.getStartPosition(),e),s="after"):(a=f.Q.fromPositions(e,r.getEndPosition()),s="before"),n.push(new R(t,new T(a,s),o))}}this.items=n.sort(((e,t)=>_.y.compare(e.hint.position,t.hint.position)))}static create(e,t,i,n){return D(this,void 0,void 0,(function*(){const o=[],s=e.ordered(t).reverse().map((e=>i.map((i=>D(this,void 0,void 0,(function*(){try{const s=yield e.provideInlayHints(t,i,n);(null==s?void 0:s.hints.length)&&o.push([s,e])}catch(e){(0,d.M_)(e)}}))))));if(yield Promise.all(s.flat()),n.isCancellationRequested||t.isDisposed())throw new d.AL;return new E(i,o,t)}))}dispose(){this._disposables.dispose()}static _getRangeAtPosition(e,t){const i=t.lineNumber,n=e.getWordAtPosition(t);if(n)return new f.Q(i,n.startColumn,i,n.endColumn);e.tokenization.tokenizeIfCheap(i);const o=e.tokenization.getLineTokens(i),s=t.column-1,r=o.findTokenIndexAtOffset(s);let a=o.getStartOffset(r),l=o.getEndOffset(r);return l-a==1&&(a===s&&r>1?(a=o.getStartOffset(r-1),l=o.getEndOffset(r-1)):l===s&&r<o.getCount()-1&&(a=o.getStartOffset(r+1),l=o.getEndOffset(r+1))),new f.Q(i,a+1,i,l+1)}}var P=i(27969),L=i(95976),A=i(61568),O=i(58067),N=i(59715),k=i(96655),H=i(52348),F=i(82399),W=i(29879),K=function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function r(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,a)}l((n=n.apply(e,t||[])).next())}))};function V(e,t,i,o){var r;return K(this,void 0,void 0,(function*(){const a=e.get(I.b),d=e.get(H.Z),c=e.get(N.wT),h=e.get(F._Y),u=e.get(W.Ot);if(yield o.item.resolve(l.X.None),!o.part.location)return;const g=o.part.location,p=[],m=new Set(O.ZG.getMenuItems(O.D8.EditorContext).map((e=>(0,O.is)(e)?e.command.id:"")));for(const e of n.dS.getEditorActions())e instanceof L.bn&&m.has(e.id)&&p.push(new P.rc(e.id,e.label,void 0,!0,(()=>K(this,void 0,void 0,(function*(){const i=yield a.createModelReference(g.uri);try{yield h.invokeFunction(e.run.bind(e),t,new L.QS(i.object.textEditorModel,f.Q.getStartPosition(g.range)))}finally{i.dispose()}})))));if(o.part.command){const{command:e}=o.part;p.push(new P.wv),p.push(new P.rc(e.id,e.title,void 0,!0,(()=>K(this,void 0,void 0,(function*(){var t;try{yield c.executeCommand(e.id,...null!==(t=e.arguments)&&void 0!==t?t:[])}catch(e){u.notify({severity:W.AI.Error,source:o.item.provider.displayName,message:e})}})))))}const v=t.getOption(117);d.showContextMenu({domForShadowRoot:v&&null!==(r=t.getDomNode())&&void 0!==r?r:void 0,getAnchor:()=>{const e=s.BK(i);return{x:e.left,y:e.top+e.height+8}},getActions:()=>p,onHide:()=>{t.focus()},autoSelectFirstItem:!0})}))}function j(e,t,i,n){return K(this,void 0,void 0,(function*(){const o=e.get(I.b),s=yield o.createModelReference(n.uri);yield i.invokeWithinContext((e=>K(this,void 0,void 0,(function*(){const o=t.hasSideBySideModifier,r=e.get(k.fN),a=A.x2.inPeekEditor.getValue(r),l=!o&&i.getOption(80)&&!a;return new L.mR({openToSide:o,openInPeek:l,muteMessage:!0},{alias:"",label:"",id:"",precondition:void 0}).run(e,i,{model:s.object.textEditorModel,position:f.Q.getStartPosition(n.range)})})))),s.dispose()}))}var z=i(66726),G=i(4874),B=i(89044),U=function(e,t,i,n){var o,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,i,r):o(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},Q=function(e,t){return function(i,n){t(i,n,e)}},$=function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function r(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,a)}l((n=n.apply(e,t||[])).next())}))};class Z{constructor(){this._entries=new h.qK(50)}get(e){const t=Z._key(e);return this._entries.get(t)}set(e,t){const i=Z._key(e);this._entries.set(i,t)}static _key(e){return`${e.uri.toString()}/${e.getVersionId()}`}}const q=(0,F.u1)("IInlayHintsCache");(0,z.v)(q,Z,!0);class Y{constructor(e,t){this.item=e,this.index=t}get part(){const e=this.item.hint.label;return"string"==typeof e?{label:e}:e[this.index]}}class X{constructor(e,t){this.part=e,this.hasTriggerModifier=t}}let J=class e{constructor(e,t,i,n,o,s,r){this._editor=e,this._languageFeaturesService=t,this._inlayHintsCache=n,this._commandService=o,this._notificationService=s,this._instaService=r,this._disposables=new c.Cm,this._sessionDisposables=new c.Cm,this._decorationsMetadata=new Map,this._ruleFactory=new p.Qn(this._editor),this._activeRenderMode=0,this._debounceInfo=i.for(t.inlayHintsProvider,"InlayHint",{min:25}),this._disposables.add(t.inlayHintsProvider.onDidChange((()=>this._update()))),this._disposables.add(e.onDidChangeModel((()=>this._update()))),this._disposables.add(e.onDidChangeModelLanguage((()=>this._update()))),this._disposables.add(e.onDidChangeConfiguration((e=>{e.hasChanged(129)&&this._update()}))),this._update()}static get(t){var i;return null!==(i=t.getContribution(e.ID))&&void 0!==i?i:void 0}dispose(){this._sessionDisposables.dispose(),this._removeAllDecorations(),this._disposables.dispose()}_update(){this._sessionDisposables.clear(),this._removeAllDecorations();const e=this._editor.getOption(129);if("off"===e.enabled)return;const t=this._editor.getModel();if(!t||!this._languageFeaturesService.inlayHintsProvider.has(t))return;const i=this._inlayHintsCache.get(t);let n;i&&this._updateHintsDecorators([t.getFullModelRange()],i),this._sessionDisposables.add((0,c.s)((()=>{t.isDisposed()||this._cacheHintsForFastRestore(t)})));const o=new Set,r=new a.uC((()=>$(this,void 0,void 0,(function*(){const e=Date.now();null==n||n.dispose(!0),n=new l.Q;const i=t.onWillDispose((()=>null==n?void 0:n.cancel()));try{const i=n.token,s=yield E.create(this._languageFeaturesService.inlayHintsProvider,t,this._getHintsRanges(),i);if(r.delay=this._debounceInfo.update(t,Date.now()-e),i.isCancellationRequested)return void s.dispose();for(const e of s.provider)"function"!=typeof e.onDidChangeInlayHints||o.has(e)||(o.add(e),this._sessionDisposables.add(e.onDidChangeInlayHints((()=>{r.isScheduled()||r.schedule()}))));this._sessionDisposables.add(s),this._updateHintsDecorators(s.ranges,s.items),this._cacheHintsForFastRestore(t)}catch(e){(0,d.dz)(e)}finally{n.dispose(),i.dispose()}}))),this._debounceInfo.get(t));if(this._sessionDisposables.add(r),this._sessionDisposables.add((0,c.s)((()=>null==n?void 0:n.dispose(!0)))),r.schedule(0),this._sessionDisposables.add(this._editor.onDidScrollChange((e=>{!e.scrollTopChanged&&r.isScheduled()||r.schedule()}))),this._sessionDisposables.add(this._editor.onDidChangeModelContent((e=>{const t=Math.max(r.delay,1250);r.schedule(t)}))),"on"===e.enabled)this._activeRenderMode=0;else{let t,i;"onUnlessPressed"===e.enabled?(t=0,i=1):(t=1,i=0),this._activeRenderMode=t,this._sessionDisposables.add(s.Di.getInstance().event((e=>{if(!this._editor.hasModel())return;const n=e.altKey&&e.ctrlKey?i:t;if(n!==this._activeRenderMode){this._activeRenderMode=n;const e=this._editor.getModel(),t=this._copyInlayHintsWithCurrentAnchor(e);this._updateHintsDecorators([e.getFullModelRange()],t),r.schedule(0)}})))}this._sessionDisposables.add(this._installDblClickGesture((()=>r.schedule(0)))),this._sessionDisposables.add(this._installLinkGesture()),this._sessionDisposables.add(this._installContextMenu())}_installLinkGesture(){const e=new c.Cm,t=e.add(new b.gi(this._editor)),i=new c.Cm;return e.add(i),e.add(t.onMouseMoveOrRelevantKeyDown((e=>{const[t]=e,n=this._getInlayHintLabelPart(t),o=this._editor.getModel();if(!n||!o)return void i.clear();const s=new l.Q;i.add((0,c.s)((()=>s.dispose(!0)))),n.item.resolve(s.token),this._activeInlayHintPart=n.part.command||n.part.location?new X(n,t.hasTriggerModifier):void 0;const r=n.item.hint.position.lineNumber,a=new f.Q(r,1,r,o.getLineMaxColumn(r)),d=this._getInlineHintsForRange(a);this._updateHintsDecorators([a],d),i.add((0,c.s)((()=>{this._activeInlayHintPart=void 0,this._updateHintsDecorators([a],d)})))}))),e.add(t.onCancel((()=>i.clear()))),e.add(t.onExecute((e=>$(this,void 0,void 0,(function*(){const t=this._getInlayHintLabelPart(e);if(t){const i=t.part;i.location?this._instaService.invokeFunction(j,e,this._editor,i.location):C.uB.is(i.command)&&(yield this._invokeCommand(i.command,t.item))}}))))),e}_getInlineHintsForRange(e){const t=new Set;for(const i of this._decorationsMetadata.values())e.containsRange(i.item.anchor.range)&&t.add(i.item);return Array.from(t)}_installDblClickGesture(e){return this._editor.onMouseUp((t=>$(this,void 0,void 0,(function*(){if(2!==t.event.detail)return;const i=this._getInlayHintLabelPart(t);if(i&&(t.event.preventDefault(),yield i.item.resolve(l.X.None),(0,r.EI)(i.item.hint.textEdits))){const t=i.item.hint.textEdits.map((e=>v.k.replace(f.Q.lift(e.range),e.text)));this._editor.executeEdits("inlayHint.default",t),e()}}))))}_installContextMenu(){return this._editor.onContextMenu((e=>$(this,void 0,void 0,(function*(){if(!(e.event.target instanceof HTMLElement))return;const t=this._getInlayHintLabelPart(e);t&&(yield this._instaService.invokeFunction(V,this._editor,e.event.target,t))}))))}_getInlayHintLabelPart(e){var t;if(6!==e.target.type)return;const i=null===(t=e.target.detail.injectedText)||void 0===t?void 0:t.options;return i instanceof w.Ho&&(null==i?void 0:i.attachedData)instanceof Y?i.attachedData:void 0}_invokeCommand(e,t){var i;return $(this,void 0,void 0,(function*(){try{yield this._commandService.executeCommand(e.id,...null!==(i=e.arguments)&&void 0!==i?i:[])}catch(e){this._notificationService.notify({severity:W.AI.Error,source:t.provider.displayName,message:e})}}))}_cacheHintsForFastRestore(e){const t=this._copyInlayHintsWithCurrentAnchor(e);this._inlayHintsCache.set(e,t)}_copyInlayHintsWithCurrentAnchor(e){const t=new Map;for(const[i,n]of this._decorationsMetadata){if(t.has(n.item))continue;const o=e.getDecorationRange(i);if(o){const e=new T(o,n.item.anchor.direction),i=n.item.with({anchor:e});t.set(n.item,i)}}return Array.from(t.values())}_getHintsRanges(){const e=this._editor.getModel(),t=this._editor.getVisibleRangesPlusViewportAboveBelow(),i=[];for(const n of t.sort(f.Q.compareRangesUsingStarts)){const t=e.validateRange(new f.Q(n.startLineNumber-30,n.startColumn,n.endLineNumber+30,n.endColumn));0!==i.length&&f.Q.areIntersectingOrTouching(i[i.length-1],t)?i[i.length-1]=f.Q.plusRange(i[i.length-1],t):i.push(t)}return i}_updateHintsDecorators(t,i){var n,o;const s=[],a=(e,t,i,n,o)=>{const r={content:i,inlineClassNameAffectsLetterSpacing:!0,inlineClassName:t.className,cursorStops:n,attachedData:o};s.push({item:e,classNameRef:t,decoration:{range:e.anchor.range,options:{description:"InlayHint",showIfCollapsed:e.anchor.range.isEmpty(),collapseOnReplaceEdit:!e.anchor.range.isEmpty(),stickiness:0,[e.anchor.direction]:0===this._activeRenderMode?r:void 0}}})},l=(e,t)=>{const i=this._ruleFactory.createClassNameRef({width:(d/3|0)+"px",display:"inline-block"});a(e,i," ",t?x.VW.Right:x.VW.None)},{fontSize:d,fontFamily:c,padding:h,isUniform:u}=this._getLayoutInfo(),g="--code-editorInlayHintsFontFamily";this._editor.getContainerDomNode().style.setProperty(g,c);for(const t of i){t.hint.paddingLeft&&l(t,!1);const i="string"==typeof t.hint.label?[{label:t.hint.label}]:t.hint.label;for(let e=0;e<i.length;e++){const o=i[e],s=0===e,l=e===i.length-1,c={fontSize:`${d}px`,fontFamily:`var(${g}), ${m.jU.fontFamily}`,verticalAlign:u?"baseline":"middle"};(0,r.EI)(t.hint.textEdits)&&(c.cursor="default"),this._fillInColors(c,t.hint),(o.command||o.location)&&(null===(n=this._activeInlayHintPart)||void 0===n?void 0:n.part.item)===t&&this._activeInlayHintPart.part.index===e&&(c.textDecoration="underline",this._activeInlayHintPart.hasTriggerModifier&&(c.color=(0,B.Yf)(G.Ztu),c.cursor="pointer")),h&&(s&&l?(c.padding=`1px ${0|Math.max(1,d/4)}px`,c.borderRadius=(d/4|0)+"px"):s?(c.padding=`1px 0 1px ${0|Math.max(1,d/4)}px`,c.borderRadius=`${d/4|0}px 0 0 ${d/4|0}px`):l?(c.padding=`1px ${0|Math.max(1,d/4)}px 1px 0`,c.borderRadius=`0 ${d/4|0}px ${d/4|0}px 0`):c.padding="1px 0 1px 0"),a(t,this._ruleFactory.createClassNameRef(c),ee(o.label),l&&!t.hint.paddingRight?x.VW.Right:x.VW.None,new Y(t,e))}if(t.hint.paddingRight&&l(t,!0),s.length>e._MAX_DECORATORS)break}const p=[];for(const e of t)for(const{id:t}of null!==(o=this._editor.getDecorationsInRange(e))&&void 0!==o?o:[]){const e=this._decorationsMetadata.get(t);e&&(p.push(t),e.classNameRef.dispose(),this._decorationsMetadata.delete(t))}this._editor.changeDecorations((e=>{const t=e.deltaDecorations(p,s.map((e=>e.decoration)));for(let e=0;e<t.length;e++){const i=s[e];this._decorationsMetadata.set(t[e],i)}}))}_fillInColors(e,t){t.kind===C.r4.Parameter?(e.backgroundColor=(0,B.Yf)(G.B2L),e.color=(0,B.Yf)(G.sjA)):t.kind===C.r4.Type?(e.backgroundColor=(0,B.Yf)(G._pU),e.color=(0,B.Yf)(G.HwT)):(e.backgroundColor=(0,B.Yf)(G.WL6),e.color=(0,B.Yf)(G.P6i))}_getLayoutInfo(){const e=this._editor.getOption(129),t=e.padding,i=this._editor.getOption(48),n=this._editor.getOption(45);let o=e.fontSize;(!o||o<5||o>i)&&(o=i);const s=e.fontFamily||n;return{fontSize:o,fontFamily:s,padding:t,isUniform:!t&&s===n&&o===i}}_removeAllDecorations(){this._editor.removeDecorations(Array.from(this._decorationsMetadata.keys()));for(const e of this._decorationsMetadata.values())e.classNameRef.dispose();this._decorationsMetadata.clear()}};function ee(e){return e.replace(/[ \t]/g," ")}J.ID="editor.contrib.InlayHints",J._MAX_DECORATORS=1500,J=U([Q(1,y.u),Q(2,S.U),Q(3,q),Q(4,N.wT),Q(5,W.Ot),Q(6,F._Y)],J),N.wb.registerCommand("_executeInlayHintProvider",((e,...t)=>$(void 0,void 0,void 0,(function*(){const[i,n]=t;(0,u.j)(g.r.isUri(i)),(0,u.j)(f.Q.isIRange(n));const{inlayHintsProvider:o}=e.get(y.u),s=yield e.get(I.b).createModelReference(i);try{const e=yield E.create(o,s.object.textEditorModel,[f.Q.lift(n)],l.X.None),t=e.items.map((e=>e.hint));return setTimeout((()=>e.dispose()),0),t}finally{s.dispose()}}))));var te=i(90028),ie=i(77922),ne=i(11950),oe=i(14270),se=i(85753),re=i(54435),ae=i(3765),le=i(63339),de=function(e,t,i,n){var o,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,i,r):o(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},ce=function(e,t){return function(i,n){t(i,n,e)}},he=function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function r(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,a)}l((n=n.apply(e,t||[])).next())}))},ue=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,i=e[Symbol.asyncIterator];return i?i.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(i){t[i]=e[i]&&function(t){return new Promise((function(n,o){(function(e,t,i,n){Promise.resolve(n).then((function(t){e({value:t,done:i})}),t)})(n,o,(t=e[i](t)).done,t.value)}))}}};class ge extends o.mm{constructor(e,t){super(10,t,e.item.anchor.range),this.part=e}}let pe=class extends oe.xJ{constructor(e,t,i,n,o,s){super(e,t,i,n,s),this._resolverService=o,this.hoverOrdinal=6}suggestHoverAnchor(e){var t;if(!J.get(this._editor))return null;if(6!==e.target.type)return null;const i=null===(t=e.target.detail.injectedText)||void 0===t?void 0:t.options;return i instanceof w.Ho&&i.attachedData instanceof Y?new ge(i.attachedData,this):null}computeSync(){return[]}computeAsync(e,t,i){return e instanceof ge?new a.AE((t=>he(this,void 0,void 0,(function*(){var n,o;const{part:s}=e;if(yield s.item.resolve(i),i.isCancellationRequested)return;let a,l;if("string"==typeof s.item.hint.tooltip?a=(new te.Bc).appendText(s.item.hint.tooltip):s.item.hint.tooltip&&(a=s.item.hint.tooltip),a&&t.emitOne(new oe.eH(this,e.range,[a],0)),(0,r.EI)(s.item.hint.textEdits)&&t.emitOne(new oe.eH(this,e.range,[(new te.Bc).appendText((0,ae.kg)("hint.dbl","Double click to insert"))],10001)),"string"==typeof s.part.tooltip?l=(new te.Bc).appendText(s.part.tooltip):s.part.tooltip&&(l=s.part.tooltip),l&&t.emitOne(new oe.eH(this,e.range,[l],1)),s.part.location||s.part.command){let i;const n="altKey"===this._editor.getOption(72)?le.zx?(0,ae.kg)("links.navigate.kb.meta.mac","cmd + click"):(0,ae.kg)("links.navigate.kb.meta","ctrl + click"):le.zx?(0,ae.kg)("links.navigate.kb.alt.mac","option + click"):(0,ae.kg)("links.navigate.kb.alt","alt + click");s.part.location&&s.part.command?i=(new te.Bc).appendText((0,ae.kg)("hint.defAndCommand","Go to Definition ({0}), right click for more",n)):s.part.location?i=(new te.Bc).appendText((0,ae.kg)("hint.def","Go to Definition ({0})",n)):s.part.command&&(i=new te.Bc(`[${(0,ae.kg)("hint.cmd","Execute Command")}](${d=s.part.command,g.r.from({scheme:M.ny.command,path:d.id,query:d.arguments&&encodeURIComponent(JSON.stringify(d.arguments))}).toString()} "${s.part.command.title}") (${n})`,{isTrusted:!0})),i&&t.emitOne(new oe.eH(this,e.range,[i],1e4))}var d;const c=yield this._resolveInlayHintLabelPartHover(s,i);try{for(var h,u=ue(c);!(h=yield u.next()).done;){const e=h.value;t.emitOne(e)}}catch(e){n={error:e}}finally{try{h&&!h.done&&(o=u.return)&&(yield o.call(u))}finally{if(n)throw n.error}}})))):a.AE.EMPTY}_resolveInlayHintLabelPartHover(e,t){return he(this,void 0,void 0,(function*(){if(!e.part.location)return a.AE.EMPTY;const{uri:i,range:n}=e.part.location,o=yield this._resolverService.createModelReference(i);try{const i=o.object.textEditorModel;return this._languageFeaturesService.hoverProvider.has(i)?(0,ne.Zt)(this._languageFeaturesService.hoverProvider,i,new _.y(n.startLineNumber,n.startColumn),t).filter((e=>!(0,te.it)(e.hover.contents))).map((t=>new oe.eH(this,e.item.anchor.range,t.hover.contents,2+t.ordinal))):a.AE.EMPTY}finally{o.dispose()}}))}};pe=de([ce(1,ie.L),ce(2,re.Cr),ce(3,se.pG),ce(4,I.b),ce(5,y.u)],pe),(0,n.HW)(J.ID,J),o.B2.register(pe)},91064:function(e,t,i){i.r(t),i.d(t,{ExpandLineSelectionAction:function(){return a}});var n=i(50946),o=i(27064),s=i(38122),r=i(3765);class a extends n.ks{constructor(){super({id:"expandLineSelection",label:r.kg("expandLineSelection","Expand Line Selection"),alias:"Expand Line Selection",precondition:void 0,kbOpts:{weight:0,kbExpr:s.R.textInputFocus,primary:2090}})}run(e,t,i){if(i=i||{},!t.hasModel())return;const n=t._getViewModel();n.model.pushStackElement(),n.setCursorStates(i.source,3,o.c.expandLineSelection(n,n.getCursorStates())),n.revealPrimaryCursor(i.source,!0)}}(0,n.Fl)(a)}}]);
