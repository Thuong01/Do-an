!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="70f8e69a-e9e1-4921-97c6-90d2260bbfb2",e._sentryDebugIdIdentifier="sentry-dbid-70f8e69a-e9e1-4921-97c6-90d2260bbfb2")}catch(e){}}();var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"13ad4a0c312011ebb49f3e8dc8f97be809f60d04"},(self.webpackChunkschema_diagram_vue=self.webpackChunkschema_diagram_vue||[]).push([[7935],{62323:function(e,t){function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(a=r.key,u=void 0,u=function(e,t){if("object"!==n(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!==n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(a,"string"),"symbol"===n(u)?u:String(u)),r)}var a,u}function a(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}Object.defineProperty(t,"__esModule",{value:!0}),t.TableRecord=t.Table=t.Ref=t.Index=t.Field=t.Enum=t.Endpoint=void 0;var u=function(){function e(t){var n=t.name,r=t.unique,a=t.pk,u=t.type,o=t.columns;i(this,e),this.name=n,this.type=u,this.unique=r,this.pk=a,this.columns=o}return a(e,[{key:"toJSON",value:function(){return{name:this.name,type:this.type,unique:this.unique,pk:this.pk,columns:this.columns}}}]),e}();t.Index=u;var o=function(){function e(t){var n=t.name,r=t.type,a=t.not_null,u=t.increment,o=t.dbdefault,c=t.unique,l=t.pk,s=t.note;i(this,e),this.name=n,this.type=r,this.not_null=a,this.increment=u,this.dbdefault=o,this.unique=c,this.pk=l,this.note=s}return a(e,[{key:"toJSON",value:function(){return{name:this.name,type:this.type,not_null:this.not_null,increment:this.increment,dbdefault:this.dbdefault,unique:this.unique,pk:this.pk,note:this.note}}}]),e}();t.Field=o;var c=function(){function e(t){var n=t.name,r=t.schemaName,a=t.fields,u=t.indexes,o=t.note;i(this,e),this.name=n,this.schemaName=r,this.fields=a||[],this.indexes=u||[],this.note=o}return a(e,[{key:"toJSON",value:function(){var e,t;return{name:this.name,schemaName:this.schemaName,fields:null===(e=this.fields)||void 0===e?void 0:e.map((function(e){return e.toJSON()})),indexes:null===(t=this.indexes)||void 0===t?void 0:t.map((function(e){return e.toJSON()})),note:this.note}}}]),e}();t.Table=c;var l=function(){function e(t){var n=t.tableName,r=t.schemaName,a=t.fieldNames,u=t.relation;i(this,e),this.tableName=n,this.schemaName=r,this.fieldNames=a,this.relation=u}return a(e,[{key:"toJSON",value:function(){return{tableName:this.tableName,schemaName:this.schemaName,fieldNames:this.fieldNames,relation:this.relation}}}]),e}();t.Endpoint=l;var s=function(){function e(t){var n=t.name,r=t.endpoints,a=t.onDelete,u=t.onUpdate;i(this,e),this.name=n,this.endpoints=r||[],this.onDelete=a,this.onUpdate=u}return a(e,[{key:"toJSON",value:function(){return{name:this.name,onDelete:this.onDelete,onUpdate:this.onUpdate,endpoints:this.endpoints.map((function(e){return e.toJSON()}))}}}]),e}();t.Ref=s;var f=function(){function e(t){var n=t.name,r=t.schemaName,a=t.values;i(this,e),this.name=n,this.schemaName=r,this.values=a}return a(e,[{key:"toJSON",value:function(){return{name:this.name,schemaName:this.schemaName,values:this.values}}}]),e}();t.Enum=f;var p=function(){function e(t){var n=t.tableName,r=t.columns,a=t.values,u=t.schemaName,o=void 0===u?void 0:u;i(this,e),this.tableName=n,this.schemaName=o,this.columns=r,this.values=a}return a(e,[{key:"toJSON",value:function(){return{tableName:this.tableName,schemaName:this.schemaName,columns:this.columns,values:this.values}}}]),e}();t.TableRecord=p},89756:function(e,t,n){function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=u(n(36168)),a=u(n(90032));function u(e){return e&&e.__esModule?e:{default:e}}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(a=r.key,u=void 0,u=function(e,t){if("object"!==i(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(a,"string"),"symbol"===i(u)?u:String(u)),r)}var a,u}function c(e,t){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},c(e,t)}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=s(e);if(t){var a=s(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(u,e);var t,n,i,r=l(u);function u(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=r.call(this,e)).errors=[],t}return t=u,(n=[{key:"syntaxError",value:function(e,t,n,i,r,u){this.errors.push(new a.default(n,i,r))}}])&&o(t.prototype,n),i&&o(t,i),Object.defineProperty(t,"prototype",{writable:!1}),u}(r.default.error.ErrorListener);t.default=f},90032:function(e,t){function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function i(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(a=r.key,u=void 0,u=function(e,t){if("object"!==n(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!==n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(a,"string"),"symbol"===n(u)?u:String(u)),r)}var a,u}function r(e){var t=c();return function(){var i,r=s(e);if(t){var u=s(this).constructor;i=Reflect.construct(r,arguments,u)}else i=r.apply(this,arguments);return function(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return a(e)}(this,i)}}function a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){var t="function"==typeof Map?new Map:void 0;return u=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,i)}function i(){return o(e,arguments,s(this).constructor)}return i.prototype=Object.create(e.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),l(i,e)},u(e)}function o(e,t,n){return o=c()?Reflect.construct.bind():function(e,t,n){var i=[null];i.push.apply(i,t);var r=new(Function.bind.apply(e,i));return n&&l(r,n.prototype),r},o.apply(null,arguments)}function c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function l(e,t){return l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},l(e,t)}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}(c,e);var t,n,u,o=r(c);function c(e,t,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),i=o.call(this,n),Error.captureStackTrace&&Error.captureStackTrace(a(i),c),i.text=n,i.location={start:{line:e,column:t}},i}return t=c,n&&i(t.prototype,n),u&&i(t,u),Object.defineProperty(t,"prototype",{writable:!1}),t}(u(Error));t.default=f},4950:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.TABLE_CONSTRAINT_KIND=t.DATA_TYPE=t.CONSTRAINT_TYPE=t.COLUMN_CONSTRAINT_KIND=void 0;t.TABLE_CONSTRAINT_KIND={FIELD:"field",INDEX:"index",FK:"fk",UNIQUE:"unique",PK:"pk",DEFAULT:"default"};t.COLUMN_CONSTRAINT_KIND={NOT_NULL:"not_null",UNIQUE:"unique",PK:"pk",DEFAULT:"dbdefault",INCREMENT:"increment",INLINE_REF:"inline_ref",NOTE:"note",CHECK:"check"};t.DATA_TYPE={STRING:"string",NUMBER:"number",BOOLEAN:"boolean",EXPRESSION:"expression"};t.CONSTRAINT_TYPE={COLUMN:"column",STRING:"string",EXPRESSION:"expression"}},13778:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.getOriginalText=function(e){var t=e.start.start,n=e.stop.stop;return(0,i.isNil)(t)||(0,i.isNil)(n)?void 0:e.start.getInputStream().getText(t,n)};var i=n(2543)},82483:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.parse=function(e,t){var n=new i.default.InputStream(e),h=null,_=new v.default;switch(t){case"postgres":var N=new r.default(n),b=new i.default.CommonTokenStream(N),T=new a.default(b);if(T.buildParseTrees=!0,T.removeErrorListeners(),T.addErrorListener(_),h=T.root().accept(new u.default),_.errors.length)throw _.errors;break;case"mysql":var O=new o.default(n),I=new i.default.CommonTokenStream(O),E=new c.default(I);if(E.buildParseTrees=!0,E.removeErrorListeners(),E.addErrorListener(_),h=E.root().accept(new l.default),_.errors.length)throw _.errors;break;case"mssql":var k=new m.default(n),g=new i.default.CommonTokenStream(k),A=new d.default(g);if(A.buildParseTrees=!0,A.removeErrorListeners(),A.addErrorListener(_),h=A.tsql_file().accept(new y.default),_.errors.length)throw _.errors;break;case"snowflake":var S=new s.default(n),C=new i.default.CommonTokenStream(S),x=new f.default(C);if(x.buildParseTrees=!0,x.removeErrorListeners(),x.addErrorListener(_),h=x.snowflake_file().accept(new p.default),_.errors.length)throw _.errors;break;default:throw new Error("Format not supported: ".concat(t))}return h};var i=h(n(36168)),r=h(n(18780)),a=h(n(88659)),u=h(n(79566)),o=h(n(58506)),c=h(n(11749)),l=h(n(56082)),s=h(n(23562)),f=h(n(28741)),p=h(n(90282)),v=h(n(89756)),m=h(n(37504)),d=h(n(19567)),y=h(n(69026));function h(e){return e&&e.__esModule?e:{default:e}}},69026:function(e,t,n){function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,a=n(2543),u=(r=n(67597))&&r.__esModule?r:{default:r},o=n(4950),c=n(13778),l=n(62323);function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(a=r.key,u=void 0,u=function(e,t){if("object"!==i(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(a,"string"),"symbol"===i(u)?u:String(u)),r)}var a,u}function f(e,t){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},f(e,t)}function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v(e);if(t){var a=v(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function v(e){return v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},v(e)}function m(e){return function(e){if(Array.isArray(e))return h(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||y(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,a,u,o=[],c=!0,l=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(i=a.call(n)).done)&&(o.push(i.value),o.length!==t);c=!0);}catch(e){l=!0,r=e}finally{try{if(!c&&null!=n.return&&(u=n.return(),Object(u)!==u))return}finally{if(l)throw r}}return o}}(e,t)||y(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e,t){if(e){if("string"==typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(e,t):void 0}}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var _="raw",N="enum",b=function(e){var t=(0,a.last)(e);return{schemaName:e.length>1?(0,a.nth)(e,-2):void 0,tableName:t}},T=function(e){return e.startsWith("N'")?e:e.slice(1,e.length-1)},O=function(e){var t=d(e.reduce((function(e,t){switch(t.kind){case o.TABLE_CONSTRAINT_KIND.FIELD:e[0].push(t.value);break;case o.TABLE_CONSTRAINT_KIND.INDEX:case o.TABLE_CONSTRAINT_KIND.PK:case o.TABLE_CONSTRAINT_KIND.UNIQUE:e[1].push(t.value);break;case o.TABLE_CONSTRAINT_KIND.FK:e[2].push(t.value);break;case o.TABLE_CONSTRAINT_KIND.DEFAULT:e[3].push(t.value);break;case o.TABLE_CONSTRAINT_KIND.CHECK:e[4].push(t.value)}return e}),[[],[],[],[],[]]),5);return{fieldsData:t[0],indexes:t[1],tableRefs:t[2],columnDefaults:t[3],checkConstraints:t[4]}},I=function(e,t,n){var i=d(e.reduce((function(e,i){var r,a=i.inline_refs.map((function(e){return e.endpoints[0].tableName=t,e.endpoints[0].schemaName=n,e.endpoints[0].fieldNames=[i.field.name],e}));return e[0].push(a),e[1].push(i.field),(r=e[2]).push.apply(r,m(i.checkConstraints)),e}),[[],[],[]]),3);return{inlineRefs:i[0],fields:i[1],checkConstraints:i[2]}},E=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(u,e);var t,n,i,r=p(u);function u(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(e=r.call(this)).data={schemas:[],tables:[],refs:[],enums:[],tableGroups:[],aliases:[],project:{},records:[]},e}return t=u,(n=[{key:"visitTsql_file",value:function(e){var t=this;return e.batch().forEach((function(e){return e.accept(t)})),this.data}},{key:"visitBatch",value:function(e){var t=this;e.sql_clauses()&&e.sql_clauses().forEach((function(e){return e.accept(t)}))}},{key:"visitSql_clauses",value:function(e){e.ddl_clause()?e.ddl_clause().accept(this):e.dml_clause()?e.dml_clause().accept(this):e.another_statement()&&e.another_statement().accept(this)}},{key:"visitDml_clause",value:function(e){e.insert_statement()&&e.insert_statement().accept(this)}},{key:"visitInsert_statement",value:function(e){var t=e.ddl_object().accept(this),n=(0,a.last)(t),i=t.length>1?(0,a.nth)(t,-2):void 0,r=e.insert_column_name_list()?e.insert_column_name_list().accept(this):[],u=e.insert_statement_value().accept(this),o=new l.TableRecord({tableName:n,schemaName:i,columns:r,values:u});this.data.records.push(o)}},{key:"visitDdl_object",value:function(e){return e.full_table_name().accept(this)}},{key:"visitFull_table_name",value:function(e){var t=this;return e.id_().map((function(e){return e.accept(t)}))}},{key:"visitId_",value:function(e){return e.DOUBLE_QUOTE_ID()||e.SQUARE_BRACKET_ID()?(0,c.getOriginalText)(e).slice(1,-1):(0,c.getOriginalText)(e)}},{key:"visitInsert_column_name_list",value:function(e){var t=this,n=e.insert_column_id().map((function(e){return e.accept(t)}));return(0,a.flattenDepth)(n,1)}},{key:"visitInsert_statement_value",value:function(e){return e.table_value_constructor()?e.table_value_constructor().accept(this):[]}},{key:"visitTable_value_constructor",value:function(e){var t=this;return e.expression_list_().map((function(e){return e.accept(t)}))}},{key:"visitExpression_list_",value:function(e){var t=this;return e.expression().map((function(e){return e.accept(t)}))}},{key:"visitExpression",value:function(e){return e.primitive_expression()?e.primitive_expression().accept(this):e.function_call()?e.function_call().accept(this):e.unary_operator_expression()?e.unary_operator_expression().accept(this):e.bracket_expression()?e.bracket_expression().accept(this):e.full_column_name()?e.full_column_name().accept(this):{value:(0,c.getOriginalText)(e),type:o.DATA_TYPE.EXPRESSION}}},{key:"visitBracket_expression",value:function(e){return e.expression()?e.expression().accept(this):null}},{key:"visitFull_column_name",value:function(e){var t=e.id_().accept(this),n=e.full_table_name()?e.full_table_name().accept(this):[];return{value:[].concat(m(n),[t]),type:o.DATA_TYPE.EXPRESSION}}},{key:"visitPrimitive_constant",value:function(e){if(e.STRING()||e.BINARY()){var t=T(e.getText());return{value:t,type:t.startsWith("N'")?o.DATA_TYPE.EXPRESSION:o.DATA_TYPE.STRING}}if(e.DOLLAR()){var n=(0,a.first)(e.children).getText(),i=e.children.length>2?(0,a.nth)(e.children,-2):"",r=(0,a.last)(e.children).getText();return{value:"".concat(n).concat(i).concat(r),type:o.DATA_TYPE.STRING}}return e.REAL()||e.DECIMAL()||e.FLOAT()?{value:e.getText(),type:o.DATA_TYPE.NUMBER}:{value:(0,c.getOriginalText)(e),type:o.DATA_TYPE.EXPRESSION}}},{key:"visitBUILT_IN_FUNC",value:function(e){return{value:(0,c.getOriginalText)(e),type:o.DATA_TYPE.EXPRESSION}}},{key:"visitSCALAR_FUNCTION",value:function(e){return{value:(0,c.getOriginalText)(e),type:o.DATA_TYPE.EXPRESSION}}},{key:"visitUnary_operator_expression",value:function(e){var t=e.children[0].getText(),n=e.expression().accept(this);return{value:"".concat(t).concat(n.value),type:n.type}}},{key:"visitData_type",value:function(e){if(e.MAX()){var t="";return t=e.SQUARE_BRACKET_ID()?e.SQUARE_BRACKET_ID().getText().slice(1,-1):(e.VARCHAR()||e.NVARCHAR()||e.BINARY_KEYWORD()||e.VARBINARY_KEYWORD()||e.SQUARE_BRACKET_ID()).getText(),"".concat(t,"(MAX)")}if(e.DOUBLE()){var n=e.DOUBLE().getText(),i=e.PRECISION()?" ".concat(e.PRECISION().getText()):"";return"".concat(n).concat(i)}var r=e.id_().accept(this);if(e.IDENTITY()){if(e.DECIMAL().length){var a=e.DECIMAL().map((function(e){return e.getText()}));return"".concat(r," IDENTITY(").concat(a,")")}return"".concat(r," IDENTITY")}if(e.DECIMAL().length){var u=e.DECIMAL().map((function(e){return e.getText()}));return"".concat(r,"(").concat(u.join(","),")")}return r}},{key:"visitPrimitive_expression",value:function(e){return e.NULL_()?{value:e.getText(),type:o.DATA_TYPE.BOOLEAN}:e.primitive_constant()?e.primitive_constant().accept(this):{value:e.getText(),type:o.DATA_TYPE.EXPRESSION}}},{key:"visitDdl_clause",value:function(e){e.create_table()?e.create_table().accept(this):e.alter_table()?e.alter_table().accept(this):e.create_index()&&e.create_index().accept(this)}},{key:"visitCreate_table",value:function(e){var t,n,i=this,r=b(e.table_name().accept(this)),u=r.schemaName,o=r.tableName,c=e.column_def_table_constraints().accept(this),s=e.table_indices().map((function(e){return e.accept(i)})),f=O(c),p=f.fieldsData,v=f.indexes,d=f.tableRefs,y=f.checkConstraints,h=I(p,o,u),_=h.inlineRefs,N=h.fields,T=h.checkConstraints;(t=this.data.refs).push.apply(t,m((0,a.flatten)(_))),(n=this.data.refs).push.apply(n,m(d.map((function(e){return e.endpoints[0].tableName=o,e.endpoints[0].schemaName=u,e})))),T.concat(y).forEach((function(e){var t=N.find((function(t){return t.name===e.column}));if(t){var n=new l.Enum({name:"".concat(o,"_").concat(t.name,"_enum"),values:e.columnValues.map((function(e){return{name:e}})),schemaName:u});i.data.enums.push(n),t.type.type_name=n.name,t.type.schemaName=n.schemaName}}));var E=new l.Table({name:o,schemaName:u,fields:N,indexes:s.concat(v)});this.data.tables.push(E)}},{key:"visitTable_name",value:function(e){var t=this;return e.id_().map((function(e){return e.accept(t)}))}},{key:"visitColumn_def_table_constraints",value:function(e){var t=this;return e.column_def_table_constraint().map((function(e){return e.accept(t)})).filter((function(e){return e}))}},{key:"visitColumn_def_table_constraint",value:function(e){return e.column_definition()?e.column_definition().accept(this):e.table_constraint()?e.table_constraint().accept(this):null}},{key:"visitColumn_definition",value:function(e){var t=this,n=e.id_().accept(this),i="";if(e.data_type())i=e.data_type().accept(this);else if(e.expression()){var r=e.expression().accept(this),a=e.AS().getText(),u=e.PERSISTED()?" ".concat(e.PERSISTED().getText()):"";i="".concat(a," ").concat(r.value).concat(u)}var c=new l.Field({name:n,type:{type_name:i,schemaName:null}}),s={kind:o.TABLE_CONSTRAINT_KIND.FIELD,value:{field:c,inline_refs:[],checkConstraints:[]}};return e.column_definition_element().map((function(e){return e.accept(t)})).filter((function(e){return e})).forEach((function(e){switch(e.kind){case o.COLUMN_CONSTRAINT_KIND.DEFAULT:c.dbdefault=e.value;break;case o.COLUMN_CONSTRAINT_KIND.INCREMENT:c.increment=e.value;break;case o.COLUMN_CONSTRAINT_KIND.NOT_NULL:c.not_null=e.value;break;case o.COLUMN_CONSTRAINT_KIND.PK:c.pk=e.value;break;case o.COLUMN_CONSTRAINT_KIND.UNIQUE:c.unique=e.value;break;case o.COLUMN_CONSTRAINT_KIND.INLINE_REF:s.value.inline_refs.push(e.value);break;case o.COLUMN_CONSTRAINT_KIND.CHECK:var t=e.value,n=t.type,i=t.value;if(n!==N)return;s.value.checkConstraints.push(i)}})),s}},{key:"visitColumn_definition_element",value:function(e){return e.DEFAULT()?{kind:o.COLUMN_CONSTRAINT_KIND.DEFAULT,value:e.expression().accept(this)}:e.IDENTITY()?{kind:o.COLUMN_CONSTRAINT_KIND.INCREMENT,value:!0}:e.column_constraint()?e.column_constraint().accept(this):null}},{key:"visitColumn_constraint",value:function(e){if(e.null_notnull()){var t=!1;return e.null_notnull().accept(this).includes("NOT")&&(t=!0),{kind:o.COLUMN_CONSTRAINT_KIND.NOT_NULL,value:t}}if(e.UNIQUE())return{kind:o.COLUMN_CONSTRAINT_KIND.UNIQUE,value:!0};if(e.PRIMARY())return{kind:o.COLUMN_CONSTRAINT_KIND.PK,value:!0};if(e.foreign_key_options()){var n=e.foreign_key_options().accept(this),i=n.refTableName,r=n.refSchemaName,a=n.fieldNames,u=n.onDelete,c=n.onUpdate;return{kind:o.COLUMN_CONSTRAINT_KIND.INLINE_REF,value:{endpoints:[{tableName:null,schemaName:null,fieldNames:null,relation:"*"},{tableName:i,schemaName:r,fieldNames:a,relation:"1"}],onDelete:u,onUpdate:c}}}return e.check_constraint()?{kind:o.COLUMN_CONSTRAINT_KIND.CHECK,value:e.check_constraint().accept(this)}:null}},{key:"visitCheck_constraint",value:function(e){return e.search_condition().accept(this)}},{key:"visitSearch_condition",value:function(e){if(!e.predicate()||e.NOT().length)return{type:_,value:(0,c.getOriginalText)(e)};var t=e.predicate().accept(this);return t?{type:N,value:t}:{type:_,value:(0,c.getOriginalText)(e)}}},{key:"visitPredicate",value:function(e){var t=this;if(e.IN()&&e.expression_list_()&&0===e.NOT().length){var n,i=d(e.expression().map((function(e){return e.accept(t)})),1)[0],r=void 0===i?{}:i;return{column:(0,a.last)(null!==(n=r.value)&&void 0!==n?n:[]),columnValues:e.expression_list_().accept(this).map((function(e){return e.value}))}}return null}},{key:"visitNull_notnull",value:function(e){return(0,c.getOriginalText)(e)}},{key:"visitForeign_key_options",value:function(e){var t=this,n=e.table_name().accept(this),i=b(n),r=i.schemaName,a=i.tableName,u=e.column_name_list().accept(this);return{refTableName:a,refSchemaName:r,onDelete:e.on_delete()?e.on_delete().map((function(e){return e.accept(t)}))[0]:null,onUpdate:e.on_update()?e.on_update().map((function(e){return e.accept(t)}))[0]:null,fieldNames:u}}},{key:"visitColumn_name_list",value:function(e){var t=this;return e.id_().map((function(e){return e.accept(t)}))}},{key:"visitOn_delete",value:function(e){return e.NO()?"NO ACTION":e.CASCADE()?"CASCADE":e.NULL_()?"SET NULL":"SET DEFAULT"}},{key:"visitOn_update",value:function(e){return e.NO()?"NO ACTION":e.CASCADE()?"CASCADE":e.NULL_()?"SET NULL":"SET DEFAULT"}},{key:"visitTable_constraint",value:function(e){var t=this,n=e.id_()?e.id_().map((function(e){return e.accept(t)}))[0]:"";if(e.PRIMARY()||e.UNIQUE()){var i=e.column_name_list_with_order().accept(this),r=new l.Index({name:n,columns:i});return e.PRIMARY()&&(r.pk=!0),e.UNIQUE()&&(r.unique=!0),{kind:e.PRIMARY()?o.TABLE_CONSTRAINT_KIND.PK:o.TABLE_CONSTRAINT_KIND.UNIQUE,value:r}}if(e.FOREIGN()){var a=e.column_name_list().accept(this),u=e.foreign_key_options().accept(this),c=u.refTableName,s=u.refSchemaName,f=u.fieldNames,p=u.onDelete,v=u.onUpdate;return{kind:o.TABLE_CONSTRAINT_KIND.FK,value:{name:n,endpoints:[{tableName:null,schemaName:null,fieldNames:a,relation:"*"},{tableName:c,schemaName:s,fieldNames:f,relation:"1"}],onDelete:p,onUpdate:v}}}if(e.DEFAULT()){var m=e.column.accept(this),d=e.expression().accept(this);return{kind:o.TABLE_CONSTRAINT_KIND.DEFAULT,value:{column:m,defaultValue:d}}}if(e.check_constraint()){var y=e.check_constraint().accept(this);return y.type!==N?null:{kind:o.TABLE_CONSTRAINT_KIND.CHECK,value:y.value}}return null}},{key:"visitColumn_name_list_with_order",value:function(e){var t=this;return e.id_().map((function(e){return{value:e.accept(t),type:"column"}}))}},{key:"visitTable_indices",value:function(e){var t=this;return new l.Index({name:e.id_().map((function(e){return e.accept(t)}))[0],unique:!!e.UNIQUE(),columns:e.column_name_list_with_order().accept(this)})}},{key:"visitAlter_table",value:function(e){var t,n,i,r,u=this,o=e.table_name()[0].accept(this),c=b(o),s=c.schemaName,f=c.tableName,p=this.data.tables.find((function(e){return e.name===f&&e.schemaName===s}));if(p){var v=e.column_def_table_constraints()?e.column_def_table_constraints().accept(this):[],d=O(v),y=d.fieldsData,h=d.indexes,_=d.tableRefs,N=d.columnDefaults,T=d.checkConstraints,E=I(y,f,s),k=E.inlineRefs,g=E.fields;(t=this.data.refs).push.apply(t,m((0,a.flatten)(k))),(n=this.data.refs).push.apply(n,m(_.map((function(e){return e.endpoints[0].tableName=f,e.endpoints[0].schemaName=s,e})))),(i=p.fields).push.apply(i,m(g)),(r=p.indexes).push.apply(r,m(h)),N.forEach((function(e){var t=p.fields.find((function(t){return t.name===e.column}));t&&(t.dbdefault=e.defaultValue)})),T.forEach((function(e){var t=p.fields.find((function(t){return t.name===e.column}));if(t){var n=new l.Enum({name:"".concat(f,"_").concat(t.name,"_enum"),values:e.columnValues.map((function(e){return{name:e}})),schemaName:s});u.data.enums.push(n),t.type.type_name=n.name,t.type.schemaName=n.schemaName}}))}}},{key:"visitCreate_index",value:function(e){var t=b(e.table_name().accept(this)),n=t.schemaName,i=t.tableName,r=this.data.tables.find((function(e){return e.name===i&&e.schemaName===n}));if(r){var a=new l.Index({name:e.id_()[0].accept(this),unique:!!e.UNIQUE(),columns:e.column_name_list_with_order().accept(this)});r.indexes.push(a)}}},{key:"visitAnother_statement",value:function(e){e.execute_statement()&&e.execute_statement().accept(this)}},{key:"visitExecute_statement",value:function(e){e.execute_body().accept(this)}},{key:"visitExecute_body",value:function(e){var t=e.func_proc_name_server_database_schema()?e.func_proc_name_server_database_schema().accept(this):[];if("sp_addextendedproperty"===(0,a.last)(t)&&e.execute_statement_arg()){var n=e.execute_statement_arg().accept(this).reduce((function(e,t){return e[t.name.slice(1)]=t.value,e}),{});if(!n.name.includes("Description"))return;if(!n.level0type.toLowerCase().includes("schema"))return;var i="dbo"!==n.level0name?n.level0name:void 0,r=n.level1type.toLowerCase().includes("table")?n.level1name:null,u=this.data.tables.find((function(e){return e.name===r&&e.schemaName===i}));if(!u)return;if(!n.level2type)return void(u.note={value:n.value});var o=n.level2type.toLowerCase().includes("column")?n.level2name:null,c=u.fields.find((function(e){return e.name===o}));if(!c)return;c.note={value:n.value}}}},{key:"visitFunc_proc_name_server_database_schema",value:function(e){var t=this;return e.func_proc_name_database_schema()?e.func_proc_name_database_schema().accept(this):e.id_().map((function(e){return e.accept(t)}))}},{key:"visitFunc_proc_name_database_schema",value:function(e){var t=this;return e.func_proc_name_schema()?e.func_proc_name_schema().accept(this):e.id_().map((function(e){return e.accept(t)}))}},{key:"visitFunc_proc_name_schema",value:function(e){var t=this;return e.id_().map((function(e){return e.accept(t)}))}},{key:"visitExecute_statement_arg",value:function(e){var t=this;return e.execute_statement_arg_unnamed()?e.execute_statement_arg_unnamed().map((function(e){return e.accept(t)})):e.execute_statement_arg_named().map((function(e){return e.accept(t)}))}},{key:"visitExecute_statement_arg_named",value:function(e){var t=e.execute_parameter().accept(this),n=t.value,i=t.type;return{name:e.LOCAL_ID().getText(),value:n,type:i}}},{key:"visitExecute_parameter",value:function(e){return e.constant()?e.constant().accept(this):e.getText()}},{key:"visitConstant",value:function(e){if(e.STRING()||e.BINARY()){var t=T(e.getText());return{value:t,type:t.startsWith("N'")?o.DATA_TYPE.EXPRESSION:o.DATA_TYPE.STRING}}return e.DOLLAR()?{value:e.getText(),type:o.DATA_TYPE.STRING}:e.REAL()||e.DECIMAL()||e.FLOAT()?{value:e.getText(),type:o.DATA_TYPE.NUMBER}:{value:(0,c.getOriginalText)(e),type:o.DATA_TYPE.EXPRESSION}}}])&&s(t.prototype,n),i&&s(t,i),Object.defineProperty(t,"prototype",{writable:!1}),u}(u.default);t.default=E},56082:function(e,t,n){function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,a=n(2543),u=(r=n(41935))&&r.__esModule?r:{default:r},o=n(62323),c=n(4950);function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t,n){return(t=h(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e){return function(e){if(Array.isArray(e))return d(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||m(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,a,u,o=[],c=!0,l=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(i=a.call(n)).done)&&(o.push(i.value),o.length!==t);c=!0);}catch(e){l=!0,r=e}finally{try{if(!c&&null!=n.return&&(u=n.return(),Object(u)!==u))return}finally{if(l)throw r}}return o}}(e,t)||m(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){if(e){if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function y(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,h(i.key),i)}}function h(e){var t=function(e,t){if("object"!==i(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===i(t)?t:String(t)}function _(e,t){return _=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},_(e,t)}function N(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=b(e);if(t){var a=b(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function b(e){return b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},b(e)}var T="note",O="add_pk",I="add_fk",E="type",k=function(e){return{tableName:(0,a.last)(e),schemaName:e.length>1?e[e.length-2]:void 0}},g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_(e,t)}(u,e);var t,n,i,r=N(u);function u(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(e=r.call(this)).data={schemas:[],tables:[],refs:[],enums:[],tableGroups:[],aliases:[],project:{},records:[]},e}return t=u,(n=[{key:"findTable",value:function(e,t){var n=e||"public";return this.data.tables.find((function(e){return(e.schemaName||"public")===n&&e.name===t}))}},{key:"visitRoot",value:function(e){var t;return null===(t=e.sqlStatements())||void 0===t||t.accept(this),this.data}},{key:"visitSqlStatements",value:function(e){var t=this;e.sqlStatement().forEach((function(e){e.accept(t)}))}},{key:"visitSqlStatement",value:function(e){e.ddlStatement()?e.ddlStatement().accept(this):e.dmlStatement()&&e.dmlStatement().accept(this)}},{key:"visitDdlStatement",value:function(e){var t=this;if(e.createTable()){var n,i,r=e.createTable().accept(this);if(!r)return;var u=r.tableName,l=r.schemaName,f=r.definitions,m=r.options,d=v(f.reduce((function(e,t){if(t.kind===c.TABLE_CONSTRAINT_KIND.FIELD)e[0].push(t.value);else if(t.kind===c.TABLE_CONSTRAINT_KIND.INDEX)e[1].push(t.value);else if(t.kind===c.TABLE_CONSTRAINT_KIND.UNIQUE)e[1].push(t.value);else if(t.kind===c.TABLE_CONSTRAINT_KIND.FK)e[2].push(t.value);else if(t.kind===c.TABLE_CONSTRAINT_KIND.PK){var n=t.value;n.columns.length>1?e[1].push(t.value):e[3]=n}return e}),[[],[],[],null]),4),y=d[0],h=d[1],_=d[2],N=d[3],b=y.map((function(e){var n,i=e.field,r=e.inlineRefs;if("enum"===(null===(n=i.type.type_name)||void 0===n?void 0:n.toLowerCase())){var a=i.type.args.map((function(e){return{name:e.replace(/'|"|`/g,"").trim()}})),c=new o.Enum({name:"".concat(u,"_").concat(i.name,"_enum"),schemaName:l,values:a});i.type.type_name=c.name,i.type.schemaName=c.schemaName,t.data.enums.push(c)}return r.forEach((function(e){e.endpoints[0].tableName=u,e.endpoints[0].schemaName=l,e.endpoints[0].fieldNames=[i.name]})),r}));(n=this.data.refs).push.apply(n,p((0,a.flatten)(b))),(i=this.data.refs).push.apply(i,p(_.map((function(e){return e.endpoints[0].tableName=u,e.endpoints[0].schemaName=l,e}))));var T=m.reduce((function(e,t){return e[t.kind]=t.value,e}),{}),O=new o.Table(s({name:u,schemaName:l,fields:y.map((function(e){return e.field})),indexes:h},T));if(N){var I=O.fields.find((function(e){return e.name===N.columns[0].value}));I&&(I.pk=!0)}this.data.tables.push(O.toJSON())}else e.alterTable()?e.alterTable().accept(this):e.createIndex()&&e.createIndex().accept(this)}},{key:"visitCopyCreateTable",value:function(){}},{key:"visitQueryCreateTable",value:function(e){var t,n=this,i=e.tableName().accept(this),r=k(i),a=r.tableName,u=r.schemaName;return e.createDefinitions()?{tableName:a,schemaName:u,definitions:e.createDefinitions().accept(this).filter((function(e){return null==e?void 0:e.kind})),options:(null===(t=e.tableOption())||void 0===t?void 0:t.map((function(e){return e.accept(n)})).filter((function(e){return null==e?void 0:e.kind})))||[]}:null}},{key:"visitColumnCreateTable",value:function(e){var t=this,n=e.tableName().accept(this),i=k(n);return{tableName:i.tableName,schemaName:i.schemaName,definitions:e.createDefinitions().accept(this).filter((function(e){return null==e?void 0:e.kind})),options:e.tableOption().map((function(e){return e.accept(t)})).filter((function(e){return null==e?void 0:e.kind}))}}},{key:"visitTableOptionComment",value:function(e){var t=e.STRING_LITERAL().getText();return{kind:T,value:{value:t.slice(1,t.length-1)}}}},{key:"visitTableName",value:function(e){return e.fullId().accept(this)}},{key:"visitFullId",value:function(e){var t=this,n=e.uid().map((function(e){return e.accept(t)}));if(e.DOT_ID()){var i=e.DOT_ID().getText();n.push(i.slice(1))}return n}},{key:"visitUid",value:function(e){if(e.simpleId())return e.simpleId().accept(this);var t=e.getChild(0).getText();return t.slice(1,t.length-1)}},{key:"visitSimpleId",value:function(e){return e.getChild(0).getText()}},{key:"visitCreateDefinitions",value:function(e){var t=this;return e.createDefinition().map((function(e){return e.accept(t)}))}},{key:"visitColumnDeclaration",value:function(e){var t=function(e){return{fieldName:(0,a.last)(e),tableName:e.length>1?e[e.length-2]:void 0,schemaName:e.length>2?e[e.length-3]:void 0}}(e.fullColumnName().accept(this)),n=t.fieldName,i=e.columnDefinition().accept(this),r=i.type,u=i.constraints,l=new o.Field(s({name:n,type:r},u));return{kind:c.TABLE_CONSTRAINT_KIND.FIELD,value:{field:l,inlineRefs:u.inlineRefs}}}},{key:"visitConstraintDeclaration",value:function(e){return e.tableConstraint().accept(this)}},{key:"visitIndexDeclaration",value:function(e){return e.indexColumnDefinition().accept(this)}},{key:"visitFullColumnName",value:function(e){var t=this,n=[];return e.uid()&&n.push(e.uid().accept(this)),n.push.apply(n,p(e.dottedId().map((function(e){return e.accept(t)})))),n}},{key:"visitDottedId",value:function(e){return e.DOT_ID()?e.DOT_ID().getText().slice(1):e.uid().accept(this)}},{key:"visitColumnDefinition",value:function(e){var t=this,n=e.dataType().accept(this),i={inlineRefs:[]};return e.columnConstraint().forEach((function(e){var n=e.accept(t);n&&(n.kind!==c.COLUMN_CONSTRAINT_KIND.INLINE_REF?i[n.kind]=n.value:i.inlineRefs.push(n.value))})),{type:n,constraints:i}}},{key:"visitStringDataType",value:function(e){var t=e.typeName.text;return e.lengthOneDimension()&&(t+=e.lengthOneDimension().getText()),{type_name:t,schemaName:null}}},{key:"visitNationalVaryingStringDataType",value:function(e){var t=e.typeName.text;return e.lengthOneDimension()&&(t+=e.lengthOneDimension().getText()),{type_name:t,schemaName:null}}},{key:"visitNationalStringDataType",value:function(e){var t=e.typeName.text;return e.lengthOneDimension()&&(t+=e.lengthOneDimension().getText()),{type_name:t,schemaName:null}}},{key:"visitDimensionDataType",value:function(e){var t=e.typeName.text;return e.lengthOneDimension()&&(t+=e.lengthOneDimension().getText()),e.lengthTwoDimension()&&(t+=e.lengthTwoDimension().getText()),e.lengthTwoOptionalDimension()&&(t+=e.lengthTwoOptionalDimension().getText()),{type_name:t,schemaName:null}}},{key:"visitSimpleDataType",value:function(e){return{type_name:e.typeName.text,schemaName:null}}},{key:"visitCollectionDataType",value:function(e){return e.SET()?{type_name:e.typeName.text+e.collectionOptions().getText(),schemaName:null}:{type_name:e.typeName.text,args:e.collectionOptions().accept(this),schemaName:null}}},{key:"visitCollectionOptions",value:function(e){return e.STRING_LITERAL().map((function(e){return e.getText()}))}},{key:"visitSpatialDataType",value:function(e){return{type_name:e.typeName.text,schemaName:null}}},{key:"visitLongVarcharDataType",value:function(e){return{type_name:e.typeName.text,schemaName:null}}},{key:"visitLongVarbinaryDataType",value:function(e){return{type_name:"".concat(e.LONG().getText()," ").concat(e.VARBINARY().getText()),schemaName:null}}},{key:"visitNullColumnConstraint",value:function(e){return e.nullNotnull().accept(this)}},{key:"visitNullNotnull",value:function(e){var t=!1;return e.NOT()&&(t=!0),{kind:c.COLUMN_CONSTRAINT_KIND.NOT_NULL,value:t}}},{key:"visitDefaultColumnConstraint",value:function(e){return{kind:c.COLUMN_CONSTRAINT_KIND.DEFAULT,value:e.defaultValue().accept(this)}}},{key:"visitAutoIncrementColumnConstraint",value:function(e){return e.AUTO_INCREMENT()?{kind:c.COLUMN_CONSTRAINT_KIND.INCREMENT,value:!0}:null}},{key:"visitPrimaryKeyColumnConstraint",value:function(e){return e.PRIMARY()?{kind:c.COLUMN_CONSTRAINT_KIND.PK,value:!0}:null}},{key:"visitUniqueKeyColumnConstraint",value:function(){return{kind:c.COLUMN_CONSTRAINT_KIND.UNIQUE,value:!0}}},{key:"visitCommentColumnConstraint",value:function(e){var t=e.STRING_LITERAL().getText();return{kind:c.COLUMN_CONSTRAINT_KIND.NOTE,value:{value:t.slice(1,t.length-1)}}}},{key:"visitReferenceColumnConstraint",value:function(e){var t=e.referenceDefinition().accept(this);return{kind:c.COLUMN_CONSTRAINT_KIND.INLINE_REF,value:t}}},{key:"visitDefaultValue",value:function(e){var t;if(e.NULL_LITERAL())return{value:e.NULL_LITERAL().getText(),type:c.DATA_TYPE.BOOLEAN};if(e.expression())return{value:e.expression().getText(),type:c.DATA_TYPE.EXPRESSION};if(e.constant()){if(e.unaryOperator())return{value:e.getText(),type:c.DATA_TYPE.EXPRESSION};var n=e.constant().accept(this);return{value:n.value,type:n.type}}return null!==(t=e.currentTimestamp())&&void 0!==t&&t.length?{value:e.currentTimestamp()[0].getText(),type:c.DATA_TYPE.EXPRESSION}:{value:e.getText(),type:c.DATA_TYPE.EXPRESSION}}},{key:"visitConstant",value:function(e){if(e.stringLiteral()){var t=e.stringLiteral().getText();return{value:t.slice(1,t.length-1),type:c.DATA_TYPE.STRING}}return e.decimalLiteral()?e.getChildCount()>1?{value:e.getText(),type:c.DATA_TYPE.EXPRESSION}:{value:e.decimalLiteral().getText(),type:c.DATA_TYPE.NUMBER}:e.hexadecimalLiteral()?{value:e.hexadecimalLiteral().getText(),type:c.DATA_TYPE.NUMBER}:e.booleanLiteral()?{value:e.booleanLiteral().getText(),type:c.DATA_TYPE.BOOLEAN}:e.REAL_LITERAL()?{value:e.REAL_LITERAL().getText(),type:c.DATA_TYPE.NUMBER}:e.BIT_STRING()?{value:e.BIT_STRING().getText(),type:c.DATA_TYPE.STRING}:{value:e.getText(),type:c.DATA_TYPE.STRING}}},{key:"visitReferenceDefinition",value:function(e){var t,n=e.tableName().accept(this),i=k(n),r=i.tableName,a=i.schemaName;if(!e.indexColumnNames())return null;var u=(null===(t=e.referenceAction())||void 0===t?void 0:t.accept(this))||{},c=e.indexColumnNames().accept(this).map((function(e){return e.value})),l=new o.Endpoint({tableName:null,schemaName:null,fieldNames:null,relation:"*"}),s=new o.Endpoint({tableName:r,schemaName:a,fieldNames:c,relation:"1"});return new o.Ref({endpoints:[l,s],onUpdate:u.onUpdate,onDelete:u.onDelete})}},{key:"visitIndexColumnNames",value:function(e){var t=this;return e.indexColumnName().map((function(e){return e.accept(t)}))}},{key:"visitIndexColumnName",value:function(e){if(e.uid())return{type:c.CONSTRAINT_TYPE.COLUMN,value:e.uid().accept(this)};if(e.STRING_LITERAL()){var t=e.STRING_LITERAL().getText();return{type:c.CONSTRAINT_TYPE.STRING,value:t.slice(1,t.length-1)}}return{type:c.CONSTRAINT_TYPE.EXPRESSION,value:e.expression().getText()}}},{key:"visitReferenceAction",value:function(e){var t,n,i={};return i.onDelete=null===(t=e.onDelete)||void 0===t?void 0:t.accept(this),i.onUpdate=null===(n=e.onUpdate)||void 0===n?void 0:n.accept(this),i}},{key:"visitReferenceControlType",value:function(e){var t=p(Array(e.getChildCount()).keys()).reduce((function(t,n){return"".concat(t).concat(e.getChild(n).getText()," ")}),"");return t.slice(0,t.length-1)}},{key:"visitPrimaryKeyTableConstraint",value:function(e){var t,n,i,r,a=this,u=(null===(t=e.name)||void 0===t?void 0:t.accept(this))||(null===(n=e.index)||void 0===n?void 0:n.accept(this)),l=null===(i=e.indexType())||void 0===i?void 0:i.accept(this);if(null!==(r=e.indexOption())&&void 0!==r&&r.length){var s=e.indexOption().map((function(e){return e.accept(a)})).find((function(e){return(null==e?void 0:e.kind)===E}));s&&(l=s.value)}var f=e.indexColumnNames().accept(this);return{kind:c.TABLE_CONSTRAINT_KIND.PK,value:new o.Index({name:u,pk:!0,columns:f,type:l})}}},{key:"visitUniqueKeyTableConstraint",value:function(e){var t,n,i,r,a=this,u=(null===(t=e.name)||void 0===t?void 0:t.accept(this))||(null===(n=e.index)||void 0===n?void 0:n.accept(this)),l=null===(i=e.indexType())||void 0===i?void 0:i.accept(this);if(null!==(r=e.indexOption())&&void 0!==r&&r.length){var s=e.indexOption().map((function(e){return e.accept(a)})).find((function(e){return(null==e?void 0:e.kind)===E}));s&&(l=s.value)}var f=e.indexColumnNames().accept(this);return{kind:c.TABLE_CONSTRAINT_KIND.UNIQUE,value:new o.Index({name:u,unique:!0,columns:f,type:l})}}},{key:"visitForeignKeyTableConstraint",value:function(e){var t,n,i=e.referenceDefinition().accept(this);return i.name=(null===(t=e.name)||void 0===t?void 0:t.accept(this))||(null===(n=e.index)||void 0===n?void 0:n.accept(this)),i.endpoints[0].fieldNames=e.indexColumnNames().accept(this).map((function(e){return e.value})),{kind:c.TABLE_CONSTRAINT_KIND.FK,value:i}}},{key:"visitCheckTableConstraint",value:function(){}},{key:"visitIndexType",value:function(e){return e.getChild(1).getText()}},{key:"visitIndexOption",value:function(e){return e.indexType()?{kind:E,value:e.indexType().accept(this)}:null}},{key:"visitSimpleIndexDeclaration",value:function(e){var t,n,i,r=this,a=null===(t=e.uid())||void 0===t?void 0:t.accept(this),u=null===(n=e.indexType())||void 0===n?void 0:n.accept(this);if(null!==(i=e.indexOption())&&void 0!==i&&i.length){var l=e.indexOption().map((function(e){return e.accept(r)})).find((function(e){return(null==e?void 0:e.kind)===E}));l&&(u=l.value)}var s=e.indexColumnNames().accept(this);return{kind:c.TABLE_CONSTRAINT_KIND.INDEX,value:new o.Index({name:a,columns:s,type:u})}}},{key:"visitSpecialIndexDeclaration",value:function(e){var t,n,i=this,r=null===(t=e.uid())||void 0===t?void 0:t.accept(this),a=null;if(null!==(n=e.indexOption())&&void 0!==n&&n.length){var u=e.indexOption().map((function(e){return e.accept(i)})).find((function(e){return(null==e?void 0:e.kind)===E}));u&&(a=u.value)}var l=e.indexColumnNames().accept(this);return{kind:c.TABLE_CONSTRAINT_KIND.INDEX,value:new o.Index({name:r,columns:l,type:a})}}},{key:"visitAlterTable",value:function(e){var t,n=this,i=e.tableName().accept(this),r=k(i),a=r.tableName,u=r.schemaName,o=this.findTable(u,a);o&&((null===(t=e.alterSpecification())||void 0===t?void 0:t.map((function(e){return e.accept(n)})).filter((function(e){return null==e?void 0:e.kind})))||[]).forEach((function(e){if(e.kind===O){var t=e.value;if(t.columns.length>1)return o.indexes.push(t);o.fields.find((function(e){return e.name===t.columns[0].value})).pk=!0}else if(e.kind===I){var i=e.value;i.endpoints[0].schemaName=u,i.endpoints[0].tableName=a,n.data.refs.push(i)}return null}))}},{key:"visitAlterByAddPrimaryKey",value:function(e){var t,n,i,r,a=this,u=(null===(t=e.name)||void 0===t?void 0:t.accept(this))||(null===(n=e.index)||void 0===n?void 0:n.accept(this)),c=null===(i=e.indexType())||void 0===i?void 0:i.accept(this);if(null!==(r=e.indexOption())&&void 0!==r&&r.length){var l=e.indexOption().map((function(e){return e.accept(a)})).find((function(e){return(null==e?void 0:e.kind)===E}));l&&(c=l.value)}var s=e.indexColumnNames().accept(this);return{kind:O,value:new o.Index({name:u,pk:!0,columns:s,type:c})}}},{key:"visitAlterByAddForeignKey",value:function(e){var t,n,i=e.referenceDefinition().accept(this);return i.name=(null===(t=e.name)||void 0===t?void 0:t.accept(this))||(null===(n=e.index)||void 0===n?void 0:n.accept(this)),i.endpoints[0].fieldNames=e.indexColumnNames().accept(this).map((function(e){return e.value})),{kind:I,value:i}}},{key:"visitCreateIndex",value:function(e){var t,n,i=this,r=e.tableName().accept(this),a=k(r),u=a.tableName,c=a.schemaName,l=this.findTable(c,u);if(l){var s=e.uid().accept(this),f=null===(t=e.indexType())||void 0===t?void 0:t.accept(this);if(null!==(n=e.indexOption())&&void 0!==n&&n.length){var p=e.indexOption().map((function(e){return e.accept(i)})).find((function(e){return(null==e?void 0:e.kind)===E}));p&&(f=p.value)}var v=e.indexColumnNames().accept(this),m=new o.Index({name:s,columns:v,unique:!!e.UNIQUE(),type:f});l.indexes.push(m)}}},{key:"visitDmlStatement",value:function(e){e.insertStatement()&&e.insertStatement().accept(this)}},{key:"visitInsertStatement",value:function(e){var t=e.tableName().accept(this),n=(0,a.last)(t),i=t.length>1?t[t.length-2]:void 0,r=e.fullColumnNameList()?e.fullColumnNameList().accept(this):[],u=e.insertStatementValue().accept(this),c=new o.TableRecord({schemaName:i,tableName:n,columns:r,values:u});this.data.records.push(c)}},{key:"visitFullColumnNameList",value:function(e){var t=this,n=e.fullColumnName().map((function(e){return e.accept(t)}));return(0,a.flattenDepth)(n,1)}},{key:"visitInsertStatementValue",value:function(e){var t=this;return e.expressionsWithDefaults().map((function(e){var n=e.accept(t);return(0,a.flattenDepth)(n,1)}))}},{key:"visitExpressionsWithDefaults",value:function(e){var t=this;return e.expressionOrDefault().map((function(e){var n=e.accept(t);return(0,a.flattenDepth)(n,3)}))}},{key:"visitFunctionCallExpressionAtom",value:function(e){return{value:e.getText(),type:c.DATA_TYPE.EXPRESSION}}}])&&y(t.prototype,n),i&&y(t,i),Object.defineProperty(t,"prototype",{writable:!1}),u}(u.default);t.default=g},7866:function(e,t,n){function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}var r;function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(a=r.key,u=void 0,u=function(e,t){if("object"!==i(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(a,"string"),"symbol"===i(u)?u:String(u)),r)}var a,u}function u(e,t){return u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},u(e,t)}function o(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=c(e);if(t){var a=c(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function c(e){return c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},c(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.HandleLessLessGreaterGreater=function(){},t.charIsLetter=function(){},t.checkLA=function(){},t.default=void 0,t.isTag=function(){},t.pushTag=function(){};var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(c,e);var t,n,i,r=o(c);function c(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),r.apply(this,arguments)}return t=c,n&&a(t.prototype,n),i&&a(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}(((r=n(36168))&&r.__esModule?r:{default:r}).default.Lexer);t.default=l},93503:function(e,t,n){function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}var r;function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(a=r.key,u=void 0,u=function(e,t){if("object"!==i(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(a,"string"),"symbol"===i(u)?u:String(u)),r)}var a,u}function u(e,t){return u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},u(e,t)}function o(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=c(e);if(t){var a=c(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function c(e){return c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},c(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.ParseRoutineBody=function(){},t.default=void 0;var l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(c,e);var t,n,i,r=o(c);function c(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),r.apply(this,arguments)}return t=c,n&&a(t.prototype,n),i&&a(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}(((r=n(36168))&&r.__esModule?r:{default:r}).default.Parser);t.default=l},79566:function(e,t,n){function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,a=n(2543),u=(r=n(8385))&&r.__esModule?r:{default:r},o=n(62323),c=n(4950);function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t,n){return(t=h(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e){return function(e){if(Array.isArray(e))return d(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||m(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,a,u,o=[],c=!0,l=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(i=a.call(n)).done)&&(o.push(i.value),o.length!==t);c=!0);}catch(e){l=!0,r=e}finally{try{if(!c&&null!=n.return&&(u=n.return(),Object(u)!==u))return}finally{if(l)throw r}}return o}}(e,t)||m(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){if(e){if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function y(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,h(i.key),i)}}function h(e){var t=function(e,t){if("object"!==i(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===i(t)?t:String(t)}function _(e,t){return _=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},_(e,t)}function N(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=b(e);if(t){var a=b(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function b(e){return b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},b(e)}var T="ref",O="table",I=function(e,t,n){var i=t||"public";return e.find((function(e){return(e.schemaName||"public")===i&&e.name===n}))},E=function(e){return e?e.replaceAll("''","'"):e},k=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_(e,t)}(u,e);var t,n,i,r=N(u);function u(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(e=r.call(this)).data={schemas:[],tables:[],refs:[],enums:[],tableGroups:[],aliases:[],project:{},records:[]},e}return t=u,(n=[{key:"visitRoot",value:function(e){return e.stmtblock().accept(this),this.data}},{key:"visitStmtblock",value:function(e){e.stmtmulti().accept(this)}},{key:"visitStmtmulti",value:function(e){var t=this;e.stmt().map((function(e){return e.accept(t)}))}},{key:"visitStmt",value:function(e){if(e.createstmt()){var t=e.createstmt().accept(this);t&&this.data.tables.push(t)}else if(e.indexstmt()){var n=e.indexstmt().accept(this),i=n.pathName,r=i.tableName,a=i.schemaName,u=I(this.data.tables,a,r);u&&u.indexes.push(n.index)}else e.altertablestmt()?e.altertablestmt().accept(this):e.commentstmt()?e.commentstmt().accept(this):e.definestmt()?e.definestmt().accept(this):e.insertstmt()&&e.insertstmt().accept(this)}},{key:"visitCreatestmt",value:function(e){var t,n,i=e.qualified_name(0).accept(this),r=(0,a.last)(i),u=i.length>1?i[i.length-2]:void 0;if(e.opttableelementlist()){var l=v(e.opttableelementlist().accept(this).filter((function(e){return e})).reduce((function(e,t){return t.kind===c.TABLE_CONSTRAINT_KIND.FIELD?e[0].push(t.value):t.kind===c.TABLE_CONSTRAINT_KIND.INDEX?e[1].push(t.value):t.kind===c.TABLE_CONSTRAINT_KIND.FK?e[2].push(t.value):t.kind===c.TABLE_CONSTRAINT_KIND.UNIQUE&&e[1].push(t.value),e}),[[],[],[]]),3),s=l[0],f=l[1],m=l[2];return(t=this.data.refs).push.apply(t,p((0,a.flatten)(s.map((function(e){return e.inline_refs.map((function(t){return t.endpoints[0].tableName=r,t.endpoints[0].schemaName=u,t.endpoints[0].fieldNames=[e.field.name],t}))}))))),(n=this.data.refs).push.apply(n,p(m.map((function(e){return e.endpoints[0].tableName=r,e.endpoints[0].schemaName=u,e})))),new o.Table({name:r,schemaName:u,fields:s.map((function(e){return e.field})),indexes:f})}}},{key:"visitOpttableelementlist",value:function(e){return e.tableelementlist()?e.tableelementlist().accept(this):[]}},{key:"visitTableelementlist",value:function(e){var t=this;return e.tableelement().map((function(e){return e.accept(t)}))}},{key:"visitTableelement",value:function(e){return e.columnDef()?e.columnDef().accept(this):e.tableconstraint()?e.tableconstraint().accept(this):void 0}},{key:"visitTableconstraint",value:function(e){var t,n=null===(t=e.name())||void 0===t?void 0:t.accept(this),i=e.constraintelem().accept(this);if(i)return i.value.name=n,i}},{key:"visitConstraintelem",value:function(e){if(e.PRIMARY())return{kind:c.TABLE_CONSTRAINT_KIND.INDEX,value:new o.Index({pk:!0,columns:e.columnlist().accept(this)})};if(e.FOREIGN()){var t,n=e.qualified_name().accept(this),i=(0,a.last)(n),r=n.length>1?n[n.length-2]:void 0,u=e.columnlist().accept(this).map((function(e){return e.value})),l=null===(t=e.opt_column_list().accept(this))||void 0===t?void 0:t.map((function(e){return e.value})),s=e.key_actions().accept(this);return{kind:c.TABLE_CONSTRAINT_KIND.FK,value:{endpoints:[{tableName:null,schemaName:null,fieldNames:u,relation:"*"},{tableName:i,schemaName:r,fieldNames:l,relation:"1"}],onDelete:s.onDelete,onUpdate:s.onUpdate}}}return e.UNIQUE()?{kind:c.TABLE_CONSTRAINT_KIND.UNIQUE,value:new o.Index({unique:!0,columns:e.columnlist().accept(this)})}:void 0}},{key:"visitOpt_column_list",value:function(e){var t;return null===(t=e.columnlist())||void 0===t?void 0:t.accept(this)}},{key:"visitColumnlist",value:function(e){var t=this;return e.columnElem().map((function(e){return e.accept(t)}))}},{key:"visitColumnElem",value:function(e){return{value:e.colid().accept(this),type:c.CONSTRAINT_TYPE.COLUMN}}},{key:"visitColumnDef",value:function(e){var t=e.colid().accept(this),n=e.typename().accept(this),i=e.colquallist().accept(this),r=new Set(["serial","smallserial","bigserial"]),a=n.type_name.toLowerCase();return r.has(a)&&(i.increment=!0),{kind:c.TABLE_CONSTRAINT_KIND.FIELD,value:{field:new o.Field(s({name:t,type:n},i)),inline_refs:i.inline_refs}}}},{key:"visitColquallist",value:function(e){var t=this,n={inline_refs:[]};return e.colconstraint().forEach((function(e){var i=e.accept(t);i&&(i.kind!==c.COLUMN_CONSTRAINT_KIND.INLINE_REF?n[i.kind]=i.value:n.inline_refs.push(i.value))})),n}},{key:"visitColconstraint",value:function(e){if(e.colconstraintelem())return e.colconstraintelem().accept(this)}},{key:"visitColconstraintelem",value:function(e){if(e.NULL_P()){var t=!1;return e.NOT()&&(t=!0),{kind:c.COLUMN_CONSTRAINT_KIND.NOT_NULL,value:t}}if(e.UNIQUE())return{kind:c.COLUMN_CONSTRAINT_KIND.UNIQUE,value:!0};if(e.PRIMARY())return{kind:c.COLUMN_CONSTRAINT_KIND.PK,value:!0};if(e.DEFAULT())return{kind:c.COLUMN_CONSTRAINT_KIND.DEFAULT,value:e.b_expr().accept(this)};if(e.IDENTITY_P())return{kind:c.COLUMN_CONSTRAINT_KIND.INCREMENT,value:!0};if(e.REFERENCES()){var n,i=e.qualified_name().accept(this),r=(0,a.last)(i),u=i.length>1?i[i.length-2]:void 0,o=null===(n=e.opt_column_list().accept(this))||void 0===n?void 0:n.map((function(e){return e.value})),l=e.key_actions().accept(this);return{kind:c.COLUMN_CONSTRAINT_KIND.INLINE_REF,value:{endpoints:[{tableName:null,schemaName:null,fieldNames:null,relation:"*"},{tableName:r,schemaName:u,fieldNames:o,relation:"1"}],onDelete:l.onDelete,onUpdate:l.onUpdate}}}}},{key:"visitB_expr",value:function(e){return e.c_expr()?e.c_expr().accept(this):{value:e.getText(),type:c.DATA_TYPE.EXPRESSION}}},{key:"visitC_expr_expr",value:function(e){return e.aexprconst()?e.aexprconst().accept(this):e.a_expr()?{value:e.a_expr().getText(),type:c.DATA_TYPE.EXPRESSION}:{value:e.getText(),type:c.DATA_TYPE.EXPRESSION}}},{key:"visitC_expr_exists",value:function(e){return{value:e.getText(),type:c.DATA_TYPE.EXPRESSION}}},{key:"visitC_expr_case",value:function(e){return{value:e.getText(),type:c.DATA_TYPE.EXPRESSION}}},{key:"visitAexprconst",value:function(e){return e.sconst()&&1===e.getChildCount()?{value:e.sconst().accept(this),type:c.DATA_TYPE.STRING}:e.TRUE_P()||e.FALSE_P()||e.NULL_P()?{value:e.getText(),type:c.DATA_TYPE.BOOLEAN}:e.iconst()||e.fconst?{value:e.getText(),type:c.DATA_TYPE.NUMBER}:{value:e.getText(),type:c.DATA_TYPE.EXPRESSION}}},{key:"visitKey_actions",value:function(e){var t=null,n=null;return e.key_update()&&(n=e.key_update().accept(this)),e.key_delete()&&(t=e.key_delete().accept(this)),{onDelete:t,onUpdate:n}}},{key:"visitKey_update",value:function(e){return e.key_action().accept(this)}},{key:"visitKey_delete",value:function(e){return e.key_action().accept(this)}},{key:"visitKey_action",value:function(e){var t=p(Array(e.getChildCount()).keys()).reduce((function(t,n){return t+="".concat(e.getChild(n).getText()," ")}),"");return t.slice(0,t.length-1)}},{key:"visitQualified_name",value:function(e){var t=[e.colid().accept(this)];return e.indirection()&&t.push.apply(t,p(e.indirection().accept(this))),t}},{key:"visitColid",value:function(e){return e.getChild(0).accept(this)}},{key:"visitUnreserved_keyword",value:function(e){return e.getText()}},{key:"visitIdentifier",value:function(e){if(e.Identifier())return e.Identifier().getText();if(e.QuotedIdentifier()){var t=e.QuotedIdentifier().getText();return t.slice(1,t.length-1)}if(e.UnicodeQuotedIdentifier()){var n=e.UnicodeQuotedIdentifier().getText();return n.slice(1,n.length-1)}return e.plsql_unreserved_keyword()?e.plsql_unreserved_keyword().accept(this):e.getChild(0).getText()}},{key:"visitCol_name_keyword",value:function(e){return e.getChild(0).getText()}},{key:"visitPlsql_unreserved_keyword",value:function(e){return e.getChild(0).getText()}},{key:"visitIndirection",value:function(e){var t=this;return e.indirection_el().map((function(e){return e.accept(t)}))}},{key:"visitIndirection_el",value:function(e){if(e.attr_name())return e.attr_name().accept(this)}},{key:"visitAttr_name",value:function(e){return e.collabel().accept(this)}},{key:"visitCollabel",value:function(e){return e.getChild(0).accept(this)}},{key:"visitReserved_keyword",value:function(e){return e.getText()}},{key:"visitTypename",value:function(e){if(e.simpletypename()){var t="",n=e.simpletypename().accept(this);return e.opt_array_bounds()&&(t=e.opt_array_bounds().accept(this)),e.ARRAY()&&(t="[".concat(e.iconst()?e.iconst().accept(this):"","]")),{type_name:n.type+t,schemaName:n.schemaName}}}},{key:"visitSimpletypename",value:function(e){return e.generictype()?e.generictype().accept(this):e.character()?{type:e.character().accept(this),schemaName:null}:e.numeric()?{type:e.numeric().accept(this),schemaName:null}:e.constdatetime()?{type:e.constdatetime().accept(this),schemaName:null}:{type:e.getText(),schemaName:null}}},{key:"visitConstdatetime",value:function(e){return"".concat(e.getChild(0).getText()).concat(e.iconst()?"(".concat(e.iconst().accept(this),")"):"")}},{key:"visitNumeric",value:function(e){return e.getText()}},{key:"visitGenerictype",value:function(e){if(e.attrs()){var t=[e.getChild(0).getText()].concat(p(e.attrs().accept(this)));return{type:(0,a.last)(t),schemaName:t.length>1?t[t.length-2]:void 0}}return{type:(e.type_function_name()?e.type_function_name().accept(this):e.getText())+e.opt_type_modifiers().getText(),schemaName:null}}},{key:"visitCharacter",value:function(e){var t=e.character_c().accept(this);return e.getChildCount()>1&&(t+="(".concat(e.iconst().accept(this),")")),t}},{key:"visitCharacter_c",value:function(e){var t=p(Array(e.getChildCount()).keys()).reduce((function(t,n){return t+="".concat(e.getChild(n).getText()," ")}),"");return t.slice(0,t.length-1)}},{key:"visitType_function_name",value:function(e){return e.getChild(0).accept(this)}},{key:"visitType_func_name_keyword",value:function(e){return e.getText()}},{key:"visitOpt_array_bounds",value:function(e){return e.getText()}},{key:"visitIconst",value:function(e){return e.Integral().getText()}},{key:"visitIndexstmt",value:function(e){var t=e.relation_expr().accept(this),n=(0,a.last)(t),i=t.length>1?t[t.length-2]:void 0;if(e.opt_index_name())return{pathName:{tableName:n,schemaName:i},index:new o.Index({name:e.opt_index_name().accept(this),unique:e.opt_unique().accept(this),type:e.access_method_clause().accept(this),columns:e.index_params().accept(this)})}}},{key:"visitOpt_index_name",value:function(e){var t;return null===(t=e.name())||void 0===t?void 0:t.accept(this)}},{key:"visitName",value:function(e){return e.colid().accept(this)}},{key:"visitAccess_method_clause",value:function(e){if(e.name())return e.name().accept(this)}},{key:"visitRelation_expr",value:function(e){return e.qualified_name().accept(this)}},{key:"visitIndex_params",value:function(e){var t=this;return e.index_elem().map((function(e){return e.accept(t)})).filter((function(e){return!!e}))}},{key:"visitIndex_elem",value:function(e){return e.colid()?{value:e.colid().accept(this),type:c.CONSTRAINT_TYPE.STRING}:{value:e.getText(),type:c.CONSTRAINT_TYPE.EXPRESSION}}},{key:"visitOpt_unique",value:function(e){return!!e.UNIQUE()}},{key:"visitAltertablestmt",value:function(e){var t=this;if(e.TABLE()&&e.relation_expr()&&e.alter_table_cmds()){var n=e.relation_expr().accept(this),i=(0,a.last)(n),r=n.length>1?n[n.length-2]:void 0;return e.alter_table_cmds().accept(this).map((function(e){if(!e)return null;var n=null;switch(e.kind){case c.TABLE_CONSTRAINT_KIND.FK:n=T,e.value.endpoints[0].tableName=i,e.value.endpoints[0].schemaName=r,t.data.refs.push(e.value);break;case c.TABLE_CONSTRAINT_KIND.UNIQUE:case c.TABLE_CONSTRAINT_KIND.PK:case c.TABLE_CONSTRAINT_KIND.INDEX:if(0===e.value.columns.length)break;if(!e.value.pk&&!e.value.unique)break;n=e.kind;var a=I(t.data.tables,r,i);if(!a)break;if(1===e.value.columns.length&&(e.value.unique||e.value.pk)){var u=e.value.columns[0].value,l=a.fields.find((function(e){return e.name===u}));if(l){l[e.value.unique?"unique":"pk"]=!0;break}}var s=new o.Index({name:e.value.name,columns:e.value.columns,note:e.value.note,pk:e.value.pk,type:e.value.type,unique:e.value.unique});a.indexes.push(s)}return{kind:n,value:e.value}})).filter((function(e){return e}))}}},{key:"visitAlter_table_cmds",value:function(e){var t=this;return e.alter_table_cmd().map((function(e){return e.accept(t)}))}},{key:"visitAlter_table_cmd",value:function(e){if(e.tableconstraint())return e.tableconstraint().accept(this)}},{key:"visitCommentstmt",value:function(e){if(e.object_type_any_name()){var t=e.object_type_any_name().accept(this);if(!t)return;if(t===O){var n=e.any_name().accept(this),i=(0,a.last)(n),r=n.length>1?n[n.length-2]:void 0,u=I(this.data.tables,r,i);if(!u)return;var o=e.comment_text().accept(this);u.note={value:E(o)}}}if(e.COLUMN()){var c=e.any_name().accept(this),l=(0,a.last)(c),s=c.length>1?c[c.length-2]:void 0,f=c.length>2?c[c.length-3]:void 0,p=I(this.data.tables,f,s).fields.find((function(e){return e.name===l}));if(!p)return;var v=e.comment_text().accept(this);p.note={value:E(v)}}}},{key:"visitComment_text",value:function(e){return e.NULL_P()?null:e.sconst().accept(this)}},{key:"visitSconst",value:function(e){return e.anysconst().accept(this)}},{key:"visitAnysconst",value:function(e){var t=e.getChild(0).getText();return t.slice(1,t.length-1)}},{key:"visitObject_type_any_name",value:function(e){if(e.TABLE())return O}},{key:"visitAny_name",value:function(e){var t=[e.colid().accept(this)];return e.attrs()&&t.push.apply(t,p(e.attrs().accept(this))),t}},{key:"visitAttrs",value:function(e){var t=this;return e.attr_name().map((function(e){return e.accept(t)}))}},{key:"visitDefinestmt",value:function(e){if(e.TYPE_P()&&e.opt_enum_val_list()){var t=e.any_name(0).accept(this),n=(0,a.last)(t),i=t.length>1?t[t.length-2]:void 0,r=e.opt_enum_val_list().accept(this).map((function(e){return{name:e}}));if(!r)return;var u=new o.Enum({name:n,schemaName:i,values:r});this.data.enums.push(u.toJSON())}}},{key:"visitOpt_enum_val_list",value:function(e){var t;return null===(t=e.enum_val_list())||void 0===t?void 0:t.accept(this)}},{key:"visitEnum_val_list",value:function(e){var t=this;return e.sconst().map((function(e){return e.accept(t)}))}},{key:"visitInsertstmt",value:function(e){var t=e.insert_target().accept(this),n=(0,a.last)(t),i=t.length>1?t[t.length-2]:void 0,r=e.insert_rest().accept(this),u=r.columns,c=r.values,l=new o.TableRecord({schemaName:i,tableName:n,columns:u,values:c});this.data.records.push(l)}},{key:"visitInsert_target",value:function(e){return e.qualified_name().accept(this)}},{key:"visitInsert_rest",value:function(e){return{columns:e.insert_column_list()?e.insert_column_list().accept(this):[],values:(e.selectstmt().accept(this)||[]).filter((function(e){return Array.isArray(e)})).map((function(e){return e.filter((function(e){return e})).map((function(e){return{value:e.value,type:e.type}}))}))}}},{key:"visitInsert_column_list",value:function(e){var t=this;return e.insert_column_item().map((function(e){return e.accept(t)}))}},{key:"visitInsert_column_item",value:function(e){return e.colid().accept(this)}},{key:"visitSelectstmt",value:function(e){return e.select_no_parens()?e.select_no_parens().accept(this):null}},{key:"visitSelect_no_parens",value:function(e){return e.select_clause().accept(this)}},{key:"visitSelect_clause",value:function(e){return e.simple_select().accept(this)}},{key:"visitSimple_select",value:function(e){return e.values_clause()?e.values_clause().accept(this):null}},{key:"visitValues_clause",value:function(e){var t=this;return e.expr_list().map((function(e){var n=e.accept(t);return(0,a.flattenDepth)(n,21)}))}},{key:"visitA_expr_collate",value:function(e){var t=v(e.a_expr_typecast().accept(this),3),n=t[0],i=(t[1],t[2]),r=void 0===i?{}:i;return s({value:n.value,type:n.type},r)}}])&&y(t.prototype,n),i&&y(t,i),Object.defineProperty(t,"prototype",{writable:!1}),u}(u.default);t.default=k},90282:function(e,t,n){function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,a=n(2543),u=(r=n(65743))&&r.__esModule?r:{default:r},o=n(62323),c=n(4950),l=n(13778);function s(e){return function(e){if(Array.isArray(e))return v(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||p(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,a,u,o=[],c=!0,l=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(i=a.call(n)).done)&&(o.push(i.value),o.length!==t);c=!0);}catch(e){l=!0,r=e}finally{try{if(!c&&null!=n.return&&(u=n.return(),Object(u)!==u))return}finally{if(l)throw r}}return o}}(e,t)||p(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){if(e){if("string"==typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?v(e,t):void 0}}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(a=r.key,u=void 0,u=function(e,t){if("object"!==i(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(a,"string"),"symbol"===i(u)?u:String(u)),r)}var a,u}function d(e,t){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},d(e,t)}function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h(e);if(t){var a=h(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}var _=function(e){return(0,l.getOriginalText)(e).replace(/''/g,"'").slice(1,-1)},N=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}(u,e);var t,n,i,r=y(u);function u(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(e=r.call(this)).data={schemas:[],tables:[],refs:[],enums:[],tableGroups:[],aliases:[],project:{}},e}return t=u,(n=[{key:"visitSnowflake_file",value:function(e){var t;return null===(t=e.batch())||void 0===t||t.accept(this),this.data}},{key:"visitBatch",value:function(e){var t=this;e.sql_command().forEach((function(e){e.accept(t)}))}},{key:"visitSql_command",value:function(e){e.ddl_command()&&e.ddl_command().accept(this)}},{key:"visitDdl_command",value:function(e){e.alter_command()?e.alter_command().accept(this):e.create_command()&&e.create_command().accept(this)}},{key:"visitCreate_command",value:function(e){if(e.create_table()){var t=e.create_table().accept(this);this.data.tables.push(t)}else if(e.create_table_like()){var n=f(e.create_table_like().accept(this),4),i=n[0],r=n[1],a=n[2],u=n[3],c=this.data.tables.reduce((function(e,t){return t.name===u&&t.schemaName===a?t:e}),null);if(c){var l=new o.Table({name:r,schemaName:i,fields:c.fields});this.data.tables.push(l)}}}},{key:"visitCreate_database",value:function(e){var t=(0,l.getOriginalText)(e.object_name());this.data.schemas.push(t)}},{key:"visitCreate_table",value:function(e){var t,n,i,r=this,u=f(e.object_name().accept(this),3),l=(u[0],u[1]),p=u[2],v=e.create_table_clause().accept(this),m=v.definitions,d=v.tableNote,y=(null===(t=e.comment_clause())||void 0===t?void 0:t.accept(this))||d,h=f(m.reduce((function(e,t){if(t.kind===c.TABLE_CONSTRAINT_KIND.FIELD)e[0].push(t.value);else if(t.kind===c.TABLE_CONSTRAINT_KIND.UNIQUE)e[1].push(t.value);else if(t.kind===c.TABLE_CONSTRAINT_KIND.FK)e[2].push(t.value);else if(t.kind===c.TABLE_CONSTRAINT_KIND.PK){var n=t.value;n.columns.length>1?e[1].push(t.value):e[3]=n}return e}),[[],[],[],null]),4),_=h[0],N=h[1],b=h[2],T=h[3],O=_.map((function(e){var t,n=e.field,i=e.inlineRefs;if("enum"===(null===(t=n.type.type_name)||void 0===t?void 0:t.toLowerCase())){var a=n.type.args.map((function(e){return{name:e.replace(/'|"|`/g,"").trim()}})),u=new o.Enum({name:"".concat(p,"_").concat(n.name,"_enum"),schemaName:l,values:a});n.type.type_name=u.name,n.type.schemaName=u.schemaName,r.data.enums.push(u)}return i.forEach((function(e){e.endpoints[0].tableName=p,e.endpoints[0].schemaName=l,e.endpoints[0].fieldNames=[n.name]})),i}));(n=this.data.refs).push.apply(n,s((0,a.flatten)(O))),(i=this.data.refs).push.apply(i,s(b.map((function(e){return e.endpoints[0].tableName=p,e.endpoints[0].schemaName=l,e}))));var I=new o.Table({name:p,schemaName:l,fields:_.map((function(e){return e.field})),indexes:N,note:y});if(T){var E=I.fields.find((function(e){return e.name===T.columns[0].value}));E&&(E.pk=!0)}return I}},{key:"visitAlter_table",value:function(e){if(e.constraint_action()){var t=f(e.object_name()[0].accept(this),3),n=(t[0],t[1]),i=t[2],r=e.constraint_action().accept(this);if(r){var a,u=[],o=[],l=[];r.kind===c.TABLE_CONSTRAINT_KIND.FIELD?u.push(r.value):r.kind===c.TABLE_CONSTRAINT_KIND.UNIQUE?o.push(r.value):r.kind===c.TABLE_CONSTRAINT_KIND.FK&&l.push(r.value),(a=this.data.refs).push.apply(a,s(l.map((function(e){return e.endpoints[0].tableName=i,e.endpoints[0].schemaName=n,e}))));var p,v,m=this.data.tables.reduce((function(e,t){return t.name===i&&t.schemaName===n?t:e}),null);return m&&((p=m.fields).push.apply(p,u),(v=m.indexes).push.apply(v,o)),m}}return null}},{key:"visitCreate_table_like",value:function(e){var t=f(e.object_name()[0].accept(this),3),n=(t[0],t[1]),i=t[2],r=f(e.object_name()[1].accept(this),3);return r[0],[n,i,r[1],r[2]]}},{key:"visitObject_name",value:function(e){var t,n;return[null===(t=e.d)||void 0===t?void 0:t.accept(this),null===(n=e.s)||void 0===n?void 0:n.accept(this),e.o.accept(this)]}},{key:"visitId_",value:function(e){return e.DOUBLE_QUOTE_ID()?(0,l.getOriginalText)(e).slice(1,-1):(0,l.getOriginalText)(e)}},{key:"visitCreate_table_clause",value:function(e){var t,n=this;return{definitions:e.column_decl_item_list_paren().accept(this),tableNote:null===(t=e.comment_clause().map((function(e){return e.accept(n)})))||void 0===t?void 0:t[-1]}}},{key:"visitComment_clause",value:function(e){return _(e.string())}},{key:"visitColumn_decl_item_list_paren",value:function(e){return e.column_decl_item_list().accept(this)}},{key:"visitColumn_decl_item_list",value:function(e){var t=this;return e.column_decl_item().map((function(e){return e.accept(t)})).filter((function(e){return e}))}},{key:"visitColumn_decl_item",value:function(e){return e.full_col_decl()?{kind:c.TABLE_CONSTRAINT_KIND.FIELD,value:e.full_col_decl().accept(this)}:e.out_of_line_constraint()?e.out_of_line_constraint().accept(this):null}},{key:"visitFull_col_decl",value:function(e){var t=this,n=e.col_decl().accept(this),i=[];if(e.inline_constraint()){var r=e.inline_constraint().map((function(e){return e.accept(t)}));(0,a.isEmpty)(r)||r.forEach((function(e){e.kind===c.COLUMN_CONSTRAINT_KIND.UNIQUE?n.unique=!0:e.kind===c.COLUMN_CONSTRAINT_KIND.PK?n.pk=!0:e.kind===c.COLUMN_CONSTRAINT_KIND.FK&&i.push(e.value)}))}if(e.null_not_null()){var u=e.null_not_null().map((function(e){return e.accept(t)}));(0,a.isEmpty)(u)||u.forEach((function(e){e.kind===c.COLUMN_CONSTRAINT_KIND.NOT_NULL&&(n.not_null=e.value)}))}return e.default_value()&&e.default_value().map((function(e){return e.accept(t)})).forEach((function(e){e.kind===c.COLUMN_CONSTRAINT_KIND.DEFAULT?n.dbdefault=e.value:e.kind===c.COLUMN_CONSTRAINT_KIND.INCREMENT&&(n.increment=e.value)})),e.COMMENT()&&(n.note=_(e.string())),{field:n,inlineRefs:i}}},{key:"visitCol_decl",value:function(e){return new o.Field({name:e.column_name().accept(this),type:{type_name:(0,l.getOriginalText)(e.data_type()),schemaName:null}})}},{key:"visitColumn_name",value:function(e){var t=this;return e.id_().map((function(e){return e.accept(t)})).join(".")}},{key:"visitInline_constraint",value:function(e){if(e.UNIQUE())return{kind:c.COLUMN_CONSTRAINT_KIND.UNIQUE,value:!0};if(e.primary_key())return{kind:c.COLUMN_CONSTRAINT_KIND.PK,value:!0};if(e.foreign_key()&&e.column_name()){var t=f(e.object_name().accept(this),3),n=(t[0],t[1]),i=t[2],r=[e.column_name().accept(this)];return{kind:c.COLUMN_CONSTRAINT_KIND.FK,value:{endpoints:[{tableName:null,schemaName:null,fieldNames:null,relation:"*"},{tableName:i,schemaName:n,fieldNames:r,relation:"1"}]}}}return{kind:null,value:null}}},{key:"visitOut_of_line_constraint",value:function(e){var t=this;if(e.UNIQUE()){var n,i=null===(n=e.id_())||void 0===n?void 0:n.accept(this),r=(0,a.flatten)(e.column_list_in_parentheses().map((function(e){return e.accept(t)}))),u=new o.Index({unique:!0,columns:r.map((function(e){return{value:e,type:c.CONSTRAINT_TYPE.COLUMN}}))});return{name:i,kind:c.TABLE_CONSTRAINT_KIND.UNIQUE,value:u}}if(e.primary_key()){var l,s=null===(l=e.id_())||void 0===l?void 0:l.accept(this),p=(0,a.flatten)(e.column_list_in_parentheses().map((function(e){return e.accept(t)}))),v=new o.Index({name:s,pk:!0,columns:p.map((function(e){return{value:e,type:c.CONSTRAINT_TYPE.COLUMN}}))});return{kind:c.TABLE_CONSTRAINT_KIND.PK,value:v}}if(e.foreign_key()&&2===e.column_list_in_parentheses().length){var m=f(e.object_name().accept(this),3),d=(m[0],m[1]),y=m[2],h=e.column_list_in_parentheses()[0].accept(this),_=e.column_list_in_parentheses()[1].accept(this);return{kind:c.TABLE_CONSTRAINT_KIND.FK,value:{endpoints:[{tableName:null,schemaName:null,fieldNames:h,relation:"*"},{tableName:y,schemaName:d,fieldNames:_,relation:"1"}]}}}return null}},{key:"visitColumn_list_in_parentheses",value:function(e){return e.column_list().accept(this)}},{key:"visitColumn_list",value:function(e){var t=this;return e.column_name().map((function(e){return e.accept(t)}))}},{key:"visitNull_not_null",value:function(e){return{kind:c.COLUMN_CONSTRAINT_KIND.NOT_NULL,value:!!e.NOT()}}},{key:"visitDefault_value",value:function(e){return e.DEFAULT()?{kind:c.COLUMN_CONSTRAINT_KIND.DEFAULT,value:e.expr().accept(this)}:e.AUTOINCREMENT()||e.IDENTITY()?{kind:c.COLUMN_CONSTRAINT_KIND.INCREMENT,value:!0}:null}},{key:"visitExpr",value:function(e){return e.primitive_expression()?e.primitive_expression().accept(this):{value:(0,l.getOriginalText)(e),type:"expression"}}},{key:"visitPrimitive_expression",value:function(e){return e.NULL_()?{value:null,type:"boolean"}:e.literal()?e.literal().accept(this):{value:(0,l.getOriginalText)(e),type:"expression"}}},{key:"visitLiteral",value:function(e){return e.STRING()?{value:_(e),type:"string"}:e.DECIMAL()||e.REAL||e.FLOAT?{value:(0,l.getOriginalText)(e),type:"number"}:e.true_false()||e.NULL_()?{value:(0,l.getOriginalText)(e),type:"boolean"}:{value:(0,l.getOriginalText)(e),type:"expression"}}},{key:"visitConstraint_action",value:function(e){return e.ADD()?e.out_of_line_constraint().accept(this):null}}])&&m(t.prototype,n),i&&m(t,i),Object.defineProperty(t,"prototype",{writable:!1}),u}(u.default);t.default=N}}]);
